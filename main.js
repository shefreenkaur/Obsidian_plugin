/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// main.ts
var main_exports = {};
__export(main_exports, {
  default: () => KnowledgeSynthesisPlugin
});
module.exports = __toCommonJS(main_exports);
var import_obsidian6 = require("obsidian");

// src/utils/text-processing.ts
var TextProcessingUtils = class {
  constructor() {
    //Common English stop words to filter out
    this.stopWords = /* @__PURE__ */ new Set([
      "a",
      "an",
      "the",
      "and",
      "or",
      "but",
      "is",
      "are",
      "was",
      "were",
      "be",
      "been",
      "being",
      "have",
      "has",
      "had",
      "do",
      "does",
      "did",
      "of",
      "as",
      "like",
      "if",
      "that",
      "you",
      "with",
      "your",
      "through",
      "to",
      "from",
      "in",
      "out",
      "on",
      "off",
      "over",
      "under",
      "again",
      "further",
      "then",
      "once",
      "here",
      "there",
      "when",
      "where",
      "why",
      "how",
      "all",
      "any",
      "both",
      "each",
      "few",
      "more",
      "most",
      "other",
      "some",
      "such",
      "no",
      "nor",
      "not",
      "only",
      "own",
      "same",
      "so",
      "than",
      "too",
      "very",
      "can",
      "will",
      "just",
      "should",
      "now"
    ]);
  }
  /**
   * Tokenize text into words
   * @param text Input text to tokenize
   * @returns Array of tokens
   */
  tokenize(text) {
    const normalized = text.toLowerCase().replace(/[^\w\s]/g, " ").replace(/\s+/g, " ").trim();
    return normalized.split(" ");
  }
  /**
   * Calculate term frequency for tokens
   * @param tokens Array of tokens
   * @returns Map of terms to their frequency
   */
  calculateTermFrequency(tokens) {
    const termFrequency = /* @__PURE__ */ new Map();
    for (const token of tokens) {
      const count = termFrequency.get(token) || 0;
      termFrequency.set(token, count + 1);
    }
    return termFrequency;
  }
  /**
   * Remove common stop words from tokens
   * @param tokens Array of tokens
   * @returns Filtered array with stop words removed
   */
  removeStopWords(tokens) {
    return tokens.filter((token) => !this.stopWords.has(token) && token.length > 1);
  }
  /**
   * Basic stemming algorithm for English
   * Implements a simple version of Porter stemming
   * @param tokens Array of tokens
   * @returns Array of stemmed tokens
   */
  stemWords(tokens) {
    return tokens.map((token) => {
      if (token.endsWith("ing")) {
        return token.slice(0, -3);
      } else if (token.endsWith("ly")) {
        return token.slice(0, -2);
      } else if (token.endsWith("s") && !token.endsWith("ss")) {
        return token.slice(0, -1);
      } else if (token.endsWith("ed") && token.length > 4) {
        return token.slice(0, -2);
      } else {
        return token;
      }
    });
  }
  /**
   * Extract potential named entities from text
   * Very simplified implementation for proof of concept
   * @param text Input text
   * @returns Array of potential named entities
   */
  extractNamedEntities(text) {
    const sentences = text.split(/[.!?]+/);
    const entities = [];
    for (const sentence of sentences) {
      const words = sentence.trim().split(" ");
      for (let i = 0; i < words.length; i++) {
        const word = words[i];
        if (i > 0 && word.length > 1 && /^[A-Z][a-z]+$/.test(word)) {
          entities.push(word);
        }
        if (i < words.length - 1 && word.length > 1 && /^[A-Z][a-z]+$/.test(word) && /^[A-Z][a-z]+$/.test(words[i + 1])) {
          entities.push(`${word} ${words[i + 1]}`);
        }
      }
    }
    return [...new Set(entities)];
  }
};

// src/core/concept-extractor.ts
var ConceptExtractorImpl = class {
  //Store user feedback on concepts
  constructor() {
    this.sensitivity = 5;
    this.userFeedback = /* @__PURE__ */ new Map();
    this.textProcessor = new TextProcessingUtils();
  }
  /**
   * Extract concepts from text content
   * @param content Text content to analyze
   * @returns Array of extracted concepts
   */
  extractConcepts(content) {
    if (!content || content.trim() === "") {
      return [];
    }
    const concepts = [
      ...this.extractFromTfIdf(content),
      ...this.extractFromHeadings(content),
      ...this.extractFromEmphasis(content),
      ...this.extractFromNamedEntities(content)
    ];
    const filteredConcepts = concepts.filter((concept) => {
      const feedback = this.userFeedback.get(concept);
      if (feedback === false) {
        return false;
      }
      return true;
    });
    return [...new Set(filteredConcepts)];
  }
  /**
   * Set sensitivity for extraction (1-10)
   * @param sensitivity Sensitivity level (1-10)
   */
  setSensitivity(sensitivity) {
    this.sensitivity = Math.max(1, Math.min(10, sensitivity));
  }
  /**
   * Learn from user feedback on concept relevance
   * @param concept The concept receiving feedback
   * @param isRelevant Whether the user marked it as relevant
   */
  learnFromUserFeedback(concept, isRelevant) {
    this.userFeedback.set(concept, isRelevant);
  }
  /**
   * Extract concepts using TF-IDF like approach
   * @param content Text content to analyze
   * @returns Array of concepts
   */
  extractFromTfIdf(content) {
    const tokens = this.textProcessor.tokenize(content);
    const filteredTokens = this.textProcessor.removeStopWords(tokens);
    const termFrequency = this.textProcessor.calculateTermFrequency(filteredTokens);
    const threshold = Math.max(2, Math.floor(20 / (11 - this.sensitivity)));
    const sortedTerms = Array.from(termFrequency.entries()).filter(([_, freq]) => freq >= threshold).sort((a, b) => b[1] - a[1]).slice(0, this.sensitivity * 3).map(([term, _]) => term);
    return sortedTerms;
  }
  /**
   * Extract concepts from markdown headings
   * @param content Markdown content
   * @returns Array of concepts from headings
   */
  extractFromHeadings(content) {
    const headingRegex = /^#+\s+(.+)$/gm;
    const headings = [];
    let match;
    while ((match = headingRegex.exec(content)) !== null) {
      headings.push(match[1].trim());
    }
    return headings;
  }
  /**
   * Extract concepts from emphasized text (bold/italic)
   * @param content Markdown content
   * @returns Array of concepts from emphasized text
   */
  extractFromEmphasis(content) {
    const emphasisRegex = /(\*\*|__)(.*?)\1|(\*|_)(.*?)\3/g;
    const emphasized = [];
    let match;
    while ((match = emphasisRegex.exec(content)) !== null) {
      const text = match[2] || match[4];
      if (text && text.trim().length > 0) {
        emphasized.push(text.trim());
      }
    }
    return emphasized;
  }
  /**
   * Extract named entities as concepts
   * @param content Text content
   * @returns Array of named entities
   */
  extractFromNamedEntities(content) {
    return this.textProcessor.extractNamedEntities(content);
  }
};

// src/core/concept-graph.ts
var import_obsidian = require("obsidian");
var ConceptGraphImpl = class {
  constructor(vault) {
    this.notes = /* @__PURE__ */ new Map();
    this.concepts = /* @__PURE__ */ new Map();
    this.vault = vault;
  }
  /**
   * Add a note to the graph with its concepts
   * @param path Path to the note
   * @param concepts Array of concepts in the note
   */
  addNote(path, concepts) {
    this.notes.set(path, {
      path,
      concepts,
      lastUpdated: Date.now()
    });
    for (const concept of concepts) {
      const conceptNode = this.concepts.get(concept) || {
        name: concept,
        notePaths: [],
        weight: 1
      };
      if (!conceptNode.notePaths.includes(path)) {
        conceptNode.notePaths.push(path);
      }
      conceptNode.weight = conceptNode.notePaths.length;
      this.concepts.set(concept, conceptNode);
    }
  }
  /**
   * Remove a note from the graph
   * @param path Path to the note to remove
   */
  removeNote(path) {
    const note = this.notes.get(path);
    if (!note) {
      return;
    }
    for (const concept of note.concepts) {
      const conceptNode = this.concepts.get(concept);
      if (conceptNode) {
        conceptNode.notePaths = conceptNode.notePaths.filter((p) => p !== path);
        conceptNode.weight = conceptNode.notePaths.length;
        if (conceptNode.notePaths.length === 0) {
          this.concepts.delete(concept);
        } else {
          this.concepts.set(concept, conceptNode);
        }
      }
    }
    this.notes.delete(path);
  }
  /**
   * Find notes related to a given note
   * @param notePath Path to the note
   * @param maxResults Maximum number of results to return
   * @returns Array of related notes sorted by relevance
   */
  findRelatedNotes(notePath, maxResults = 10) {
    const note = this.notes.get(notePath);
    if (!note) {
      return [];
    }
    const scores = /* @__PURE__ */ new Map();
    for (const concept of note.concepts) {
      const conceptNode = this.concepts.get(concept);
      if (!conceptNode)
        continue;
      for (const relatedPath of conceptNode.notePaths) {
        if (relatedPath === notePath)
          continue;
        const scoreData = scores.get(relatedPath) || {
          relevance: 0,
          sharedConcepts: []
        };
        scoreData.relevance += conceptNode.weight;
        if (!scoreData.sharedConcepts.includes(concept)) {
          scoreData.sharedConcepts.push(concept);
        }
        scores.set(relatedPath, scoreData);
      }
    }
    const relatedNotes = [];
    const maxScore = Math.max(...Array.from(scores.values()).map((data) => data.relevance), 1);
    for (const [path, data] of scores.entries()) {
      const file = this.vault.getAbstractFileByPath(path);
      if (!file || !(file instanceof import_obsidian.TFile))
        continue;
      relatedNotes.push({
        file,
        relevance: data.relevance / maxScore,
        // Normalize to 0-1
        sharedConcepts: data.sharedConcepts
      });
    }
    return relatedNotes.sort((a, b) => b.relevance - a.relevance).slice(0, maxResults);
  }
  /**
   * Get all concepts for a note
   * @param notePath Path to the note
   * @returns Array of concepts
   */
  getNoteConcepts(notePath) {
    const note = this.notes.get(notePath);
    return note ? note.concepts : [];
  }
  /**
   * Get graph data for visualization
   * @returns Object with nodes and edges arrays for visualization
   */
  getConceptNetwork() {
    const nodes = [];
    const edges = [];
    for (const [path, note] of this.notes.entries()) {
      nodes.push({
        id: path,
        label: path.split("/").pop() || path,
        // Use filename as label
        type: "note"
      });
    }
    for (const [name, concept] of this.concepts.entries()) {
      if (concept.notePaths.length > 1) {
        nodes.push({
          id: `concept-${name}`,
          label: name,
          type: "concept",
          weight: concept.weight
        });
        for (const path of concept.notePaths) {
          edges.push({
            source: `concept-${name}`,
            target: path,
            value: 1
          });
        }
      }
    }
    return { nodes, edges };
  }
};

// src/core/data-manager.ts
var DataManagerImpl = class {
  constructor(plugin) {
    // Current data version for migration support
    this.CURRENT_VERSION = 1;
    this.plugin = plugin;
    this.data = {
      version: this.CURRENT_VERSION,
      notes: {},
      concepts: {},
      userFeedback: {}
    };
  }
  /**
   * Save concept data to disk
   */
  async saveConceptData() {
    await this.plugin.saveData(this.data);
  }
  /**
   * Load concept data from disk
   */
  async loadConceptData() {
    try {
      const savedData = await this.plugin.loadData();
      if (!savedData) {
        return;
      }
      if (savedData.version !== this.CURRENT_VERSION) {
        this.data = this.migrateData(savedData);
      } else {
        this.data = savedData;
      }
    } catch (error) {
      console.error("Failed to load concept data:", error);
    }
  }
  /**
   * Clear all stored data
   */
  async clearData() {
    this.data = {
      version: this.CURRENT_VERSION,
      notes: {},
      concepts: {},
      userFeedback: {}
    };
    await this.saveConceptData();
  }
  /**
   * Get the loaded data
   */
  getData() {
    return this.data;
  }
  /**
   * Set the data (used when updating from the concept graph)
   */
  setData(notes, concepts, userFeedback) {
    this.data = {
      version: this.CURRENT_VERSION,
      notes,
      concepts,
      userFeedback
    };
  }
  /**
   * Migrate data from an older version to the current version
   */
  migrateData(oldData) {
    return {
      version: this.CURRENT_VERSION,
      notes: oldData.notes || {},
      concepts: oldData.concepts || {},
      userFeedback: oldData.userFeedback || {}
    };
  }
};

// src/services/note-processor.ts
var import_obsidian2 = require("obsidian");
var NoteProcessor = class {
  // path -> lastModified
  constructor(vault, conceptExtractor, conceptGraph, saveCallback) {
    this.vault = vault;
    this.conceptExtractor = conceptExtractor;
    this.conceptGraph = conceptGraph;
    this.saveCallback = saveCallback;
    // Keep track of processed files to avoid redundant processing
    this.processedFiles = /* @__PURE__ */ new Map();
  }
  /**
   * Process a single note file
   * @param file Note file to process
   */
  async processNote(file) {
    if (!this.shouldProcessNote(file)) {
      return;
    }
    try {
      const content = await this.vault.read(file);
      const concepts = this.conceptExtractor.extractConcepts(content);
      this.conceptGraph.addNote(file.path, concepts);
      this.processedFiles.set(file.path, file.stat.mtime);
      await this.saveCallback();
    } catch (error) {
      console.error(`Error processing file ${file.path}:`, error);
    }
  }
  /**
   * Check if a file needs processing
   * @param file File to check
   * @returns true if file needs processing, false otherwise
   */
  shouldProcessNote(file) {
    if (file.extension !== "md") {
      return false;
    }
    const lastModified = file.stat.mtime;
    const lastProcessed = this.processedFiles.get(file.path);
    return !lastProcessed || lastProcessed < lastModified;
  }
  /**
   * Process all notes in the vault
   */
  async processAllNotes() {
    const files = this.vault.getMarkdownFiles();
    let processedCount = 0;
    const notice = new import_obsidian2.Notice(`Processing ${files.length} notes...`, 0);
    for (const file of files) {
      await this.processNote(file);
      processedCount++;
      if (processedCount % 10 === 0) {
        notice.setMessage(`Processed ${processedCount}/${files.length} notes...`);
      }
    }
    await this.saveCallback();
    notice.hide();
    new import_obsidian2.Notice(`Completed processing ${processedCount} notes.`);
  }
};

// src/services/summary-generator.ts
var import_obsidian3 = require("obsidian");
var SummaryGenerator = class {
  constructor(app, conceptGraph, getRelatedNotes) {
    this.app = app;
    this.conceptGraph = conceptGraph;
    this.getRelatedNotes = getRelatedNotes;
  }
  /**
   * Generate a summary from related notes
   * @param file File to generate summary for
   * @returns The content of the generated summary
   */
  async generateSummary(file) {
    var _a;
    const relatedNotes = await this.getRelatedNotes(file);
    if (relatedNotes.length === 0) {
      new import_obsidian3.Notice("No related notes found to generate summary");
      return "";
    }
    const summaryTitle = `Summary of ${file.basename}`;
    let summaryContent = `# ${summaryTitle}

`;
    summaryContent += `> [!info] Summary generated from ${file.basename} and ${relatedNotes.length} related notes
`;
    summaryContent += `> Generated on ${new Date().toLocaleString()}

`;
    const originalContent = await this.app.vault.read(file);
    summaryContent += `## Original Note: ${file.basename}

`;
    const firstParagraph = originalContent.split("\n\n")[0];
    summaryContent += `${firstParagraph}

`;
    const concepts = this.conceptGraph.getNoteConcepts(file.path);
    if (concepts.length > 0) {
      summaryContent += `## Key Concepts

`;
      summaryContent += concepts.map((c) => `- ${c}`).join("\n");
      summaryContent += `

`;
    }
    summaryContent += `## Related Notes

`;
    for (const related of relatedNotes) {
      summaryContent += `### ${related.file.basename}

`;
      if (related.sharedConcepts.length > 0) {
        summaryContent += `Shared concepts: ${related.sharedConcepts.join(", ")}

`;
      }
      try {
        const relatedContent = await this.app.vault.read(related.file);
        const firstParagraph2 = relatedContent.split("\n\n")[0];
        summaryContent += `${firstParagraph2}

`;
      } catch (error) {
        summaryContent += `Error reading note content.

`;
      }
      summaryContent += `[[${related.file.path}|View full note]]

`;
    }
    try {
      const summaryPath = `${((_a = file.parent) == null ? void 0 : _a.path) || ""}/${summaryTitle}.md`;
      let summaryFile = this.app.vault.getAbstractFileByPath(summaryPath);
      if (summaryFile) {
        await this.app.vault.modify(summaryFile, summaryContent);
      } else {
        summaryFile = await this.app.vault.create(summaryPath, summaryContent);
      }
      this.app.workspace.getLeaf().openFile(summaryFile);
      return summaryContent;
    } catch (error) {
      console.error("Error creating summary:", error);
      new import_obsidian3.Notice("Error creating summary note");
      return "";
    }
  }
};

// src/ui/related-notes-view.ts
var import_obsidian4 = require("obsidian");
var RELATED_NOTES_VIEW_TYPE = "knowledge-synthesis-related-notes";
var RelatedNotesView = class extends import_obsidian4.ItemView {
  constructor(leaf, pluginApi) {
    super(leaf);
    // Changed from contentEl to avoid conflicts
    this.currentFile = null;
    this.pluginApi = pluginApi;
  }
  getViewType() {
    return RELATED_NOTES_VIEW_TYPE;
  }
  getDisplayText() {
    return "Related Notes";
  }
  async onOpen() {
    const { containerEl } = this;
    containerEl.empty();
    this.relatedContentEl = containerEl.createDiv({ cls: "knowledge-synthesis-related-notes" });
    this.relatedContentEl.createEl("h3", { text: "Related Notes" });
    this.relatedContentEl.createEl("p", {
      text: "Open a note to see related content.",
      cls: "knowledge-synthesis-placeholder"
    });
  }
  /**
   * Update the view with related notes for a file
   * @param file Current active file
   * @param relatedNotes Array of related notes
   */
  updateRelatedNotes(file, relatedNotes) {
    this.currentFile = file;
    this.relatedContentEl.empty();
    this.relatedContentEl.createEl("h3", { text: "Related to: " + file.basename });
    const concepts = this.pluginApi.extractConcepts(file.path);
    if (concepts.length > 0) {
      const conceptsEl = this.relatedContentEl.createDiv({ cls: "knowledge-synthesis-concepts" });
      conceptsEl.createEl("h4", { text: "Key Concepts" });
      const conceptsList = conceptsEl.createDiv({ cls: "knowledge-synthesis-concepts-list" });
      for (const concept of concepts) {
        const tagEl = conceptsList.createSpan({
          cls: "knowledge-synthesis-concept-tag",
          text: concept
        });
      }
    }
    if (relatedNotes.length > 0) {
      const relatedEl = this.relatedContentEl.createDiv({ cls: "knowledge-synthesis-related" });
      relatedEl.createEl("h4", { text: "Related Notes" });
      const relatedList = relatedEl.createDiv({ cls: "knowledge-synthesis-related-list" });
      for (const related of relatedNotes) {
        const noteEl = relatedList.createDiv({ cls: "knowledge-synthesis-related-note" });
        const linkEl = noteEl.createEl("a", {
          cls: "knowledge-synthesis-note-link",
          text: related.file.basename
        });
        linkEl.addEventListener("click", async (e) => {
          e.preventDefault();
          const leaf = this.app.workspace.getLeaf();
          if (leaf) {
            await leaf.openFile(related.file);
          }
        });
        const relevanceEl = noteEl.createDiv({
          cls: "knowledge-synthesis-relevance-bar"
        });
        const indicatorEl = relevanceEl.createDiv({
          cls: "knowledge-synthesis-relevance-indicator"
        });
        indicatorEl.style.width = `${Math.round(related.relevance * 100)}%`;
        if (related.sharedConcepts.length > 0) {
          const sharedEl = noteEl.createDiv({
            cls: "knowledge-synthesis-shared-concepts"
          });
          sharedEl.createSpan({
            cls: "knowledge-synthesis-shared-label",
            text: "Shared concepts: "
          });
          for (const concept of related.sharedConcepts) {
            sharedEl.createSpan({
              cls: "knowledge-synthesis-concept-tag knowledge-synthesis-shared",
              text: concept
            });
          }
        }
      }
    } else {
      this.relatedContentEl.createEl("p", {
        text: "No related notes found. Try adding more content or concepts.",
        cls: "knowledge-synthesis-no-results"
      });
    }
    const actionsEl = this.relatedContentEl.createDiv({ cls: "knowledge-synthesis-actions" });
    const summaryBtn = actionsEl.createEl("button", {
      cls: "knowledge-synthesis-summary-btn",
      text: "Generate Summary"
    });
    summaryBtn.addEventListener("click", async () => {
      if (this.currentFile) {
        await this.pluginApi.generateSummary(this.currentFile);
      }
    });
  }
  /**
   * Clear the view
   */
  clear() {
    this.relatedContentEl.empty();
    this.currentFile = null;
    this.relatedContentEl.createEl("h3", { text: "Related Notes" });
    this.relatedContentEl.createEl("p", {
      text: "Open a note to see related content.",
      cls: "knowledge-synthesis-placeholder"
    });
  }
};

// src/ui/settings-tab.ts
var import_obsidian5 = require("obsidian");
var KnowledgeSynthesisSettingTab = class extends import_obsidian5.PluginSettingTab {
  // Use the specific plugin class type
  constructor(app, plugin) {
    super(app, plugin);
    this.plugin = plugin;
  }
  display() {
    const { containerEl } = this;
    containerEl.empty();
    containerEl.createEl("h2", { text: "Knowledge Synthesis Settings" });
    new import_obsidian5.Setting(containerEl).setName("Concept Extraction Sensitivity").setDesc("Higher values extract more concepts (1-10)").addSlider((slider) => slider.setLimits(1, 10, 1).setValue(this.plugin.settings.extractionSensitivity).setDynamicTooltip().onChange(async (value) => {
      this.plugin.settings.extractionSensitivity = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian5.Setting(containerEl).setName("Reprocess All Notes").setDesc("Update the concept graph with all notes in the vault").addButton((button) => button.setButtonText("Reprocess").onClick(async () => {
      await this.plugin.processAllNotes();
    }));
    new import_obsidian5.Setting(containerEl).setName("Clear All Data").setDesc("Reset all concept and relationship data").addButton((button) => button.setButtonText("Clear Data").setWarning().onClick(async () => {
      const confirmed = confirm("Are you sure you want to clear all Knowledge Synthesis data? This cannot be undone.");
      if (confirmed) {
        await this.plugin.dataManager.clearData();
        new import_obsidian5.Notice("Knowledge Synthesis data cleared");
      }
    }));
  }
};

// main.ts
var DEFAULT_SETTINGS = {
  extractionSensitivity: 5,
  maxRelatedNotes: 10,
  realTimeSuggestions: true,
  includeTags: true,
  includeLinks: true
};
var KnowledgeSynthesisPlugin = class extends import_obsidian6.Plugin {
  /**
   * Plugin initialization
   */
  async onload() {
    console.log("Loading Knowledge Synthesis plugin");
    await this.loadSettings();
    this.conceptExtractor = new ConceptExtractorImpl();
    this.conceptExtractor.setSensitivity(this.settings.extractionSensitivity);
    this.conceptGraph = new ConceptGraphImpl(this.app.vault);
    this.dataManager = new DataManagerImpl(this);
    this.noteProcessor = new NoteProcessor(
      this.app.vault,
      this.conceptExtractor,
      this.conceptGraph,
      () => this.dataManager.saveConceptData()
    );
    this.summaryGenerator = new SummaryGenerator(
      this.app,
      this.conceptGraph,
      (file) => this.getRelatedNotes(file)
    );
    await this.dataManager.loadConceptData();
    this.registerView(
      RELATED_NOTES_VIEW_TYPE,
      (leaf) => new RelatedNotesView(leaf, this)
    );
    this.addRibbonIcon("network", "Knowledge Synthesis", () => {
      this.activateView();
    });
    this.addCommands();
    this.registerEvents();
    this.addSettingTab(new KnowledgeSynthesisSettingTab(this.app, this));
    this.processAllNotes();
    console.log("Knowledge Synthesis plugin loaded");
  }
  /**
   * Clean up when plugin is disabled
   */
  onunload() {
    console.log("Knowledge Synthesis plugin unloaded");
  }
  /**
   * Load plugin settings
   */
  async loadSettings() {
    this.settings = Object.assign({}, DEFAULT_SETTINGS, await this.loadData());
  }
  /**
   * Save plugin settings
   */
  async saveSettings() {
    await this.saveData(this.settings);
    this.conceptExtractor.setSensitivity(this.settings.extractionSensitivity);
  }
  /**
   * Add plugin commands to Obsidian command palette
   */
  addCommands() {
    this.addCommand({
      id: "extract-concepts",
      name: "Extract Concepts from Current Note",
      checkCallback: (checking) => {
        const activeView = this.app.workspace.getActiveViewOfType(import_obsidian6.MarkdownView);
        if (activeView) {
          if (!checking) {
            this.processCurrentNote();
          }
          return true;
        }
        return false;
      }
    });
    this.addCommand({
      id: "show-related-notes",
      name: "Show Related Notes",
      checkCallback: (checking) => {
        const activeView = this.app.workspace.getActiveViewOfType(import_obsidian6.MarkdownView);
        if (activeView) {
          if (!checking) {
            this.activateView();
          }
          return true;
        }
        return false;
      }
    });
    this.addCommand({
      id: "generate-summary",
      name: "Generate Summary from Related Notes",
      checkCallback: (checking) => {
        const activeView = this.app.workspace.getActiveViewOfType(import_obsidian6.MarkdownView);
        if (activeView && activeView.file) {
          if (!checking) {
            this.generateSummary(activeView.file);
          }
          return true;
        }
        return false;
      }
    });
  }
  /**
   * Register event handlers
   */
  registerEvents() {
    this.registerEvent(
      this.app.vault.on("modify", (file) => {
        if (file instanceof import_obsidian6.TFile && file.extension === "md") {
          if (this.settings.realTimeSuggestions) {
            this.noteProcessor.processNote(file);
          }
        }
      })
    );
    this.registerEvent(
      this.app.vault.on("delete", (file) => {
        if (file instanceof import_obsidian6.TFile && file.extension === "md") {
          this.conceptGraph.removeNote(file.path);
          this.dataManager.saveConceptData();
        }
      })
    );
    this.registerEvent(
      this.app.vault.on("rename", (file, oldPath) => {
        if (file instanceof import_obsidian6.TFile && file.extension === "md") {
          this.conceptGraph.removeNote(oldPath);
          this.noteProcessor.processNote(file);
        }
      })
    );
    this.registerEvent(
      this.app.workspace.on("active-leaf-change", (leaf) => {
        if ((leaf == null ? void 0 : leaf.view) instanceof import_obsidian6.MarkdownView && this.settings.realTimeSuggestions) {
          this.processCurrentNote();
        }
      })
    );
  }
  /**
   * Process the current active note
   */
  async processCurrentNote() {
    const activeView = this.app.workspace.getActiveViewOfType(import_obsidian6.MarkdownView);
    if (activeView && activeView.file) {
      await this.noteProcessor.processNote(activeView.file);
      this.updateRelatedNotesView(activeView.file);
    }
  }
  /**
   * Activate the related notes view
   */
  async activateView() {
    const leaves = this.app.workspace.getLeavesOfType(RELATED_NOTES_VIEW_TYPE);
    if (leaves.length === 0) {
      const leaf = this.app.workspace.getRightLeaf(false);
      if (leaf) {
        await leaf.setViewState({
          type: RELATED_NOTES_VIEW_TYPE,
          active: true
        });
      }
    }
    const existingLeaves = this.app.workspace.getLeavesOfType(RELATED_NOTES_VIEW_TYPE);
    if (existingLeaves.length > 0) {
      this.app.workspace.revealLeaf(existingLeaves[0]);
      const activeView = this.app.workspace.getActiveViewOfType(import_obsidian6.MarkdownView);
      if (activeView && activeView.file) {
        this.updateRelatedNotesView(activeView.file);
      }
    }
  }
  /**
   * Update the related notes view with data for a file
   * @param file File to show related notes for
   */
  updateRelatedNotesView(file) {
    const leaves = this.app.workspace.getLeavesOfType(RELATED_NOTES_VIEW_TYPE);
    if (leaves.length > 0) {
      const view = leaves[0].view;
      const relatedNotes = this.conceptGraph.findRelatedNotes(
        file.path,
        this.settings.maxRelatedNotes
      );
      view.updateRelatedNotes(file, relatedNotes);
    }
  }
  /**
   * Process all existing notes in the vault
   * Public for settings tab access
   */
  async processAllNotes() {
    await this.noteProcessor.processAllNotes();
  }
  /**
   * Clear all stored data
   * Public for settings tab access
   */
  async clearData() {
    await this.dataManager.clearData();
  }
  /**
   * API method: Get related notes for a file
   * @param file File to find related notes for
   * @returns Array of related notes
   */
  async getRelatedNotes(file) {
    return this.conceptGraph.findRelatedNotes(
      file.path,
      this.settings.maxRelatedNotes
    );
  }
  /**
   * API method: Extract concepts from content
   * @param content Text content to analyze
   * @returns Array of extracted concepts
   */
  extractConcepts(content) {
    return this.conceptExtractor.extractConcepts(content);
  }
  /**
   * API method: Add a concept to a note (used by UI when user adds a concept)
   * @param filePath Path to the file
   * @param concept Concept to add
   */
  async addConceptToNote(filePath, concept) {
    const concepts = this.conceptGraph.getNoteConcepts(filePath);
    if (!concepts.includes(concept)) {
      concepts.push(concept);
      this.conceptGraph.addNote(filePath, concepts);
      await this.dataManager.saveConceptData();
      new import_obsidian6.Notice(`Added concept "${concept}" to note`);
    }
  }
  /**
   * API method: Generate a summary from related notes
   * @param file File to generate summary for
   */
  generateSummary(file) {
    return this.summaryGenerator.generateSummary(file);
  }
  /**
   * API method: Get plugin settings
   * @returns Current plugin settings
   */
  getSettings() {
    return this.settings;
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsibWFpbi50cyIsICJzcmMvdXRpbHMvdGV4dC1wcm9jZXNzaW5nLnRzIiwgInNyYy9jb3JlL2NvbmNlcHQtZXh0cmFjdG9yLnRzIiwgInNyYy9jb3JlL2NvbmNlcHQtZ3JhcGgudHMiLCAic3JjL2NvcmUvZGF0YS1tYW5hZ2VyLnRzIiwgInNyYy9zZXJ2aWNlcy9ub3RlLXByb2Nlc3Nvci50cyIsICJzcmMvc2VydmljZXMvc3VtbWFyeS1nZW5lcmF0b3IudHMiLCAic3JjL3VpL3JlbGF0ZWQtbm90ZXMtdmlldy50cyIsICJzcmMvdWkvc2V0dGluZ3MtdGFiLnRzIl0sCiAgInNvdXJjZXNDb250ZW50IjogWyJpbXBvcnQgeyBcclxuICAgIEFwcCwgXHJcbiAgICBNYXJrZG93blZpZXcsIFxyXG4gICAgTm90aWNlLCBcclxuICAgIFBsdWdpbiwgXHJcbiAgICBURmlsZSxcclxuICAgIFdvcmtzcGFjZUxlYWZcclxufSBmcm9tICdvYnNpZGlhbic7XHJcblxyXG4vLyBJbXBvcnQgdHlwZXNcclxuaW1wb3J0IHsgXHJcbiAgICBLbm93bGVkZ2VTeW50aGVzaXNTZXR0aW5ncywgXHJcbiAgICBDb25jZXB0RXh0cmFjdG9yLCBcclxuICAgIENvbmNlcHRHcmFwaCwgXHJcbiAgICBSZWxhdGVkTm90ZSxcclxuICAgIFBsdWdpbkFQSVxyXG59IGZyb20gJy4vc3JjL3V0aWxzL3R5cGVzJztcclxuXHJcbi8vIEltcG9ydCBpbXBsZW1lbnRhdGlvbnNcclxuaW1wb3J0IHsgQ29uY2VwdEV4dHJhY3RvckltcGwgfSBmcm9tICcuL3NyYy9jb3JlL2NvbmNlcHQtZXh0cmFjdG9yJztcclxuaW1wb3J0IHsgQ29uY2VwdEdyYXBoSW1wbCB9IGZyb20gJy4vc3JjL2NvcmUvY29uY2VwdC1ncmFwaCc7XHJcbmltcG9ydCB7IERhdGFNYW5hZ2VySW1wbCB9IGZyb20gJy4vc3JjL2NvcmUvZGF0YS1tYW5hZ2VyJztcclxuaW1wb3J0IHsgTm90ZVByb2Nlc3NvciB9IGZyb20gJy4vc3JjL3NlcnZpY2VzL25vdGUtcHJvY2Vzc29yJztcclxuaW1wb3J0IHsgU3VtbWFyeUdlbmVyYXRvciB9IGZyb20gJy4vc3JjL3NlcnZpY2VzL3N1bW1hcnktZ2VuZXJhdG9yJztcclxuaW1wb3J0IHsgUmVsYXRlZE5vdGVzVmlldywgUkVMQVRFRF9OT1RFU19WSUVXX1RZUEUgfSBmcm9tICcuL3NyYy91aS9yZWxhdGVkLW5vdGVzLXZpZXcnO1xyXG5pbXBvcnQgeyBLbm93bGVkZ2VTeW50aGVzaXNTZXR0aW5nVGFiIH0gZnJvbSAnLi9zcmMvdWkvc2V0dGluZ3MtdGFiJztcclxuXHJcbi8vIERlZmF1bHQgc2V0dGluZ3NcclxuY29uc3QgREVGQVVMVF9TRVRUSU5HUzogS25vd2xlZGdlU3ludGhlc2lzU2V0dGluZ3MgPSB7XHJcbiAgICBleHRyYWN0aW9uU2Vuc2l0aXZpdHk6IDUsXHJcbiAgICBtYXhSZWxhdGVkTm90ZXM6IDEwLFxyXG4gICAgcmVhbFRpbWVTdWdnZXN0aW9uczogdHJ1ZSxcclxuICAgIGluY2x1ZGVUYWdzOiB0cnVlLFxyXG4gICAgaW5jbHVkZUxpbmtzOiB0cnVlXHJcbn1cclxuXHJcbi8qKlxyXG4gKiBNYWluIHBsdWdpbiBjbGFzcyBmb3IgS25vd2xlZGdlIFN5bnRoZXNpc1xyXG4gKiBDb29yZGluYXRlcyBhbGwgY29tcG9uZW50cyBhbmQgaW50ZWdyYXRlcyB3aXRoIE9ic2lkaWFuXHJcbiAqL1xyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBLbm93bGVkZ2VTeW50aGVzaXNQbHVnaW4gZXh0ZW5kcyBQbHVnaW4gaW1wbGVtZW50cyBQbHVnaW5BUEkgIHtcclxuICAgIC8vIFBsdWdpbiBzZXR0aW5nc1xyXG4gICAgc2V0dGluZ3M6IEtub3dsZWRnZVN5bnRoZXNpc1NldHRpbmdzO1xyXG4gICAgXHJcbiAgICAvLyBDb3JlIGNvbXBvbmVudHNcclxuICAgIHByaXZhdGUgY29uY2VwdEV4dHJhY3RvcjogQ29uY2VwdEV4dHJhY3RvcjtcclxuICAgIHByaXZhdGUgY29uY2VwdEdyYXBoOiBDb25jZXB0R3JhcGg7XHJcbiAgICBwdWJsaWMgZGF0YU1hbmFnZXI6IERhdGFNYW5hZ2VySW1wbDsgLy8gUHVibGljIHNvIGl0IGNhbiBiZSBhY2Nlc3NlZCBieSBTZXR0aW5nc1RhYlxyXG4gICAgXHJcbiAgICAvLyBTZXJ2aWNlc1xyXG4gICAgcHJpdmF0ZSBub3RlUHJvY2Vzc29yOiBOb3RlUHJvY2Vzc29yO1xyXG4gICAgcHJpdmF0ZSBzdW1tYXJ5R2VuZXJhdG9yOiBTdW1tYXJ5R2VuZXJhdG9yO1xyXG4gICAgXHJcbiAgICAvKipcclxuICAgICAqIFBsdWdpbiBpbml0aWFsaXphdGlvblxyXG4gICAgICovXHJcbiAgICBhc3luYyBvbmxvYWQoKSB7XHJcbiAgICAgICAgY29uc29sZS5sb2coJ0xvYWRpbmcgS25vd2xlZGdlIFN5bnRoZXNpcyBwbHVnaW4nKTtcclxuICAgICAgICBcclxuICAgICAgICAvLyBMb2FkIHNldHRpbmdzXHJcbiAgICAgICAgYXdhaXQgdGhpcy5sb2FkU2V0dGluZ3MoKTtcclxuICAgICAgICBcclxuICAgICAgICAvLyBJbml0aWFsaXplIGNvcmUgY29tcG9uZW50c1xyXG4gICAgICAgIHRoaXMuY29uY2VwdEV4dHJhY3RvciA9IG5ldyBDb25jZXB0RXh0cmFjdG9ySW1wbCgpO1xyXG4gICAgICAgIHRoaXMuY29uY2VwdEV4dHJhY3Rvci5zZXRTZW5zaXRpdml0eSh0aGlzLnNldHRpbmdzLmV4dHJhY3Rpb25TZW5zaXRpdml0eSk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgdGhpcy5jb25jZXB0R3JhcGggPSBuZXcgQ29uY2VwdEdyYXBoSW1wbCh0aGlzLmFwcC52YXVsdCk7XHJcbiAgICAgICAgdGhpcy5kYXRhTWFuYWdlciA9IG5ldyBEYXRhTWFuYWdlckltcGwodGhpcyk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gSW5pdGlhbGl6ZSBzZXJ2aWNlc1xyXG4gICAgICAgIHRoaXMubm90ZVByb2Nlc3NvciA9IG5ldyBOb3RlUHJvY2Vzc29yKFxyXG4gICAgICAgICAgICB0aGlzLmFwcC52YXVsdCxcclxuICAgICAgICAgICAgdGhpcy5jb25jZXB0RXh0cmFjdG9yLFxyXG4gICAgICAgICAgICB0aGlzLmNvbmNlcHRHcmFwaCxcclxuICAgICAgICAgICAgKCkgPT4gdGhpcy5kYXRhTWFuYWdlci5zYXZlQ29uY2VwdERhdGEoKVxyXG4gICAgICAgICk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgdGhpcy5zdW1tYXJ5R2VuZXJhdG9yID0gbmV3IFN1bW1hcnlHZW5lcmF0b3IoXHJcbiAgICAgICAgICAgIHRoaXMuYXBwLFxyXG4gICAgICAgICAgICB0aGlzLmNvbmNlcHRHcmFwaCxcclxuICAgICAgICAgICAgKGZpbGUpID0+IHRoaXMuZ2V0UmVsYXRlZE5vdGVzKGZpbGUpXHJcbiAgICAgICAgKTtcclxuICAgICAgICBcclxuICAgICAgICAvLyBMb2FkIHNhdmVkIGRhdGFcclxuICAgICAgICBhd2FpdCB0aGlzLmRhdGFNYW5hZ2VyLmxvYWRDb25jZXB0RGF0YSgpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIFJlZ2lzdGVyIHZpZXcgZm9yIHJlbGF0ZWQgbm90ZXNcclxuICAgICAgICB0aGlzLnJlZ2lzdGVyVmlldyhcclxuICAgICAgICAgICAgUkVMQVRFRF9OT1RFU19WSUVXX1RZUEUsXHJcbiAgICAgICAgICAgIChsZWFmKSA9PiBuZXcgUmVsYXRlZE5vdGVzVmlldyhsZWFmLCB0aGlzKVxyXG4gICAgICAgICk7XHJcblxyXG4gICAgICAgIC8vIEFkZCByaWJib24gaWNvbiBmb3IgcXVpY2sgYWNjZXNzXHJcbiAgICAgICAgdGhpcy5hZGRSaWJib25JY29uKCduZXR3b3JrJywgJ0tub3dsZWRnZSBTeW50aGVzaXMnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuYWN0aXZhdGVWaWV3KCk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIC8vIFJlZ2lzdGVyIGNvbW1hbmRzXHJcbiAgICAgICAgdGhpcy5hZGRDb21tYW5kcygpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIFJlZ2lzdGVyIGV2ZW50IGhhbmRsZXJzXHJcbiAgICAgICAgdGhpcy5yZWdpc3RlckV2ZW50cygpO1xyXG5cclxuICAgICAgICAvLyBBZGQgc2V0dGluZ3MgdGFiXHJcbiAgICAgICAgdGhpcy5hZGRTZXR0aW5nVGFiKG5ldyBLbm93bGVkZ2VTeW50aGVzaXNTZXR0aW5nVGFiKHRoaXMuYXBwLCB0aGlzKSk7XHJcblxyXG4gICAgICAgIC8vIFByb2Nlc3MgZXhpc3Rpbmcgbm90ZXMgaW4gdGhlIHZhdWx0XHJcbiAgICAgICAgdGhpcy5wcm9jZXNzQWxsTm90ZXMoKTtcclxuICAgICAgICBcclxuICAgICAgICBjb25zb2xlLmxvZygnS25vd2xlZGdlIFN5bnRoZXNpcyBwbHVnaW4gbG9hZGVkJyk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBDbGVhbiB1cCB3aGVuIHBsdWdpbiBpcyBkaXNhYmxlZFxyXG4gICAgICovXHJcbiAgICBvbnVubG9hZCgpIHtcclxuICAgICAgICBjb25zb2xlLmxvZygnS25vd2xlZGdlIFN5bnRoZXNpcyBwbHVnaW4gdW5sb2FkZWQnKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIExvYWQgcGx1Z2luIHNldHRpbmdzXHJcbiAgICAgKi9cclxuICAgIGFzeW5jIGxvYWRTZXR0aW5ncygpIHtcclxuICAgICAgICB0aGlzLnNldHRpbmdzID0gT2JqZWN0LmFzc2lnbih7fSwgREVGQVVMVF9TRVRUSU5HUywgYXdhaXQgdGhpcy5sb2FkRGF0YSgpKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFNhdmUgcGx1Z2luIHNldHRpbmdzXHJcbiAgICAgKi9cclxuICAgIGFzeW5jIHNhdmVTZXR0aW5ncygpIHtcclxuICAgICAgICBhd2FpdCB0aGlzLnNhdmVEYXRhKHRoaXMuc2V0dGluZ3MpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIFVwZGF0ZSBleHRyYWN0b3Igc2Vuc2l0aXZpdHkgd2hlbiBzZXR0aW5ncyBjaGFuZ2VcclxuICAgICAgICB0aGlzLmNvbmNlcHRFeHRyYWN0b3Iuc2V0U2Vuc2l0aXZpdHkodGhpcy5zZXR0aW5ncy5leHRyYWN0aW9uU2Vuc2l0aXZpdHkpO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvKipcclxuICAgICAqIEFkZCBwbHVnaW4gY29tbWFuZHMgdG8gT2JzaWRpYW4gY29tbWFuZCBwYWxldHRlXHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgYWRkQ29tbWFuZHMoKSB7XHJcbiAgICAgICAgLy8gQ29tbWFuZCB0byBleHRyYWN0IGNvbmNlcHRzIGZyb20gY3VycmVudCBub3RlXHJcbiAgICAgICAgdGhpcy5hZGRDb21tYW5kKHtcclxuICAgICAgICAgICAgaWQ6ICdleHRyYWN0LWNvbmNlcHRzJyxcclxuICAgICAgICAgICAgbmFtZTogJ0V4dHJhY3QgQ29uY2VwdHMgZnJvbSBDdXJyZW50IE5vdGUnLFxyXG4gICAgICAgICAgICBjaGVja0NhbGxiYWNrOiAoY2hlY2tpbmc6IGJvb2xlYW4pID0+IHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGFjdGl2ZVZpZXcgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlVmlld09mVHlwZShNYXJrZG93blZpZXcpO1xyXG4gICAgICAgICAgICAgICAgaWYgKGFjdGl2ZVZpZXcpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoIWNoZWNraW5nKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucHJvY2Vzc0N1cnJlbnROb3RlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gQ29tbWFuZCB0byBzaG93IHJlbGF0ZWQgbm90ZXNcclxuICAgICAgICB0aGlzLmFkZENvbW1hbmQoe1xyXG4gICAgICAgICAgICBpZDogJ3Nob3ctcmVsYXRlZC1ub3RlcycsXHJcbiAgICAgICAgICAgIG5hbWU6ICdTaG93IFJlbGF0ZWQgTm90ZXMnLFxyXG4gICAgICAgICAgICBjaGVja0NhbGxiYWNrOiAoY2hlY2tpbmc6IGJvb2xlYW4pID0+IHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGFjdGl2ZVZpZXcgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlVmlld09mVHlwZShNYXJrZG93blZpZXcpO1xyXG4gICAgICAgICAgICAgICAgaWYgKGFjdGl2ZVZpZXcpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoIWNoZWNraW5nKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYWN0aXZhdGVWaWV3KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gQ29tbWFuZCB0byBnZW5lcmF0ZSBzdW1tYXJ5IGZyb20gcmVsYXRlZCBub3Rlc1xyXG4gICAgICAgIHRoaXMuYWRkQ29tbWFuZCh7XHJcbiAgICAgICAgICAgIGlkOiAnZ2VuZXJhdGUtc3VtbWFyeScsXHJcbiAgICAgICAgICAgIG5hbWU6ICdHZW5lcmF0ZSBTdW1tYXJ5IGZyb20gUmVsYXRlZCBOb3RlcycsXHJcbiAgICAgICAgICAgIGNoZWNrQ2FsbGJhY2s6IChjaGVja2luZzogYm9vbGVhbikgPT4ge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgYWN0aXZlVmlldyA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVWaWV3T2ZUeXBlKE1hcmtkb3duVmlldyk7XHJcbiAgICAgICAgICAgICAgICBpZiAoYWN0aXZlVmlldyAmJiBhY3RpdmVWaWV3LmZpbGUpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoIWNoZWNraW5nKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZ2VuZXJhdGVTdW1tYXJ5KGFjdGl2ZVZpZXcuZmlsZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8qKlxyXG4gICAgICogUmVnaXN0ZXIgZXZlbnQgaGFuZGxlcnNcclxuICAgICAqL1xyXG4gICAgcHJpdmF0ZSByZWdpc3RlckV2ZW50cygpIHtcclxuICAgICAgICAvLyBQcm9jZXNzIG5vdGUgd2hlbiBpdCdzIHNhdmVkXHJcbiAgICAgICAgdGhpcy5yZWdpc3RlckV2ZW50KFxyXG4gICAgICAgICAgICB0aGlzLmFwcC52YXVsdC5vbignbW9kaWZ5JywgKGZpbGUpID0+IHtcclxuICAgICAgICAgICAgICAgIGlmIChmaWxlIGluc3RhbmNlb2YgVEZpbGUgJiYgZmlsZS5leHRlbnNpb24gPT09ICdtZCcpIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyBPbmx5IHByb2Nlc3MgaWYgcmVhbFRpbWVTdWdnZXN0aW9ucyBpcyBlbmFibGVkXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuc2V0dGluZ3MucmVhbFRpbWVTdWdnZXN0aW9ucykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm5vdGVQcm9jZXNzb3IucHJvY2Vzc05vdGUoZmlsZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gUmVtb3ZlIG5vdGUgZnJvbSBncmFwaCB3aGVuIGRlbGV0ZWRcclxuICAgICAgICB0aGlzLnJlZ2lzdGVyRXZlbnQoXHJcbiAgICAgICAgICAgIHRoaXMuYXBwLnZhdWx0Lm9uKCdkZWxldGUnLCAoZmlsZSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYgKGZpbGUgaW5zdGFuY2VvZiBURmlsZSAmJiBmaWxlLmV4dGVuc2lvbiA9PT0gJ21kJykge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY29uY2VwdEdyYXBoLnJlbW92ZU5vdGUoZmlsZS5wYXRoKTtcclxuICAgICAgICAgICAgICAgICAgICAvLyBTYXZlIGNoYW5nZXNcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmRhdGFNYW5hZ2VyLnNhdmVDb25jZXB0RGF0YSgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gVXBkYXRlIHdoZW4gYSBmaWxlIGlzIHJlbmFtZWRcclxuICAgICAgICB0aGlzLnJlZ2lzdGVyRXZlbnQoXHJcbiAgICAgICAgICAgIHRoaXMuYXBwLnZhdWx0Lm9uKCdyZW5hbWUnLCAoZmlsZSwgb2xkUGF0aCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYgKGZpbGUgaW5zdGFuY2VvZiBURmlsZSAmJiBmaWxlLmV4dGVuc2lvbiA9PT0gJ21kJykge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIFJlbW92ZSBvbGQgcGF0aCBhbmQgYWRkIHdpdGggbmV3IHBhdGhcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmNvbmNlcHRHcmFwaC5yZW1vdmVOb3RlKG9sZFBhdGgpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMubm90ZVByb2Nlc3Nvci5wcm9jZXNzTm90ZShmaWxlKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSlcclxuICAgICAgICApO1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIFByb2Nlc3MgY3VycmVudCBub3RlIHdoZW4gYWN0aXZlIGxlYWYgY2hhbmdlc1xyXG4gICAgICAgIHRoaXMucmVnaXN0ZXJFdmVudChcclxuICAgICAgICAgICAgdGhpcy5hcHAud29ya3NwYWNlLm9uKCdhY3RpdmUtbGVhZi1jaGFuZ2UnLCAobGVhZikgPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYgKGxlYWY/LnZpZXcgaW5zdGFuY2VvZiBNYXJrZG93blZpZXcgJiYgdGhpcy5zZXR0aW5ncy5yZWFsVGltZVN1Z2dlc3Rpb25zKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wcm9jZXNzQ3VycmVudE5vdGUoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSlcclxuICAgICAgICApO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvKipcclxuICAgICAqIFByb2Nlc3MgdGhlIGN1cnJlbnQgYWN0aXZlIG5vdGVcclxuICAgICAqL1xyXG4gICAgcHJpdmF0ZSBhc3luYyBwcm9jZXNzQ3VycmVudE5vdGUoKSB7XHJcbiAgICAgICAgY29uc3QgYWN0aXZlVmlldyA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVWaWV3T2ZUeXBlKE1hcmtkb3duVmlldyk7XHJcbiAgICAgICAgaWYgKGFjdGl2ZVZpZXcgJiYgYWN0aXZlVmlldy5maWxlKSB7XHJcbiAgICAgICAgICAgIGF3YWl0IHRoaXMubm90ZVByb2Nlc3Nvci5wcm9jZXNzTm90ZShhY3RpdmVWaWV3LmZpbGUpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgLy8gVXBkYXRlIHJlbGF0ZWQgbm90ZXMgdmlldyBpZiBpdCdzIG9wZW5cclxuICAgICAgICAgICAgdGhpcy51cGRhdGVSZWxhdGVkTm90ZXNWaWV3KGFjdGl2ZVZpZXcuZmlsZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvKipcclxuICAgICAqIEFjdGl2YXRlIHRoZSByZWxhdGVkIG5vdGVzIHZpZXdcclxuICAgICAqL1xyXG4gICAgcHJpdmF0ZSBhc3luYyBhY3RpdmF0ZVZpZXcoKSB7XHJcbiAgICAgICAgLy8gQ2hlY2sgaWYgdmlldyBpcyBhbHJlYWR5IG9wZW5cclxuICAgICAgICBjb25zdCBsZWF2ZXMgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0TGVhdmVzT2ZUeXBlKFJFTEFURURfTk9URVNfVklFV19UWVBFKTtcclxuICAgICAgICBcclxuICAgICAgICBpZiAobGVhdmVzLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICAgICAgICAvLyBDcmVhdGUgdGhlIHZpZXcgaWYgaXQgZG9lc24ndCBleGlzdFxyXG4gICAgICAgICAgICBjb25zdCBsZWFmID0gdGhpcy5hcHAud29ya3NwYWNlLmdldFJpZ2h0TGVhZihmYWxzZSk7XHJcbiAgICAgICAgICAgIGlmIChsZWFmKSB7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCBsZWFmLnNldFZpZXdTdGF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogUkVMQVRFRF9OT1RFU19WSUVXX1RZUEUsXHJcbiAgICAgICAgICAgICAgICAgICAgYWN0aXZlOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gRm9jdXMgdGhlIHZpZXdcclxuICAgICAgICBjb25zdCBleGlzdGluZ0xlYXZlcyA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRMZWF2ZXNPZlR5cGUoUkVMQVRFRF9OT1RFU19WSUVXX1RZUEUpO1xyXG4gICAgICAgIGlmIChleGlzdGluZ0xlYXZlcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgIHRoaXMuYXBwLndvcmtzcGFjZS5yZXZlYWxMZWFmKGV4aXN0aW5nTGVhdmVzWzBdKTtcclxuICAgICAgICBcclxuICAgICAgICAgICAgLy8gVXBkYXRlIHdpdGggY3VycmVudCBmaWxlXHJcbiAgICAgICAgICAgIGNvbnN0IGFjdGl2ZVZpZXcgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlVmlld09mVHlwZShNYXJrZG93blZpZXcpO1xyXG4gICAgICAgICAgICBpZiAoYWN0aXZlVmlldyAmJiBhY3RpdmVWaWV3LmZpbGUpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlUmVsYXRlZE5vdGVzVmlldyhhY3RpdmVWaWV3LmZpbGUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvKipcclxuICAgICAqIFVwZGF0ZSB0aGUgcmVsYXRlZCBub3RlcyB2aWV3IHdpdGggZGF0YSBmb3IgYSBmaWxlXHJcbiAgICAgKiBAcGFyYW0gZmlsZSBGaWxlIHRvIHNob3cgcmVsYXRlZCBub3RlcyBmb3JcclxuICAgICAqL1xyXG4gICAgcHJpdmF0ZSB1cGRhdGVSZWxhdGVkTm90ZXNWaWV3KGZpbGU6IFRGaWxlKSB7XHJcbiAgICAgICAgY29uc3QgbGVhdmVzID0gdGhpcy5hcHAud29ya3NwYWNlLmdldExlYXZlc09mVHlwZShSRUxBVEVEX05PVEVTX1ZJRVdfVFlQRSk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgaWYgKGxlYXZlcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHZpZXcgPSBsZWF2ZXNbMF0udmlldyBhcyBSZWxhdGVkTm90ZXNWaWV3O1xyXG4gICAgICAgICAgICBjb25zdCByZWxhdGVkTm90ZXMgPSB0aGlzLmNvbmNlcHRHcmFwaC5maW5kUmVsYXRlZE5vdGVzKFxyXG4gICAgICAgICAgICAgICAgZmlsZS5wYXRoLCBcclxuICAgICAgICAgICAgICAgIHRoaXMuc2V0dGluZ3MubWF4UmVsYXRlZE5vdGVzXHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICB2aWV3LnVwZGF0ZVJlbGF0ZWROb3RlcyhmaWxlLCByZWxhdGVkTm90ZXMpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIFxyXG4gICAgLyoqXHJcbiAgICAgKiBQcm9jZXNzIGFsbCBleGlzdGluZyBub3RlcyBpbiB0aGUgdmF1bHRcclxuICAgICAqIFB1YmxpYyBmb3Igc2V0dGluZ3MgdGFiIGFjY2Vzc1xyXG4gICAgICovXHJcbiAgICBwdWJsaWMgYXN5bmMgcHJvY2Vzc0FsbE5vdGVzKCk6IFByb21pc2U8dm9pZD4ge1xyXG4gICAgICAgIGF3YWl0IHRoaXMubm90ZVByb2Nlc3Nvci5wcm9jZXNzQWxsTm90ZXMoKTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgLyoqXHJcbiAgICAgKiBDbGVhciBhbGwgc3RvcmVkIGRhdGFcclxuICAgICAqIFB1YmxpYyBmb3Igc2V0dGluZ3MgdGFiIGFjY2Vzc1xyXG4gICAgICovXHJcbiAgICBwdWJsaWMgYXN5bmMgY2xlYXJEYXRhKCk6IFByb21pc2U8dm9pZD4ge1xyXG4gICAgICAgIGF3YWl0IHRoaXMuZGF0YU1hbmFnZXIuY2xlYXJEYXRhKCk7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8qKlxyXG4gICAgICogQVBJIG1ldGhvZDogR2V0IHJlbGF0ZWQgbm90ZXMgZm9yIGEgZmlsZVxyXG4gICAgICogQHBhcmFtIGZpbGUgRmlsZSB0byBmaW5kIHJlbGF0ZWQgbm90ZXMgZm9yXHJcbiAgICAgKiBAcmV0dXJucyBBcnJheSBvZiByZWxhdGVkIG5vdGVzXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBhc3luYyBnZXRSZWxhdGVkTm90ZXMoZmlsZTogVEZpbGUpOiBQcm9taXNlPFJlbGF0ZWROb3RlW10+IHtcclxuICAgICAgICByZXR1cm4gdGhpcy5jb25jZXB0R3JhcGguZmluZFJlbGF0ZWROb3RlcyhcclxuICAgICAgICAgICAgZmlsZS5wYXRoLCBcclxuICAgICAgICAgICAgdGhpcy5zZXR0aW5ncy5tYXhSZWxhdGVkTm90ZXNcclxuICAgICAgICApO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvKipcclxuICAgICAqIEFQSSBtZXRob2Q6IEV4dHJhY3QgY29uY2VwdHMgZnJvbSBjb250ZW50XHJcbiAgICAgKiBAcGFyYW0gY29udGVudCBUZXh0IGNvbnRlbnQgdG8gYW5hbHl6ZVxyXG4gICAgICogQHJldHVybnMgQXJyYXkgb2YgZXh0cmFjdGVkIGNvbmNlcHRzXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBleHRyYWN0Q29uY2VwdHMoY29udGVudDogc3RyaW5nKTogc3RyaW5nW10ge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmNvbmNlcHRFeHRyYWN0b3IuZXh0cmFjdENvbmNlcHRzKGNvbnRlbnQpO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvKipcclxuICAgICAqIEFQSSBtZXRob2Q6IEFkZCBhIGNvbmNlcHQgdG8gYSBub3RlICh1c2VkIGJ5IFVJIHdoZW4gdXNlciBhZGRzIGEgY29uY2VwdClcclxuICAgICAqIEBwYXJhbSBmaWxlUGF0aCBQYXRoIHRvIHRoZSBmaWxlXHJcbiAgICAgKiBAcGFyYW0gY29uY2VwdCBDb25jZXB0IHRvIGFkZFxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgYXN5bmMgYWRkQ29uY2VwdFRvTm90ZShmaWxlUGF0aDogc3RyaW5nLCBjb25jZXB0OiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcclxuICAgICAgICAvLyBHZXQgY3VycmVudCBjb25jZXB0c1xyXG4gICAgICAgIGNvbnN0IGNvbmNlcHRzID0gdGhpcy5jb25jZXB0R3JhcGguZ2V0Tm90ZUNvbmNlcHRzKGZpbGVQYXRoKTtcclxuICAgICAgICBcclxuICAgICAgICAvLyBBZGQgbmV3IGNvbmNlcHQgaWYgbm90IGFscmVhZHkgcHJlc2VudFxyXG4gICAgICAgIGlmICghY29uY2VwdHMuaW5jbHVkZXMoY29uY2VwdCkpIHtcclxuICAgICAgICAgICAgY29uY2VwdHMucHVzaChjb25jZXB0KTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIFVwZGF0ZSB0aGUgZ3JhcGhcclxuICAgICAgICAgICAgdGhpcy5jb25jZXB0R3JhcGguYWRkTm90ZShmaWxlUGF0aCwgY29uY2VwdHMpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgLy8gU2F2ZSBjaGFuZ2VzXHJcbiAgICAgICAgICAgIGF3YWl0IHRoaXMuZGF0YU1hbmFnZXIuc2F2ZUNvbmNlcHREYXRhKCk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyBOb3RpZnkgc3VjY2Vzc1xyXG4gICAgICAgICAgICBuZXcgTm90aWNlKGBBZGRlZCBjb25jZXB0IFwiJHtjb25jZXB0fVwiIHRvIG5vdGVgKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8qKlxyXG4gICAgICogQVBJIG1ldGhvZDogR2VuZXJhdGUgYSBzdW1tYXJ5IGZyb20gcmVsYXRlZCBub3Rlc1xyXG4gICAgICogQHBhcmFtIGZpbGUgRmlsZSB0byBnZW5lcmF0ZSBzdW1tYXJ5IGZvclxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgZ2VuZXJhdGVTdW1tYXJ5KGZpbGU6IFRGaWxlKTogUHJvbWlzZTxzdHJpbmc+IHtcclxuICAgICAgICByZXR1cm4gdGhpcy5zdW1tYXJ5R2VuZXJhdG9yLmdlbmVyYXRlU3VtbWFyeShmaWxlKTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgLyoqXHJcbiAgICAgKiBBUEkgbWV0aG9kOiBHZXQgcGx1Z2luIHNldHRpbmdzXHJcbiAgICAgKiBAcmV0dXJucyBDdXJyZW50IHBsdWdpbiBzZXR0aW5nc1xyXG4gICAgICovXHJcbiAgICBwdWJsaWMgZ2V0U2V0dGluZ3MoKTogS25vd2xlZGdlU3ludGhlc2lzU2V0dGluZ3Mge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnNldHRpbmdzO1xyXG4gICAgfVxyXG59IiwgImltcG9ydCB7IFRleHRQcm9jZXNzb3IgfSBmcm9tICcuL3R5cGVzJztcclxuXHJcbi8vSW1wbGVtZW50YXRpb24gb2YgdGV4dCBwcm9jZXNzaW5nIHV0aWxpdGllcyBmb3IgTkxQXHJcblxyXG5leHBvcnQgY2xhc3MgVGV4dFByb2Nlc3NpbmdVdGlscyBpbXBsZW1lbnRzIFRleHRQcm9jZXNzb3Ige1xyXG4gICAgLy9Db21tb24gRW5nbGlzaCBzdG9wIHdvcmRzIHRvIGZpbHRlciBvdXRcclxuICAgIHByaXZhdGUgc3RvcFdvcmRzOiBTZXQ8c3RyaW5nPiA9IG5ldyBTZXQoW1xyXG4gICAgICAgICdhJywgJ2FuJywgJ3RoZScsICdhbmQnLCAnb3InLCAnYnV0JywgJ2lzJywgJ2FyZScsICd3YXMnLCAnd2VyZScsIFxyXG4gICAgICAgICdiZScsICdiZWVuJywgJ2JlaW5nJywgJ2hhdmUnLCAnaGFzJywgJ2hhZCcsICdkbycsICdkb2VzJywgJ2RpZCcsXHJcbiAgICAgICAgJ29mJywgJ2FzJywgJ2xpa2UnLCAnaWYnLCAndGhhdCcsICd5b3UnLCAnd2l0aCcsICd5b3VyJywgJ3Rocm91Z2gnLFxyXG4gICAgICAgICd0bycsICdmcm9tJywgJ2luJywgJ291dCcsICdvbicsICdvZmYnLCAnb3ZlcicsICd1bmRlcicsICdhZ2FpbicsXHJcbiAgICAgICAgJ2Z1cnRoZXInLCAndGhlbicsICdvbmNlJywgJ2hlcmUnLCAndGhlcmUnLCAnd2hlbicsICd3aGVyZScsICd3aHknLFxyXG4gICAgICAgICdob3cnLCAnYWxsJywgJ2FueScsICdib3RoJywgJ2VhY2gnLCAnZmV3JywgJ21vcmUnLCAnbW9zdCcsICdvdGhlcicsXHJcbiAgICAgICAgJ3NvbWUnLCAnc3VjaCcsICdubycsICdub3InLCAnbm90JywgJ29ubHknLCAnb3duJywgJ3NhbWUnLCAnc28nLCBcclxuICAgICAgICAndGhhbicsICd0b28nLCAndmVyeScsICdjYW4nLCAnd2lsbCcsICdqdXN0JywgJ3Nob3VsZCcsICdub3cnXHJcbiAgICBdKTtcclxuXHJcbiAgICAvKipcclxuICAgICAqIFRva2VuaXplIHRleHQgaW50byB3b3Jkc1xyXG4gICAgICogQHBhcmFtIHRleHQgSW5wdXQgdGV4dCB0byB0b2tlbml6ZVxyXG4gICAgICogQHJldHVybnMgQXJyYXkgb2YgdG9rZW5zXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyB0b2tlbml6ZSh0ZXh0OiBzdHJpbmcpOiBzdHJpbmdbXSB7XHJcbiAgICAgICAgLy9SZW1vdmUgc3BlY2lhbCBjaGFyYWN0ZXJzIGFuZCB0b2tlbml6ZVxyXG4gICAgICAgIGNvbnN0IG5vcm1hbGl6ZWQgPSB0ZXh0LnRvTG93ZXJDYXNlKClcclxuICAgICAgICAgICAgLnJlcGxhY2UoL1teXFx3XFxzXS9nLCAnICcpICAvL1JlcGxhY2Ugc3BlY2lhbCBjaGFycyB3aXRoIHNwYWNlXHJcbiAgICAgICAgICAgIC5yZXBsYWNlKC9cXHMrL2csICcgJykgICAgICAvL1JlcGxhY2UgbXVsdGlwbGUgc3BhY2VzIHdpdGggc2luZ2xlIHNwYWNlXHJcbiAgICAgICAgICAgIC50cmltKCk7ICAgICAgICAgICAgICAgICAgIC8vVHJpbSBsZWFkaW5nL3RyYWlsaW5nIHNwYWNlc1xyXG4gICAgICAgIFxyXG4gICAgICAgIHJldHVybiBub3JtYWxpemVkLnNwbGl0KCcgJyk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBDYWxjdWxhdGUgdGVybSBmcmVxdWVuY3kgZm9yIHRva2Vuc1xyXG4gICAgICogQHBhcmFtIHRva2VucyBBcnJheSBvZiB0b2tlbnNcclxuICAgICAqIEByZXR1cm5zIE1hcCBvZiB0ZXJtcyB0byB0aGVpciBmcmVxdWVuY3lcclxuICAgICAqL1xyXG4gICAgcHVibGljIGNhbGN1bGF0ZVRlcm1GcmVxdWVuY3kodG9rZW5zOiBzdHJpbmdbXSk6IE1hcDxzdHJpbmcsIG51bWJlcj4ge1xyXG4gICAgICAgIGNvbnN0IHRlcm1GcmVxdWVuY3kgPSBuZXcgTWFwPHN0cmluZywgbnVtYmVyPigpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIGZvciAoY29uc3QgdG9rZW4gb2YgdG9rZW5zKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGNvdW50ID0gdGVybUZyZXF1ZW5jeS5nZXQodG9rZW4pIHx8IDA7XHJcbiAgICAgICAgICAgIHRlcm1GcmVxdWVuY3kuc2V0KHRva2VuLCBjb3VudCArIDEpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICByZXR1cm4gdGVybUZyZXF1ZW5jeTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFJlbW92ZSBjb21tb24gc3RvcCB3b3JkcyBmcm9tIHRva2Vuc1xyXG4gICAgICogQHBhcmFtIHRva2VucyBBcnJheSBvZiB0b2tlbnNcclxuICAgICAqIEByZXR1cm5zIEZpbHRlcmVkIGFycmF5IHdpdGggc3RvcCB3b3JkcyByZW1vdmVkXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyByZW1vdmVTdG9wV29yZHModG9rZW5zOiBzdHJpbmdbXSk6IHN0cmluZ1tdIHtcclxuICAgICAgICByZXR1cm4gdG9rZW5zLmZpbHRlcih0b2tlbiA9PiAhdGhpcy5zdG9wV29yZHMuaGFzKHRva2VuKSAmJiB0b2tlbi5sZW5ndGggPiAxKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIEJhc2ljIHN0ZW1taW5nIGFsZ29yaXRobSBmb3IgRW5nbGlzaFxyXG4gICAgICogSW1wbGVtZW50cyBhIHNpbXBsZSB2ZXJzaW9uIG9mIFBvcnRlciBzdGVtbWluZ1xyXG4gICAgICogQHBhcmFtIHRva2VucyBBcnJheSBvZiB0b2tlbnNcclxuICAgICAqIEByZXR1cm5zIEFycmF5IG9mIHN0ZW1tZWQgdG9rZW5zXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBzdGVtV29yZHModG9rZW5zOiBzdHJpbmdbXSk6IHN0cmluZ1tdIHtcclxuICAgICAgICByZXR1cm4gdG9rZW5zLm1hcCh0b2tlbiA9PiB7XHJcbiAgICAgICAgICAgIC8vIEJhc2ljIHN0ZW1taW5nIHJ1bGVzIChzaW1wbGlmaWVkKVxyXG4gICAgICAgICAgICBpZiAodG9rZW4uZW5kc1dpdGgoJ2luZycpKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdG9rZW4uc2xpY2UoMCwgLTMpO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKHRva2VuLmVuZHNXaXRoKCdseScpKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdG9rZW4uc2xpY2UoMCwgLTIpO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKHRva2VuLmVuZHNXaXRoKCdzJykgJiYgIXRva2VuLmVuZHNXaXRoKCdzcycpKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdG9rZW4uc2xpY2UoMCwgLTEpO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKHRva2VuLmVuZHNXaXRoKCdlZCcpICYmIHRva2VuLmxlbmd0aCA+IDQpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0b2tlbi5zbGljZSgwLCAtMik7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdG9rZW47XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIEV4dHJhY3QgcG90ZW50aWFsIG5hbWVkIGVudGl0aWVzIGZyb20gdGV4dFxyXG4gICAgICogVmVyeSBzaW1wbGlmaWVkIGltcGxlbWVudGF0aW9uIGZvciBwcm9vZiBvZiBjb25jZXB0XHJcbiAgICAgKiBAcGFyYW0gdGV4dCBJbnB1dCB0ZXh0XHJcbiAgICAgKiBAcmV0dXJucyBBcnJheSBvZiBwb3RlbnRpYWwgbmFtZWQgZW50aXRpZXNcclxuICAgICAqL1xyXG4gICAgcHVibGljIGV4dHJhY3ROYW1lZEVudGl0aWVzKHRleHQ6IHN0cmluZyk6IHN0cmluZ1tdIHtcclxuICAgICAgICBjb25zdCBzZW50ZW5jZXMgPSB0ZXh0LnNwbGl0KC9bLiE/XSsvKTtcclxuICAgICAgICBjb25zdCBlbnRpdGllczogc3RyaW5nW10gPSBbXTtcclxuICAgICAgICBcclxuICAgICAgICAvL1NpbXBsZSBuYW1lZCBlbnRpdHkgZGV0ZWN0aW9uIGJhc2VkIG9uIGNhcGl0YWxpemF0aW9uIGkuZS4gdGhpcyBjaGVja3MgZm9yIG5hbWVzXHJcbiAgICAgICAgZm9yIChjb25zdCBzZW50ZW5jZSBvZiBzZW50ZW5jZXMpIHtcclxuICAgICAgICAgICAgY29uc3Qgd29yZHMgPSBzZW50ZW5jZS50cmltKCkuc3BsaXQoJyAnKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgd29yZHMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHdvcmQgPSB3b3Jkc1tpXTtcclxuICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgLy9Ta2lwIGZpcnN0IHdvcmQgb2Ygc2VudGVuY2UgYW5kIGNoZWNrIGZvciBjYXBpdGFsaXphdGlvblxyXG4gICAgICAgICAgICAgICAgaWYgKGkgPiAwICYmIHdvcmQubGVuZ3RoID4gMSAmJiAvXltBLVpdW2Etel0rJC8udGVzdCh3b3JkKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGVudGl0aWVzLnB1c2god29yZCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgIC8vQ2hlY2sgZm9yIGNvbnNlY3V0aXZlIGNhcGl0YWxpemVkIHdvcmRzIChjb21wb3VuZCBlbnRpdGllcylcclxuICAgICAgICAgICAgICAgIGlmIChpIDwgd29yZHMubGVuZ3RoIC0gMSAmJiBcclxuICAgICAgICAgICAgICAgICAgICB3b3JkLmxlbmd0aCA+IDEgJiYgXHJcbiAgICAgICAgICAgICAgICAgICAgL15bQS1aXVthLXpdKyQvLnRlc3Qod29yZCkgJiYgXHJcbiAgICAgICAgICAgICAgICAgICAgL15bQS1aXVthLXpdKyQvLnRlc3Qod29yZHNbaSsxXSkpIHtcclxuICAgICAgICAgICAgICAgICAgICBlbnRpdGllcy5wdXNoKGAke3dvcmR9ICR7d29yZHNbaSsxXX1gKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICByZXR1cm4gWy4uLm5ldyBTZXQoZW50aXRpZXMpXTsvL1JlbW92ZSBkdXBsaWNhdGVzXHJcbiAgICB9XHJcbn0iLCAiaW1wb3J0IHsgQ29uY2VwdEV4dHJhY3RvciB9IGZyb20gJ3NyYy91dGlscy90eXBlcyc7XHJcbmltcG9ydCB7IFRleHRQcm9jZXNzaW5nVXRpbHMgfSBmcm9tICdzcmMvdXRpbHMvdGV4dC1wcm9jZXNzaW5nJztcclxuXHJcbi8qKlxyXG4gKiBJbXBsZW1lbnRhdGlvbiBvZiBDb25jZXB0IEV4dHJhY3Rpb24gdXNpbmcgTkxQIHRlY2huaXF1ZXNcclxuICovXHJcbmV4cG9ydCBjbGFzcyBDb25jZXB0RXh0cmFjdG9ySW1wbCBpbXBsZW1lbnRzIENvbmNlcHRFeHRyYWN0b3Ige1xyXG4gICAgcHJpdmF0ZSBzZW5zaXRpdml0eTogbnVtYmVyID0gNTsgLy9EZWZhdWx0IHNlbnNpdGl2aXR5ICgxLTEwKVxyXG4gICAgcHJpdmF0ZSB0ZXh0UHJvY2Vzc29yOiBUZXh0UHJvY2Vzc2luZ1V0aWxzO1xyXG4gICAgcHJpdmF0ZSB1c2VyRmVlZGJhY2s6IE1hcDxzdHJpbmcsIGJvb2xlYW4+ID0gbmV3IE1hcCgpOyAvL1N0b3JlIHVzZXIgZmVlZGJhY2sgb24gY29uY2VwdHNcclxuICAgIFxyXG4gICAgY29uc3RydWN0b3IoKSB7XHJcbiAgICAgICAgdGhpcy50ZXh0UHJvY2Vzc29yID0gbmV3IFRleHRQcm9jZXNzaW5nVXRpbHMoKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIEV4dHJhY3QgY29uY2VwdHMgZnJvbSB0ZXh0IGNvbnRlbnRcclxuICAgICAqIEBwYXJhbSBjb250ZW50IFRleHQgY29udGVudCB0byBhbmFseXplXHJcbiAgICAgKiBAcmV0dXJucyBBcnJheSBvZiBleHRyYWN0ZWQgY29uY2VwdHNcclxuICAgICAqL1xyXG4gICAgcHVibGljIGV4dHJhY3RDb25jZXB0cyhjb250ZW50OiBzdHJpbmcpOiBzdHJpbmdbXSB7XHJcbiAgICAgICAgLy9Ta2lwIGVtcHR5IGNvbnRlbnRcclxuICAgICAgICBpZiAoIWNvbnRlbnQgfHwgY29udGVudC50cmltKCkgPT09ICcnKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBbXTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIEV4dHJhY3QgY29uY2VwdHMgdXNpbmcgbXVsdGlwbGUgdGVjaG5pcXVlc1xyXG4gICAgICAgIGNvbnN0IGNvbmNlcHRzOiBzdHJpbmdbXSA9IFtcclxuICAgICAgICAgICAgLi4udGhpcy5leHRyYWN0RnJvbVRmSWRmKGNvbnRlbnQpLFxyXG4gICAgICAgICAgICAuLi50aGlzLmV4dHJhY3RGcm9tSGVhZGluZ3MoY29udGVudCksXHJcbiAgICAgICAgICAgIC4uLnRoaXMuZXh0cmFjdEZyb21FbXBoYXNpcyhjb250ZW50KSxcclxuICAgICAgICAgICAgLi4udGhpcy5leHRyYWN0RnJvbU5hbWVkRW50aXRpZXMoY29udGVudClcclxuICAgICAgICBdO1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vQXBwbHkgdXNlciBmZWVkYmFja1xyXG4gICAgICAgIGNvbnN0IGZpbHRlcmVkQ29uY2VwdHMgPSBjb25jZXB0cy5maWx0ZXIoY29uY2VwdCA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGZlZWRiYWNrID0gdGhpcy51c2VyRmVlZGJhY2suZ2V0KGNvbmNlcHQpO1xyXG4gICAgICAgICAgICAvL0lmIHdlIGhhdmUgZXhwbGljaXQgbmVnYXRpdmUgZmVlZGJhY2ssIGZpbHRlciBpdCBvdXRcclxuICAgICAgICAgICAgaWYgKGZlZWRiYWNrID09PSBmYWxzZSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vUmVtb3ZlIGR1cGxpY2F0ZXMgYW5kIHJldHVybiBzb3J0ZWQgYnkgaW1wb3J0YW5jZVxyXG4gICAgICAgIHJldHVybiBbLi4ubmV3IFNldChmaWx0ZXJlZENvbmNlcHRzKV07XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBTZXQgc2Vuc2l0aXZpdHkgZm9yIGV4dHJhY3Rpb24gKDEtMTApXHJcbiAgICAgKiBAcGFyYW0gc2Vuc2l0aXZpdHkgU2Vuc2l0aXZpdHkgbGV2ZWwgKDEtMTApXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBzZXRTZW5zaXRpdml0eShzZW5zaXRpdml0eTogbnVtYmVyKTogdm9pZCB7XHJcbiAgICAgICAgLy8gRW5zdXJlIHNlbnNpdGl2aXR5IGlzIHdpdGhpbiB2YWxpZCByYW5nZVxyXG4gICAgICAgIHRoaXMuc2Vuc2l0aXZpdHkgPSBNYXRoLm1heCgxLCBNYXRoLm1pbigxMCwgc2Vuc2l0aXZpdHkpKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIExlYXJuIGZyb20gdXNlciBmZWVkYmFjayBvbiBjb25jZXB0IHJlbGV2YW5jZVxyXG4gICAgICogQHBhcmFtIGNvbmNlcHQgVGhlIGNvbmNlcHQgcmVjZWl2aW5nIGZlZWRiYWNrXHJcbiAgICAgKiBAcGFyYW0gaXNSZWxldmFudCBXaGV0aGVyIHRoZSB1c2VyIG1hcmtlZCBpdCBhcyByZWxldmFudFxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgbGVhcm5Gcm9tVXNlckZlZWRiYWNrKGNvbmNlcHQ6IHN0cmluZywgaXNSZWxldmFudDogYm9vbGVhbik6IHZvaWQge1xyXG4gICAgICAgIHRoaXMudXNlckZlZWRiYWNrLnNldChjb25jZXB0LCBpc1JlbGV2YW50KTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIEV4dHJhY3QgY29uY2VwdHMgdXNpbmcgVEYtSURGIGxpa2UgYXBwcm9hY2hcclxuICAgICAqIEBwYXJhbSBjb250ZW50IFRleHQgY29udGVudCB0byBhbmFseXplXHJcbiAgICAgKiBAcmV0dXJucyBBcnJheSBvZiBjb25jZXB0c1xyXG4gICAgICovXHJcbiAgICBwcml2YXRlIGV4dHJhY3RGcm9tVGZJZGYoY29udGVudDogc3RyaW5nKTogc3RyaW5nW10ge1xyXG4gICAgICAgIC8vVG9rZW5pemUgdGhlIGNvbnRlbnRcclxuICAgICAgICBjb25zdCB0b2tlbnMgPSB0aGlzLnRleHRQcm9jZXNzb3IudG9rZW5pemUoY29udGVudCk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy9yZW1vdmUgc3RvcCB3b3Jkc1xyXG4gICAgICAgIGNvbnN0IGZpbHRlcmVkVG9rZW5zID0gdGhpcy50ZXh0UHJvY2Vzc29yLnJlbW92ZVN0b3BXb3Jkcyh0b2tlbnMpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vY2FsY3VsYXRlIHRlcm0gZnJlcXVlbmN5XHJcbiAgICAgICAgY29uc3QgdGVybUZyZXF1ZW5jeSA9IHRoaXMudGV4dFByb2Nlc3Nvci5jYWxjdWxhdGVUZXJtRnJlcXVlbmN5KGZpbHRlcmVkVG9rZW5zKTtcclxuICAgICAgICBcclxuICAgICAgICAvL3NvcnQgYnkgZnJlcXVlbmN5IGFuZCB0YWtlIHRvcCBOIGJhc2VkIG9uIHNlbnNpdGl2aXR5XHJcbiAgICAgICAgY29uc3QgdGhyZXNob2xkID0gTWF0aC5tYXgoMiwgTWF0aC5mbG9vcigyMCAvICgxMSAtIHRoaXMuc2Vuc2l0aXZpdHkpKSk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy9jb252ZXJ0IHRvIGFycmF5IGFuZCBzb3J0IGJ5IGZyZXF1ZW5jeVxyXG4gICAgICAgIGNvbnN0IHNvcnRlZFRlcm1zID0gQXJyYXkuZnJvbSh0ZXJtRnJlcXVlbmN5LmVudHJpZXMoKSlcclxuICAgICAgICAgICAgLmZpbHRlcigoW18sIGZyZXFdKSA9PiBmcmVxID49IHRocmVzaG9sZClcclxuICAgICAgICAgICAgLnNvcnQoKGEsIGIpID0+IGJbMV0gLSBhWzFdKVxyXG4gICAgICAgICAgICAuc2xpY2UoMCwgdGhpcy5zZW5zaXRpdml0eSAqIDMpIC8vdGFrZSBtb3JlIHRlcm1zIHdpdGggaGlnaGVyIHNlbnNpdGl2aXR5XHJcbiAgICAgICAgICAgIC5tYXAoKFt0ZXJtLCBfXSkgPT4gdGVybSk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgIHJldHVybiBzb3J0ZWRUZXJtcztcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIEV4dHJhY3QgY29uY2VwdHMgZnJvbSBtYXJrZG93biBoZWFkaW5nc1xyXG4gICAgICogQHBhcmFtIGNvbnRlbnQgTWFya2Rvd24gY29udGVudFxyXG4gICAgICogQHJldHVybnMgQXJyYXkgb2YgY29uY2VwdHMgZnJvbSBoZWFkaW5nc1xyXG4gICAgICovXHJcbiAgICBwcml2YXRlIGV4dHJhY3RGcm9tSGVhZGluZ3MoY29udGVudDogc3RyaW5nKTogc3RyaW5nW10ge1xyXG4gICAgICAgIGNvbnN0IGhlYWRpbmdSZWdleCA9IC9eIytcXHMrKC4rKSQvZ207XHJcbiAgICAgICAgY29uc3QgaGVhZGluZ3M6IHN0cmluZ1tdID0gW107XHJcbiAgICAgICAgbGV0IG1hdGNoO1xyXG4gICAgICAgIFxyXG4gICAgICAgIHdoaWxlICgobWF0Y2ggPSBoZWFkaW5nUmVnZXguZXhlYyhjb250ZW50KSkgIT09IG51bGwpIHtcclxuICAgICAgICAgICAgaGVhZGluZ3MucHVzaChtYXRjaFsxXS50cmltKCkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICByZXR1cm4gaGVhZGluZ3M7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBFeHRyYWN0IGNvbmNlcHRzIGZyb20gZW1waGFzaXplZCB0ZXh0IChib2xkL2l0YWxpYylcclxuICAgICAqIEBwYXJhbSBjb250ZW50IE1hcmtkb3duIGNvbnRlbnRcclxuICAgICAqIEByZXR1cm5zIEFycmF5IG9mIGNvbmNlcHRzIGZyb20gZW1waGFzaXplZCB0ZXh0XHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgZXh0cmFjdEZyb21FbXBoYXNpcyhjb250ZW50OiBzdHJpbmcpOiBzdHJpbmdbXSB7XHJcbiAgICAgICAgY29uc3QgZW1waGFzaXNSZWdleCA9IC8oXFwqXFwqfF9fKSguKj8pXFwxfChcXCp8XykoLio/KVxcMy9nO1xyXG4gICAgICAgIGNvbnN0IGVtcGhhc2l6ZWQ6IHN0cmluZ1tdID0gW107XHJcbiAgICAgICAgbGV0IG1hdGNoO1xyXG4gICAgICAgIFxyXG4gICAgICAgIHdoaWxlICgobWF0Y2ggPSBlbXBoYXNpc1JlZ2V4LmV4ZWMoY29udGVudCkpICE9PSBudWxsKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHRleHQgPSBtYXRjaFsyXSB8fCBtYXRjaFs0XTtcclxuICAgICAgICAgICAgaWYgKHRleHQgJiYgdGV4dC50cmltKCkubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgZW1waGFzaXplZC5wdXNoKHRleHQudHJpbSgpKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICByZXR1cm4gZW1waGFzaXplZDtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIEV4dHJhY3QgbmFtZWQgZW50aXRpZXMgYXMgY29uY2VwdHNcclxuICAgICAqIEBwYXJhbSBjb250ZW50IFRleHQgY29udGVudFxyXG4gICAgICogQHJldHVybnMgQXJyYXkgb2YgbmFtZWQgZW50aXRpZXNcclxuICAgICAqL1xyXG4gICAgcHJpdmF0ZSBleHRyYWN0RnJvbU5hbWVkRW50aXRpZXMoY29udGVudDogc3RyaW5nKTogc3RyaW5nW10ge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnRleHRQcm9jZXNzb3IuZXh0cmFjdE5hbWVkRW50aXRpZXMoY29udGVudCk7XHJcbiAgICB9XHJcbn0iLCAiaW1wb3J0IHsgQ29uY2VwdEdyYXBoLCBSZWxhdGVkTm90ZSB9IGZyb20gJy4uL3V0aWxzL3R5cGVzJztcclxuaW1wb3J0IHsgVEZpbGUsIFZhdWx0IH0gZnJvbSAnb2JzaWRpYW4nO1xyXG5cclxuLyoqXHJcbiAqIFN0cnVjdHVyZSB0byBzdG9yZSBub3RlIGRhdGEgaW4gdGhlIGdyYXBoXHJcbiAqL1xyXG5pbnRlcmZhY2UgTm90ZU5vZGUge1xyXG4gICAgcGF0aDogc3RyaW5nO1xyXG4gICAgY29uY2VwdHM6IHN0cmluZ1tdO1xyXG4gICAgbGFzdFVwZGF0ZWQ6IG51bWJlcjtcclxufVxyXG5cclxuLyoqXHJcbiAqIFN0cnVjdHVyZSB0byBzdG9yZSBjb25jZXB0IGRhdGEgaW4gdGhlIGdyYXBoXHJcbiAqL1xyXG5pbnRlcmZhY2UgQ29uY2VwdE5vZGUge1xyXG4gICAgbmFtZTogc3RyaW5nO1xyXG4gICAgbm90ZVBhdGhzOiBzdHJpbmdbXTtcclxuICAgIHdlaWdodDogbnVtYmVyOyAvLyBDb25jZXB0IGltcG9ydGFuY2VcclxufVxyXG5cclxuLyoqXHJcbiAqIEltcGxlbWVudGF0aW9uIG9mIHRoZSBDb25jZXB0IEdyYXBoIHRoYXQgbWFuYWdlcyByZWxhdGlvbnNoaXBzIGJldHdlZW4gbm90ZXNcclxuICovXHJcbmV4cG9ydCBjbGFzcyBDb25jZXB0R3JhcGhJbXBsIGltcGxlbWVudHMgQ29uY2VwdEdyYXBoIHtcclxuICAgIHByaXZhdGUgbm90ZXM6IE1hcDxzdHJpbmcsIE5vdGVOb2RlPiA9IG5ldyBNYXAoKTtcclxuICAgIHByaXZhdGUgY29uY2VwdHM6IE1hcDxzdHJpbmcsIENvbmNlcHROb2RlPiA9IG5ldyBNYXAoKTtcclxuICAgIHByaXZhdGUgdmF1bHQ6IFZhdWx0O1xyXG4gICAgXHJcbiAgICBjb25zdHJ1Y3Rvcih2YXVsdDogVmF1bHQpIHtcclxuICAgICAgICB0aGlzLnZhdWx0ID0gdmF1bHQ7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBBZGQgYSBub3RlIHRvIHRoZSBncmFwaCB3aXRoIGl0cyBjb25jZXB0c1xyXG4gICAgICogQHBhcmFtIHBhdGggUGF0aCB0byB0aGUgbm90ZVxyXG4gICAgICogQHBhcmFtIGNvbmNlcHRzIEFycmF5IG9mIGNvbmNlcHRzIGluIHRoZSBub3RlXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBhZGROb3RlKHBhdGg6IHN0cmluZywgY29uY2VwdHM6IHN0cmluZ1tdKTogdm9pZCB7XHJcbiAgICAgICAgLy8gQ3JlYXRlIG9yIHVwZGF0ZSB0aGUgbm90ZSBub2RlXHJcbiAgICAgICAgdGhpcy5ub3Rlcy5zZXQocGF0aCwge1xyXG4gICAgICAgICAgICBwYXRoLFxyXG4gICAgICAgICAgICBjb25jZXB0cyxcclxuICAgICAgICAgICAgbGFzdFVwZGF0ZWQ6IERhdGUubm93KClcclxuICAgICAgICB9KTtcclxuICAgICAgICBcclxuICAgICAgICAvLyBVcGRhdGUgY29uY2VwdCBub2Rlc1xyXG4gICAgICAgIGZvciAoY29uc3QgY29uY2VwdCBvZiBjb25jZXB0cykge1xyXG4gICAgICAgICAgICBjb25zdCBjb25jZXB0Tm9kZSA9IHRoaXMuY29uY2VwdHMuZ2V0KGNvbmNlcHQpIHx8IHtcclxuICAgICAgICAgICAgICAgIG5hbWU6IGNvbmNlcHQsXHJcbiAgICAgICAgICAgICAgICBub3RlUGF0aHM6IFtdLFxyXG4gICAgICAgICAgICAgICAgd2VpZ2h0OiAxXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyBBZGQgdGhpcyBub3RlIHRvIHRoZSBjb25jZXB0IGlmIG5vdCBhbHJlYWR5IHByZXNlbnRcclxuICAgICAgICAgICAgaWYgKCFjb25jZXB0Tm9kZS5ub3RlUGF0aHMuaW5jbHVkZXMocGF0aCkpIHtcclxuICAgICAgICAgICAgICAgIGNvbmNlcHROb2RlLm5vdGVQYXRocy5wdXNoKHBhdGgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyBVcGRhdGUgdGhlIGNvbmNlcHQncyB3ZWlnaHQgYmFzZWQgb24gZnJlcXVlbmN5XHJcbiAgICAgICAgICAgIGNvbmNlcHROb2RlLndlaWdodCA9IGNvbmNlcHROb2RlLm5vdGVQYXRocy5sZW5ndGg7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyBTYXZlIHRoZSB1cGRhdGVkIGNvbmNlcHRcclxuICAgICAgICAgICAgdGhpcy5jb25jZXB0cy5zZXQoY29uY2VwdCwgY29uY2VwdE5vZGUpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFJlbW92ZSBhIG5vdGUgZnJvbSB0aGUgZ3JhcGhcclxuICAgICAqIEBwYXJhbSBwYXRoIFBhdGggdG8gdGhlIG5vdGUgdG8gcmVtb3ZlXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyByZW1vdmVOb3RlKHBhdGg6IHN0cmluZyk6IHZvaWQge1xyXG4gICAgICAgIC8vIEdldCB0aGUgbm90ZSdzIGNvbmNlcHRzIGJlZm9yZSByZW1vdmFsXHJcbiAgICAgICAgY29uc3Qgbm90ZSA9IHRoaXMubm90ZXMuZ2V0KHBhdGgpO1xyXG4gICAgICAgIGlmICghbm90ZSkge1xyXG4gICAgICAgICAgICByZXR1cm47IC8vIE5vdGUgZG9lc24ndCBleGlzdCBpbiB0aGUgZ3JhcGhcclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gUmVtb3ZlIG5vdGUgZnJvbSBhbGwgaXRzIGNvbmNlcHRzXHJcbiAgICAgICAgZm9yIChjb25zdCBjb25jZXB0IG9mIG5vdGUuY29uY2VwdHMpIHtcclxuICAgICAgICAgICAgY29uc3QgY29uY2VwdE5vZGUgPSB0aGlzLmNvbmNlcHRzLmdldChjb25jZXB0KTtcclxuICAgICAgICAgICAgaWYgKGNvbmNlcHROb2RlKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBGaWx0ZXIgb3V0IHRoaXMgbm90ZSBwYXRoXHJcbiAgICAgICAgICAgICAgICBjb25jZXB0Tm9kZS5ub3RlUGF0aHMgPSBjb25jZXB0Tm9kZS5ub3RlUGF0aHMuZmlsdGVyKHAgPT4gcCAhPT0gcGF0aCk7XHJcbiAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgIC8vIFVwZGF0ZSB3ZWlnaHRcclxuICAgICAgICAgICAgICAgIGNvbmNlcHROb2RlLndlaWdodCA9IGNvbmNlcHROb2RlLm5vdGVQYXRocy5sZW5ndGg7XHJcbiAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgIC8vIFJlbW92ZSBjb25jZXB0IGlmIGl0IG5vIGxvbmdlciBoYXMgYW55IG5vdGVzXHJcbiAgICAgICAgICAgICAgICBpZiAoY29uY2VwdE5vZGUubm90ZVBhdGhzLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY29uY2VwdHMuZGVsZXRlKGNvbmNlcHQpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmNvbmNlcHRzLnNldChjb25jZXB0LCBjb25jZXB0Tm9kZSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gUmVtb3ZlIHRoZSBub3RlIGl0c2VsZlxyXG4gICAgICAgIHRoaXMubm90ZXMuZGVsZXRlKHBhdGgpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogRmluZCBub3RlcyByZWxhdGVkIHRvIGEgZ2l2ZW4gbm90ZVxyXG4gICAgICogQHBhcmFtIG5vdGVQYXRoIFBhdGggdG8gdGhlIG5vdGVcclxuICAgICAqIEBwYXJhbSBtYXhSZXN1bHRzIE1heGltdW0gbnVtYmVyIG9mIHJlc3VsdHMgdG8gcmV0dXJuXHJcbiAgICAgKiBAcmV0dXJucyBBcnJheSBvZiByZWxhdGVkIG5vdGVzIHNvcnRlZCBieSByZWxldmFuY2VcclxuICAgICAqL1xyXG4gICAgcHVibGljIGZpbmRSZWxhdGVkTm90ZXMobm90ZVBhdGg6IHN0cmluZywgbWF4UmVzdWx0czogbnVtYmVyID0gMTApOiBSZWxhdGVkTm90ZVtdIHtcclxuICAgICAgICBjb25zdCBub3RlID0gdGhpcy5ub3Rlcy5nZXQobm90ZVBhdGgpO1xyXG4gICAgICAgIGlmICghbm90ZSkge1xyXG4gICAgICAgICAgICByZXR1cm4gW107IC8vIE5vdGUgZG9lc24ndCBleGlzdCBpbiB0aGUgZ3JhcGhcclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gQ2FsY3VsYXRlIHJlbGV2YW5jZSBzY29yZXMgZm9yIGFsbCBub3Rlc1xyXG4gICAgICAgIGNvbnN0IHNjb3JlczogTWFwPHN0cmluZywgeyBcclxuICAgICAgICAgICAgcmVsZXZhbmNlOiBudW1iZXIsIFxyXG4gICAgICAgICAgICBzaGFyZWRDb25jZXB0czogc3RyaW5nW10gXHJcbiAgICAgICAgfT4gPSBuZXcgTWFwKCk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gSXRlcmF0ZSB0aHJvdWdoIGNvbmNlcHRzIGluIHRoZSB0YXJnZXQgbm90ZVxyXG4gICAgICAgIGZvciAoY29uc3QgY29uY2VwdCBvZiBub3RlLmNvbmNlcHRzKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGNvbmNlcHROb2RlID0gdGhpcy5jb25jZXB0cy5nZXQoY29uY2VwdCk7XHJcbiAgICAgICAgICAgIGlmICghY29uY2VwdE5vZGUpIGNvbnRpbnVlO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgLy8gRm9yIGVhY2ggbm90ZSB0aGF0IGhhcyB0aGlzIGNvbmNlcHRcclxuICAgICAgICAgICAgZm9yIChjb25zdCByZWxhdGVkUGF0aCBvZiBjb25jZXB0Tm9kZS5ub3RlUGF0aHMpIHtcclxuICAgICAgICAgICAgICAgIC8vIFNraXAgdGhlIG9yaWdpbmFsIG5vdGVcclxuICAgICAgICAgICAgICAgIGlmIChyZWxhdGVkUGF0aCA9PT0gbm90ZVBhdGgpIGNvbnRpbnVlO1xyXG4gICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAvLyBHZXQgb3IgaW5pdGlhbGl6ZSBzY29yZSBkYXRhXHJcbiAgICAgICAgICAgICAgICBjb25zdCBzY29yZURhdGEgPSBzY29yZXMuZ2V0KHJlbGF0ZWRQYXRoKSB8fCB7IFxyXG4gICAgICAgICAgICAgICAgICAgIHJlbGV2YW5jZTogMCwgXHJcbiAgICAgICAgICAgICAgICAgICAgc2hhcmVkQ29uY2VwdHM6IFtdIFxyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgLy8gSW5jcmVtZW50IHJlbGV2YW5jZSBzY29yZSBiYXNlZCBvbiBjb25jZXB0IHdlaWdodFxyXG4gICAgICAgICAgICAgICAgc2NvcmVEYXRhLnJlbGV2YW5jZSArPSBjb25jZXB0Tm9kZS53ZWlnaHQ7XHJcbiAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgIC8vIEFkZCB0byBzaGFyZWQgY29uY2VwdHMgaWYgbm90IGFscmVhZHkgdGhlcmVcclxuICAgICAgICAgICAgICAgIGlmICghc2NvcmVEYXRhLnNoYXJlZENvbmNlcHRzLmluY2x1ZGVzKGNvbmNlcHQpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2NvcmVEYXRhLnNoYXJlZENvbmNlcHRzLnB1c2goY29uY2VwdCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgIHNjb3Jlcy5zZXQocmVsYXRlZFBhdGgsIHNjb3JlRGF0YSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gQ29udmVydCB0byBhcnJheSBhbmQgbm9ybWFsaXplIHNjb3Jlc1xyXG4gICAgICAgIGNvbnN0IHJlbGF0ZWROb3RlczogUmVsYXRlZE5vdGVbXSA9IFtdO1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIEZpbmQgbWF4aW11bSBzY29yZSBmb3Igbm9ybWFsaXphdGlvblxyXG4gICAgICAgIGNvbnN0IG1heFNjb3JlID0gTWF0aC5tYXgoLi4uQXJyYXkuZnJvbShzY29yZXMudmFsdWVzKCkpXHJcbiAgICAgICAgICAgIC5tYXAoZGF0YSA9PiBkYXRhLnJlbGV2YW5jZSksIDEpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIENvbnZlcnQgc2NvcmVzIHRvIFJlbGF0ZWROb3RlIG9iamVjdHNcclxuICAgICAgICBmb3IgKGNvbnN0IFtwYXRoLCBkYXRhXSBvZiBzY29yZXMuZW50cmllcygpKSB7XHJcbiAgICAgICAgICAgIC8vIEdldCB0aGUgZmlsZSBmcm9tIHZhdWx0XHJcbiAgICAgICAgICAgIGNvbnN0IGZpbGUgPSB0aGlzLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChwYXRoKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIFNraXAgaWYgZmlsZSBkb2Vzbid0IGV4aXN0IG9yIGlzbid0IGEgVEZpbGVcclxuICAgICAgICAgICAgaWYgKCFmaWxlIHx8ICEoZmlsZSBpbnN0YW5jZW9mIFRGaWxlKSkgY29udGludWU7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICByZWxhdGVkTm90ZXMucHVzaCh7XHJcbiAgICAgICAgICAgICAgICBmaWxlOiBmaWxlIGFzIFRGaWxlLFxyXG4gICAgICAgICAgICAgICAgcmVsZXZhbmNlOiBkYXRhLnJlbGV2YW5jZSAvIG1heFNjb3JlLCAvLyBOb3JtYWxpemUgdG8gMC0xXHJcbiAgICAgICAgICAgICAgICBzaGFyZWRDb25jZXB0czogZGF0YS5zaGFyZWRDb25jZXB0c1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gU29ydCBieSByZWxldmFuY2UgKGhpZ2hlc3QgZmlyc3QpIGFuZCBsaW1pdCByZXN1bHRzXHJcbiAgICAgICAgcmV0dXJuIHJlbGF0ZWROb3Rlc1xyXG4gICAgICAgICAgICAuc29ydCgoYSwgYikgPT4gYi5yZWxldmFuY2UgLSBhLnJlbGV2YW5jZSlcclxuICAgICAgICAgICAgLnNsaWNlKDAsIG1heFJlc3VsdHMpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogR2V0IGFsbCBjb25jZXB0cyBmb3IgYSBub3RlXHJcbiAgICAgKiBAcGFyYW0gbm90ZVBhdGggUGF0aCB0byB0aGUgbm90ZVxyXG4gICAgICogQHJldHVybnMgQXJyYXkgb2YgY29uY2VwdHNcclxuICAgICAqL1xyXG4gICAgcHVibGljIGdldE5vdGVDb25jZXB0cyhub3RlUGF0aDogc3RyaW5nKTogc3RyaW5nW10ge1xyXG4gICAgICAgIGNvbnN0IG5vdGUgPSB0aGlzLm5vdGVzLmdldChub3RlUGF0aCk7XHJcbiAgICAgICAgcmV0dXJuIG5vdGUgPyBub3RlLmNvbmNlcHRzIDogW107XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBHZXQgZ3JhcGggZGF0YSBmb3IgdmlzdWFsaXphdGlvblxyXG4gICAgICogQHJldHVybnMgT2JqZWN0IHdpdGggbm9kZXMgYW5kIGVkZ2VzIGFycmF5cyBmb3IgdmlzdWFsaXphdGlvblxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgZ2V0Q29uY2VwdE5ldHdvcmsoKTogeyBub2RlczogYW55W10sIGVkZ2VzOiBhbnlbXSB9IHtcclxuICAgICAgICBjb25zdCBub2RlczogYW55W10gPSBbXTtcclxuICAgICAgICBjb25zdCBlZGdlczogYW55W10gPSBbXTtcclxuICAgICAgICBcclxuICAgICAgICAvLyBBZGQgbm90ZSBub2Rlc1xyXG4gICAgICAgIGZvciAoY29uc3QgW3BhdGgsIG5vdGVdIG9mIHRoaXMubm90ZXMuZW50cmllcygpKSB7XHJcbiAgICAgICAgICAgIG5vZGVzLnB1c2goe1xyXG4gICAgICAgICAgICAgICAgaWQ6IHBhdGgsXHJcbiAgICAgICAgICAgICAgICBsYWJlbDogcGF0aC5zcGxpdCgnLycpLnBvcCgpIHx8IHBhdGgsIC8vIFVzZSBmaWxlbmFtZSBhcyBsYWJlbFxyXG4gICAgICAgICAgICAgICAgdHlwZTogJ25vdGUnXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICAvLyBBZGQgY29uY2VwdCBub2RlcyAoZm9yIGNvbmNlcHRzIHRoYXQgYXBwZWFyIGluIG11bHRpcGxlIG5vdGVzKVxyXG4gICAgICAgIGZvciAoY29uc3QgW25hbWUsIGNvbmNlcHRdIG9mIHRoaXMuY29uY2VwdHMuZW50cmllcygpKSB7XHJcbiAgICAgICAgICAgIGlmIChjb25jZXB0Lm5vdGVQYXRocy5sZW5ndGggPiAxKSB7XHJcbiAgICAgICAgICAgICAgICBub2Rlcy5wdXNoKHtcclxuICAgICAgICAgICAgICAgICAgICBpZDogYGNvbmNlcHQtJHtuYW1lfWAsXHJcbiAgICAgICAgICAgICAgICAgICAgbGFiZWw6IG5hbWUsXHJcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogJ2NvbmNlcHQnLFxyXG4gICAgICAgICAgICAgICAgICAgIHdlaWdodDogY29uY2VwdC53ZWlnaHRcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAvLyBBZGQgZWRnZXMgZnJvbSBjb25jZXB0IHRvIG5vdGVzXHJcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IHBhdGggb2YgY29uY2VwdC5ub3RlUGF0aHMpIHtcclxuICAgICAgICAgICAgICAgICAgICBlZGdlcy5wdXNoKHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc291cmNlOiBgY29uY2VwdC0ke25hbWV9YCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0OiBwYXRoLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogMVxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgIHJldHVybiB7IG5vZGVzLCBlZGdlcyB9O1xyXG4gICAgfVxyXG59IiwgImltcG9ydCB7IERhdGFNYW5hZ2VyIH0gZnJvbSAnLi4vdXRpbHMvdHlwZXMnO1xyXG5pbXBvcnQgeyBQbHVnaW4gfSBmcm9tICdvYnNpZGlhbic7XHJcblxyXG4vKipcclxuICogSW50ZXJmYWNlIGZvciBwZXJzaXN0ZW50IGRhdGEgc3RvcmFnZVxyXG4gKi9cclxuaW50ZXJmYWNlIENvbmNlcHREYXRhIHtcclxuICAgIHZlcnNpb246IG51bWJlcjtcclxuICAgIG5vdGVzOiBSZWNvcmQ8c3RyaW5nLCB7XHJcbiAgICAgICAgY29uY2VwdHM6IHN0cmluZ1tdO1xyXG4gICAgICAgIGxhc3RVcGRhdGVkOiBudW1iZXI7XHJcbiAgICB9PjtcclxuICAgIGNvbmNlcHRzOiBSZWNvcmQ8c3RyaW5nLCB7XHJcbiAgICAgICAgbm90ZVBhdGhzOiBzdHJpbmdbXTtcclxuICAgICAgICB3ZWlnaHQ6IG51bWJlcjtcclxuICAgIH0+O1xyXG4gICAgdXNlckZlZWRiYWNrOiBSZWNvcmQ8c3RyaW5nLCBib29sZWFuPjtcclxufVxyXG5cclxuLyoqXHJcbiAqIEltcGxlbWVudGF0aW9uIG9mIGRhdGEgcGVyc2lzdGVuY2UgZm9yIGNvbmNlcHRzIGFuZCByZWxhdGlvbnNoaXBzXHJcbiAqL1xyXG5leHBvcnQgY2xhc3MgRGF0YU1hbmFnZXJJbXBsIGltcGxlbWVudHMgRGF0YU1hbmFnZXIge1xyXG4gICAgcHJpdmF0ZSBwbHVnaW46IFBsdWdpbjtcclxuICAgIHByaXZhdGUgZGF0YTogQ29uY2VwdERhdGE7XHJcbiAgICBcclxuICAgIC8vIEN1cnJlbnQgZGF0YSB2ZXJzaW9uIGZvciBtaWdyYXRpb24gc3VwcG9ydFxyXG4gICAgcHJpdmF0ZSByZWFkb25seSBDVVJSRU5UX1ZFUlNJT04gPSAxO1xyXG4gICAgXHJcbiAgICBjb25zdHJ1Y3RvcihwbHVnaW46IFBsdWdpbikge1xyXG4gICAgICAgIHRoaXMucGx1Z2luID0gcGx1Z2luO1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIEluaXRpYWxpemUgd2l0aCBlbXB0eSBkYXRhXHJcbiAgICAgICAgdGhpcy5kYXRhID0ge1xyXG4gICAgICAgICAgICB2ZXJzaW9uOiB0aGlzLkNVUlJFTlRfVkVSU0lPTixcclxuICAgICAgICAgICAgbm90ZXM6IHt9LFxyXG4gICAgICAgICAgICBjb25jZXB0czoge30sXHJcbiAgICAgICAgICAgIHVzZXJGZWVkYmFjazoge31cclxuICAgICAgICB9O1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogU2F2ZSBjb25jZXB0IGRhdGEgdG8gZGlza1xyXG4gICAgICovXHJcbiAgICBwdWJsaWMgYXN5bmMgc2F2ZUNvbmNlcHREYXRhKCk6IFByb21pc2U8dm9pZD4ge1xyXG4gICAgICAgIC8vIEluIE9ic2lkaWFuIFBsdWdpbiBBUEksIHNhdmVEYXRhIHRha2VzIG9ubHkgb25lIGFyZ3VtZW50OiB0aGUgZGF0YSB0byBzYXZlXHJcbiAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZURhdGEodGhpcy5kYXRhKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIExvYWQgY29uY2VwdCBkYXRhIGZyb20gZGlza1xyXG4gICAgICovXHJcbiAgICBwdWJsaWMgYXN5bmMgbG9hZENvbmNlcHREYXRhKCk6IFByb21pc2U8dm9pZD4ge1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIC8vIGxvYWREYXRhIGRvZXNuJ3QgdGFrZSBhcmd1bWVudHMgaW4gdGhlIE9ic2lkaWFuIFBsdWdpbiBBUElcclxuICAgICAgICAgICAgY29uc3Qgc2F2ZWREYXRhID0gYXdhaXQgdGhpcy5wbHVnaW4ubG9hZERhdGEoKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIElmIG5vIGRhdGEgZXhpc3RzIHlldCwga2VlcCB0aGUgZGVmYXVsdCBlbXB0eSBkYXRhXHJcbiAgICAgICAgICAgIGlmICghc2F2ZWREYXRhKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIENoZWNrIGlmIGRhdGEgbWlncmF0aW9uIGlzIG5lZWRlZFxyXG4gICAgICAgICAgICBpZiAoc2F2ZWREYXRhLnZlcnNpb24gIT09IHRoaXMuQ1VSUkVOVF9WRVJTSU9OKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmRhdGEgPSB0aGlzLm1pZ3JhdGVEYXRhKHNhdmVkRGF0YSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmRhdGEgPSBzYXZlZERhdGE7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gbG9hZCBjb25jZXB0IGRhdGE6JywgZXJyb3IpO1xyXG4gICAgICAgICAgICAvLyBLZWVwIHVzaW5nIHRoZSBkZWZhdWx0IGVtcHR5IGRhdGFcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBDbGVhciBhbGwgc3RvcmVkIGRhdGFcclxuICAgICAqL1xyXG4gICAgcHVibGljIGFzeW5jIGNsZWFyRGF0YSgpOiBQcm9taXNlPHZvaWQ+IHtcclxuICAgICAgICB0aGlzLmRhdGEgPSB7XHJcbiAgICAgICAgICAgIHZlcnNpb246IHRoaXMuQ1VSUkVOVF9WRVJTSU9OLFxyXG4gICAgICAgICAgICBub3Rlczoge30sXHJcbiAgICAgICAgICAgIGNvbmNlcHRzOiB7fSxcclxuICAgICAgICAgICAgdXNlckZlZWRiYWNrOiB7fVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgXHJcbiAgICAgICAgYXdhaXQgdGhpcy5zYXZlQ29uY2VwdERhdGEoKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIEdldCB0aGUgbG9hZGVkIGRhdGFcclxuICAgICAqL1xyXG4gICAgcHVibGljIGdldERhdGEoKTogQ29uY2VwdERhdGEge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmRhdGE7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBTZXQgdGhlIGRhdGEgKHVzZWQgd2hlbiB1cGRhdGluZyBmcm9tIHRoZSBjb25jZXB0IGdyYXBoKVxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgc2V0RGF0YShcclxuICAgICAgICBub3RlczogUmVjb3JkPHN0cmluZywgeyBjb25jZXB0czogc3RyaW5nW10sIGxhc3RVcGRhdGVkOiBudW1iZXIgfT4sXHJcbiAgICAgICAgY29uY2VwdHM6IFJlY29yZDxzdHJpbmcsIHsgbm90ZVBhdGhzOiBzdHJpbmdbXSwgd2VpZ2h0OiBudW1iZXIgfT4sXHJcbiAgICAgICAgdXNlckZlZWRiYWNrOiBSZWNvcmQ8c3RyaW5nLCBib29sZWFuPlxyXG4gICAgKTogdm9pZCB7XHJcbiAgICAgICAgdGhpcy5kYXRhID0ge1xyXG4gICAgICAgICAgICB2ZXJzaW9uOiB0aGlzLkNVUlJFTlRfVkVSU0lPTixcclxuICAgICAgICAgICAgbm90ZXMsXHJcbiAgICAgICAgICAgIGNvbmNlcHRzLFxyXG4gICAgICAgICAgICB1c2VyRmVlZGJhY2tcclxuICAgICAgICB9O1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogTWlncmF0ZSBkYXRhIGZyb20gYW4gb2xkZXIgdmVyc2lvbiB0byB0aGUgY3VycmVudCB2ZXJzaW9uXHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgbWlncmF0ZURhdGEob2xkRGF0YTogYW55KTogQ29uY2VwdERhdGEge1xyXG4gICAgICAgIC8vIFRoaXMgaXMgYSBwbGFjZWhvbGRlciBmb3IgZnV0dXJlIG1pZ3JhdGlvbnNcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICB2ZXJzaW9uOiB0aGlzLkNVUlJFTlRfVkVSU0lPTixcclxuICAgICAgICAgICAgbm90ZXM6IG9sZERhdGEubm90ZXMgfHwge30sXHJcbiAgICAgICAgICAgIGNvbmNlcHRzOiBvbGREYXRhLmNvbmNlcHRzIHx8IHt9LFxyXG4gICAgICAgICAgICB1c2VyRmVlZGJhY2s6IG9sZERhdGEudXNlckZlZWRiYWNrIHx8IHt9XHJcbiAgICAgICAgfTtcclxuICAgIH1cclxufSIsICJpbXBvcnQgeyBURmlsZSwgVmF1bHQsIE5vdGljZSB9IGZyb20gJ29ic2lkaWFuJztcclxuaW1wb3J0IHsgQ29uY2VwdEV4dHJhY3RvciwgQ29uY2VwdEdyYXBoLCBOb3RlUHJvY2Vzc29yU2VydmljZSB9IGZyb20gJy4uL3V0aWxzL3R5cGVzJztcclxuXHJcbi8qKlxyXG4gKiBTZXJ2aWNlIHRvIGhhbmRsZSBub3RlIHByb2Nlc3NpbmcgZm9yIGNvbmNlcHQgZXh0cmFjdGlvbiBhbmQgcmVsYXRpb25zaGlwIHRyYWNraW5nXHJcbiAqL1xyXG5leHBvcnQgY2xhc3MgTm90ZVByb2Nlc3NvciBpbXBsZW1lbnRzIE5vdGVQcm9jZXNzb3JTZXJ2aWNlIHtcclxuICAgIC8vIEtlZXAgdHJhY2sgb2YgcHJvY2Vzc2VkIGZpbGVzIHRvIGF2b2lkIHJlZHVuZGFudCBwcm9jZXNzaW5nXHJcbiAgICBwcml2YXRlIHByb2Nlc3NlZEZpbGVzOiBNYXA8c3RyaW5nLCBudW1iZXI+ID0gbmV3IE1hcCgpOyAvLyBwYXRoIC0+IGxhc3RNb2RpZmllZFxyXG4gICAgXHJcbiAgICBjb25zdHJ1Y3RvcihcclxuICAgICAgICBwcml2YXRlIHZhdWx0OiBWYXVsdCxcclxuICAgICAgICBwcml2YXRlIGNvbmNlcHRFeHRyYWN0b3I6IENvbmNlcHRFeHRyYWN0b3IsXHJcbiAgICAgICAgcHJpdmF0ZSBjb25jZXB0R3JhcGg6IENvbmNlcHRHcmFwaCxcclxuICAgICAgICBwcml2YXRlIHNhdmVDYWxsYmFjazogKCkgPT4gUHJvbWlzZTx2b2lkPlxyXG4gICAgKSB7fVxyXG4gICAgXHJcbiAgICAvKipcclxuICAgICAqIFByb2Nlc3MgYSBzaW5nbGUgbm90ZSBmaWxlXHJcbiAgICAgKiBAcGFyYW0gZmlsZSBOb3RlIGZpbGUgdG8gcHJvY2Vzc1xyXG4gICAgICovXHJcbiAgICBwdWJsaWMgYXN5bmMgcHJvY2Vzc05vdGUoZmlsZTogVEZpbGUpOiBQcm9taXNlPHZvaWQ+IHtcclxuICAgICAgICAvLyBTa2lwIGlmIGZpbGUgd2FzIHJlY2VudGx5IHByb2Nlc3NlZCAob3B0aW1pemF0aW9uKVxyXG4gICAgICAgIGlmICghdGhpcy5zaG91bGRQcm9jZXNzTm90ZShmaWxlKSkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIC8vIFJlYWQgdGhlIGZpbGUgY29udGVudFxyXG4gICAgICAgICAgICBjb25zdCBjb250ZW50ID0gYXdhaXQgdGhpcy52YXVsdC5yZWFkKGZpbGUpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgLy8gRXh0cmFjdCBjb25jZXB0c1xyXG4gICAgICAgICAgICBjb25zdCBjb25jZXB0cyA9IHRoaXMuY29uY2VwdEV4dHJhY3Rvci5leHRyYWN0Q29uY2VwdHMoY29udGVudCk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyBBZGQgdG8gY29uY2VwdCBncmFwaFxyXG4gICAgICAgICAgICB0aGlzLmNvbmNlcHRHcmFwaC5hZGROb3RlKGZpbGUucGF0aCwgY29uY2VwdHMpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgLy8gTWFyayBhcyBwcm9jZXNzZWRcclxuICAgICAgICAgICAgdGhpcy5wcm9jZXNzZWRGaWxlcy5zZXQoZmlsZS5wYXRoLCBmaWxlLnN0YXQubXRpbWUpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgLy8gU2F2ZSBjaGFuZ2VzXHJcbiAgICAgICAgICAgIGF3YWl0IHRoaXMuc2F2ZUNhbGxiYWNrKCk7XHJcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgICAgICAgY29uc29sZS5lcnJvcihgRXJyb3IgcHJvY2Vzc2luZyBmaWxlICR7ZmlsZS5wYXRofTpgLCBlcnJvcik7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvKipcclxuICAgICAqIENoZWNrIGlmIGEgZmlsZSBuZWVkcyBwcm9jZXNzaW5nXHJcbiAgICAgKiBAcGFyYW0gZmlsZSBGaWxlIHRvIGNoZWNrXHJcbiAgICAgKiBAcmV0dXJucyB0cnVlIGlmIGZpbGUgbmVlZHMgcHJvY2Vzc2luZywgZmFsc2Ugb3RoZXJ3aXNlXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBzaG91bGRQcm9jZXNzTm90ZShmaWxlOiBURmlsZSk6IGJvb2xlYW4ge1xyXG4gICAgICAgIC8vIFNraXAgbm9uLW1hcmtkb3duIGZpbGVzXHJcbiAgICAgICAgaWYgKGZpbGUuZXh0ZW5zaW9uICE9PSAnbWQnKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgY29uc3QgbGFzdE1vZGlmaWVkID0gZmlsZS5zdGF0Lm10aW1lO1xyXG4gICAgICAgIGNvbnN0IGxhc3RQcm9jZXNzZWQgPSB0aGlzLnByb2Nlc3NlZEZpbGVzLmdldChmaWxlLnBhdGgpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIFByb2Nlc3MgaWYgbmV2ZXIgcHJvY2Vzc2VkIG9yIG1vZGlmaWVkIHNpbmNlIGxhc3QgcHJvY2Vzc2luZ1xyXG4gICAgICAgIHJldHVybiAhbGFzdFByb2Nlc3NlZCB8fCBsYXN0UHJvY2Vzc2VkIDwgbGFzdE1vZGlmaWVkO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvKipcclxuICAgICAqIFByb2Nlc3MgYWxsIG5vdGVzIGluIHRoZSB2YXVsdFxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgYXN5bmMgcHJvY2Vzc0FsbE5vdGVzKCk6IFByb21pc2U8dm9pZD4ge1xyXG4gICAgICAgIGNvbnN0IGZpbGVzID0gdGhpcy52YXVsdC5nZXRNYXJrZG93bkZpbGVzKCk7XHJcbiAgICAgICAgbGV0IHByb2Nlc3NlZENvdW50ID0gMDtcclxuICAgICAgICBcclxuICAgICAgICAvLyBTaG93IG5vdGljZVxyXG4gICAgICAgIGNvbnN0IG5vdGljZSA9IG5ldyBOb3RpY2UoYFByb2Nlc3NpbmcgJHtmaWxlcy5sZW5ndGh9IG5vdGVzLi4uYCwgMCk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgZm9yIChjb25zdCBmaWxlIG9mIGZpbGVzKSB7XHJcbiAgICAgICAgICAgIGF3YWl0IHRoaXMucHJvY2Vzc05vdGUoZmlsZSk7XHJcbiAgICAgICAgICAgIHByb2Nlc3NlZENvdW50Kys7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyBVcGRhdGUgbm90aWNlIHBlcmlvZGljYWxseVxyXG4gICAgICAgICAgICBpZiAocHJvY2Vzc2VkQ291bnQgJSAxMCA9PT0gMCkge1xyXG4gICAgICAgICAgICAgICAgbm90aWNlLnNldE1lc3NhZ2UoYFByb2Nlc3NlZCAke3Byb2Nlc3NlZENvdW50fS8ke2ZpbGVzLmxlbmd0aH0gbm90ZXMuLi5gKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICAvLyBTYXZlIGRhdGEgd2hlbiBjb21wbGV0ZVxyXG4gICAgICAgIGF3YWl0IHRoaXMuc2F2ZUNhbGxiYWNrKCk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gQ2xvc2Ugbm90aWNlXHJcbiAgICAgICAgbm90aWNlLmhpZGUoKTtcclxuICAgICAgICBcclxuICAgICAgICAvLyBTaG93IGNvbXBsZXRpb24gbm90aWNlXHJcbiAgICAgICAgbmV3IE5vdGljZShgQ29tcGxldGVkIHByb2Nlc3NpbmcgJHtwcm9jZXNzZWRDb3VudH0gbm90ZXMuYCk7XHJcbiAgICB9XHJcbn0iLCAiaW1wb3J0IHsgQXBwLCBURmlsZSwgTm90aWNlIH0gZnJvbSAnb2JzaWRpYW4nO1xyXG5pbXBvcnQgeyBTdW1tYXJ5R2VuZXJhdG9yU2VydmljZSwgUmVsYXRlZE5vdGUsIENvbmNlcHRHcmFwaCB9IGZyb20gJy4uL3V0aWxzL3R5cGVzJztcclxuXHJcbi8qKlxyXG4gKiBTZXJ2aWNlIHRvIGdlbmVyYXRlIHN1bW1hcmllcyBmcm9tIHJlbGF0ZWQgbm90ZXNcclxuICovXHJcbmV4cG9ydCBjbGFzcyBTdW1tYXJ5R2VuZXJhdG9yIGltcGxlbWVudHMgU3VtbWFyeUdlbmVyYXRvclNlcnZpY2Uge1xyXG4gICAgY29uc3RydWN0b3IoXHJcbiAgICAgICAgcHJpdmF0ZSBhcHA6IEFwcCxcclxuICAgICAgICBwcml2YXRlIGNvbmNlcHRHcmFwaDogQ29uY2VwdEdyYXBoLFxyXG4gICAgICAgIHByaXZhdGUgZ2V0UmVsYXRlZE5vdGVzOiAoZmlsZTogVEZpbGUpID0+IFByb21pc2U8UmVsYXRlZE5vdGVbXT5cclxuICAgICkge31cclxuICAgIFxyXG4gICAgLyoqXHJcbiAgICAgKiBHZW5lcmF0ZSBhIHN1bW1hcnkgZnJvbSByZWxhdGVkIG5vdGVzXHJcbiAgICAgKiBAcGFyYW0gZmlsZSBGaWxlIHRvIGdlbmVyYXRlIHN1bW1hcnkgZm9yXHJcbiAgICAgKiBAcmV0dXJucyBUaGUgY29udGVudCBvZiB0aGUgZ2VuZXJhdGVkIHN1bW1hcnlcclxuICAgICAqL1xyXG4gICAgcHVibGljIGFzeW5jIGdlbmVyYXRlU3VtbWFyeShmaWxlOiBURmlsZSk6IFByb21pc2U8c3RyaW5nPiB7XHJcbiAgICAgICAgLy8gR2V0IHJlbGF0ZWQgbm90ZXNcclxuICAgICAgICBjb25zdCByZWxhdGVkTm90ZXMgPSBhd2FpdCB0aGlzLmdldFJlbGF0ZWROb3RlcyhmaWxlKTtcclxuICAgICAgICBcclxuICAgICAgICBpZiAocmVsYXRlZE5vdGVzLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICAgICAgICBuZXcgTm90aWNlKCdObyByZWxhdGVkIG5vdGVzIGZvdW5kIHRvIGdlbmVyYXRlIHN1bW1hcnknKTtcclxuICAgICAgICAgICAgcmV0dXJuICcnO1xyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICAvLyBDcmVhdGUgYSBuZXcgbm90ZSB3aXRoIHN1bW1hcnlcclxuICAgICAgICBjb25zdCBzdW1tYXJ5VGl0bGUgPSBgU3VtbWFyeSBvZiAke2ZpbGUuYmFzZW5hbWV9YDtcclxuICAgICAgICBsZXQgc3VtbWFyeUNvbnRlbnQgPSBgIyAke3N1bW1hcnlUaXRsZX1cXG5cXG5gO1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIEFkZCBtZXRhZGF0YVxyXG4gICAgICAgIHN1bW1hcnlDb250ZW50ICs9IGA+IFshaW5mb10gU3VtbWFyeSBnZW5lcmF0ZWQgZnJvbSAke2ZpbGUuYmFzZW5hbWV9IGFuZCAke3JlbGF0ZWROb3Rlcy5sZW5ndGh9IHJlbGF0ZWQgbm90ZXNcXG5gO1xyXG4gICAgICAgIHN1bW1hcnlDb250ZW50ICs9IGA+IEdlbmVyYXRlZCBvbiAke25ldyBEYXRlKCkudG9Mb2NhbGVTdHJpbmcoKX1cXG5cXG5gO1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIEFkZCBvcmlnaW5hbCBub3RlIHN1bW1hcnlcclxuICAgICAgICBjb25zdCBvcmlnaW5hbENvbnRlbnQgPSBhd2FpdCB0aGlzLmFwcC52YXVsdC5yZWFkKGZpbGUpO1xyXG4gICAgICAgIHN1bW1hcnlDb250ZW50ICs9IGAjIyBPcmlnaW5hbCBOb3RlOiAke2ZpbGUuYmFzZW5hbWV9XFxuXFxuYDtcclxuICAgICAgICBcclxuICAgICAgICAvLyBFeHRyYWN0IHRoZSBmaXJzdCBmZXcgc2VudGVuY2VzIGFzIGEgc3VtbWFyeSAoc2ltcGxpZmllZClcclxuICAgICAgICBjb25zdCBmaXJzdFBhcmFncmFwaCA9IG9yaWdpbmFsQ29udGVudC5zcGxpdCgnXFxuXFxuJylbMF07XHJcbiAgICAgICAgc3VtbWFyeUNvbnRlbnQgKz0gYCR7Zmlyc3RQYXJhZ3JhcGh9XFxuXFxuYDtcclxuICAgICAgICBcclxuICAgICAgICAvLyBBZGQga2V5IGNvbmNlcHRzIHNlY3Rpb25cclxuICAgICAgICBjb25zdCBjb25jZXB0cyA9IHRoaXMuY29uY2VwdEdyYXBoLmdldE5vdGVDb25jZXB0cyhmaWxlLnBhdGgpO1xyXG4gICAgICAgIGlmIChjb25jZXB0cy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgIHN1bW1hcnlDb250ZW50ICs9IGAjIyBLZXkgQ29uY2VwdHNcXG5cXG5gO1xyXG4gICAgICAgICAgICBzdW1tYXJ5Q29udGVudCArPSBjb25jZXB0cy5tYXAoYyA9PiBgLSAke2N9YCkuam9pbignXFxuJyk7XHJcbiAgICAgICAgICAgIHN1bW1hcnlDb250ZW50ICs9IGBcXG5cXG5gO1xyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICAvLyBBZGQgcmVsYXRlZCBub3Rlc1xyXG4gICAgICAgIHN1bW1hcnlDb250ZW50ICs9IGAjIyBSZWxhdGVkIE5vdGVzXFxuXFxuYDtcclxuICAgICAgICBcclxuICAgICAgICBmb3IgKGNvbnN0IHJlbGF0ZWQgb2YgcmVsYXRlZE5vdGVzKSB7XHJcbiAgICAgICAgICAgIHN1bW1hcnlDb250ZW50ICs9IGAjIyMgJHtyZWxhdGVkLmZpbGUuYmFzZW5hbWV9XFxuXFxuYDtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIEFkZCBzaGFyZWQgY29uY2VwdHNcclxuICAgICAgICAgICAgaWYgKHJlbGF0ZWQuc2hhcmVkQ29uY2VwdHMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgc3VtbWFyeUNvbnRlbnQgKz0gYFNoYXJlZCBjb25jZXB0czogJHtyZWxhdGVkLnNoYXJlZENvbmNlcHRzLmpvaW4oJywgJyl9XFxuXFxuYDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgLy8gQWRkIHNuaXBwZXQgZnJvbSByZWxhdGVkIG5vdGVcclxuICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHJlbGF0ZWRDb250ZW50ID0gYXdhaXQgdGhpcy5hcHAudmF1bHQucmVhZChyZWxhdGVkLmZpbGUpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZmlyc3RQYXJhZ3JhcGggPSByZWxhdGVkQ29udGVudC5zcGxpdCgnXFxuXFxuJylbMF07XHJcbiAgICAgICAgICAgICAgICBzdW1tYXJ5Q29udGVudCArPSBgJHtmaXJzdFBhcmFncmFwaH1cXG5cXG5gO1xyXG4gICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICAgICAgICAgICAgc3VtbWFyeUNvbnRlbnQgKz0gYEVycm9yIHJlYWRpbmcgbm90ZSBjb250ZW50LlxcblxcbmA7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIEFkZCBsaW5rIHRvIHRoZSBub3RlXHJcbiAgICAgICAgICAgIHN1bW1hcnlDb250ZW50ICs9IGBbWyR7cmVsYXRlZC5maWxlLnBhdGh9fFZpZXcgZnVsbCBub3RlXV1cXG5cXG5gO1xyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICAvLyBDcmVhdGUgdGhlIG5ldyBub3RlXHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgLy8gVHJ5IHRvIGZpbmQgYW4gZXhpc3Rpbmcgc3VtbWFyeSBub3RlIHRvIHVwZGF0ZVxyXG4gICAgICAgICAgICBjb25zdCBzdW1tYXJ5UGF0aCA9IGAke2ZpbGUucGFyZW50Py5wYXRoIHx8ICcnfS8ke3N1bW1hcnlUaXRsZX0ubWRgO1xyXG4gICAgICAgICAgICBsZXQgc3VtbWFyeUZpbGU6IFRGaWxlIHwgbnVsbCA9IHRoaXMuYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChzdW1tYXJ5UGF0aCkgYXMgVEZpbGU7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBpZiAoc3VtbWFyeUZpbGUpIHtcclxuICAgICAgICAgICAgICAgIC8vIFVwZGF0ZSBleGlzdGluZyBmaWxlXHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLmFwcC52YXVsdC5tb2RpZnkoc3VtbWFyeUZpbGUsIHN1bW1hcnlDb250ZW50KTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIC8vIENyZWF0ZSBuZXcgZmlsZVxyXG4gICAgICAgICAgICAgICAgc3VtbWFyeUZpbGUgPSBhd2FpdCB0aGlzLmFwcC52YXVsdC5jcmVhdGUoc3VtbWFyeVBhdGgsIHN1bW1hcnlDb250ZW50KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgLy8gT3BlbiB0aGUgc3VtbWFyeSBub3RlXHJcbiAgICAgICAgICAgIHRoaXMuYXBwLndvcmtzcGFjZS5nZXRMZWFmKCkub3BlbkZpbGUoc3VtbWFyeUZpbGUpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgcmV0dXJuIHN1bW1hcnlDb250ZW50O1xyXG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNyZWF0aW5nIHN1bW1hcnk6JywgZXJyb3IpO1xyXG4gICAgICAgICAgICBuZXcgTm90aWNlKCdFcnJvciBjcmVhdGluZyBzdW1tYXJ5IG5vdGUnKTtcclxuICAgICAgICAgICAgcmV0dXJuICcnO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufSIsICJpbXBvcnQgeyBJdGVtVmlldywgVEZpbGUsIFdvcmtzcGFjZUxlYWYgfSBmcm9tICdvYnNpZGlhbic7XHJcbmltcG9ydCB7IFJlbGF0ZWROb3RlLCBSZWxhdGVkTm90ZXNWaWV3Q29udHJvbGxlciwgUGx1Z2luQVBJIH0gZnJvbSAnLi4vdXRpbHMvdHlwZXMnO1xyXG5cclxuLy8gVmlldyB0eXBlIGZvciByZWxhdGVkIG5vdGVzXHJcbmV4cG9ydCBjb25zdCBSRUxBVEVEX05PVEVTX1ZJRVdfVFlQRSA9ICdrbm93bGVkZ2Utc3ludGhlc2lzLXJlbGF0ZWQtbm90ZXMnO1xyXG5cclxuLyoqXHJcbiAqIFJlbGF0ZWQgTm90ZXMgVmlldyBpbXBsZW1lbnRhdGlvblxyXG4gKi9cclxuZXhwb3J0IGNsYXNzIFJlbGF0ZWROb3Rlc1ZpZXcgZXh0ZW5kcyBJdGVtVmlldyBpbXBsZW1lbnRzIFJlbGF0ZWROb3Rlc1ZpZXdDb250cm9sbGVyIHtcclxuICAgIHByaXZhdGUgcGx1Z2luQXBpOiBQbHVnaW5BUEk7XHJcbiAgICBwcml2YXRlIHJlbGF0ZWRDb250ZW50RWw6IEhUTUxFbGVtZW50OyAvLyBDaGFuZ2VkIGZyb20gY29udGVudEVsIHRvIGF2b2lkIGNvbmZsaWN0c1xyXG4gICAgcHJpdmF0ZSBjdXJyZW50RmlsZTogVEZpbGUgfCBudWxsID0gbnVsbDtcclxuICAgIFxyXG4gICAgY29uc3RydWN0b3IobGVhZjogV29ya3NwYWNlTGVhZiwgcGx1Z2luQXBpOiBQbHVnaW5BUEkpIHtcclxuICAgICAgICBzdXBlcihsZWFmKTtcclxuICAgICAgICB0aGlzLnBsdWdpbkFwaSA9IHBsdWdpbkFwaTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgZ2V0Vmlld1R5cGUoKTogc3RyaW5nIHtcclxuICAgICAgICByZXR1cm4gUkVMQVRFRF9OT1RFU19WSUVXX1RZUEU7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIGdldERpc3BsYXlUZXh0KCk6IHN0cmluZyB7XHJcbiAgICAgICAgcmV0dXJuIFwiUmVsYXRlZCBOb3Rlc1wiO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICBhc3luYyBvbk9wZW4oKSB7XHJcbiAgICAgICAgY29uc3QgeyBjb250YWluZXJFbCB9ID0gdGhpcztcclxuICAgICAgICBjb250YWluZXJFbC5lbXB0eSgpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIENyZWF0ZSBjb250ZW50IGNvbnRhaW5lclxyXG4gICAgICAgIHRoaXMucmVsYXRlZENvbnRlbnRFbCA9IGNvbnRhaW5lckVsLmNyZWF0ZURpdih7IGNsczogJ2tub3dsZWRnZS1zeW50aGVzaXMtcmVsYXRlZC1ub3RlcycgfSk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gQ3JlYXRlIGhlYWRlclxyXG4gICAgICAgIHRoaXMucmVsYXRlZENvbnRlbnRFbC5jcmVhdGVFbCgnaDMnLCB7IHRleHQ6ICdSZWxhdGVkIE5vdGVzJyB9KTtcclxuICAgICAgICBcclxuICAgICAgICAvLyBTaG93IHBsYWNlaG9sZGVyIHRleHRcclxuICAgICAgICB0aGlzLnJlbGF0ZWRDb250ZW50RWwuY3JlYXRlRWwoJ3AnLCB7IFxyXG4gICAgICAgICAgICB0ZXh0OiAnT3BlbiBhIG5vdGUgdG8gc2VlIHJlbGF0ZWQgY29udGVudC4nLFxyXG4gICAgICAgICAgICBjbHM6ICdrbm93bGVkZ2Utc3ludGhlc2lzLXBsYWNlaG9sZGVyJ1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvKipcclxuICAgICAqIFVwZGF0ZSB0aGUgdmlldyB3aXRoIHJlbGF0ZWQgbm90ZXMgZm9yIGEgZmlsZVxyXG4gICAgICogQHBhcmFtIGZpbGUgQ3VycmVudCBhY3RpdmUgZmlsZVxyXG4gICAgICogQHBhcmFtIHJlbGF0ZWROb3RlcyBBcnJheSBvZiByZWxhdGVkIG5vdGVzXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyB1cGRhdGVSZWxhdGVkTm90ZXMoZmlsZTogVEZpbGUsIHJlbGF0ZWROb3RlczogUmVsYXRlZE5vdGVbXSk6IHZvaWQge1xyXG4gICAgICAgIHRoaXMuY3VycmVudEZpbGUgPSBmaWxlO1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIFVwZGF0ZSBoZWFkZXIgd2l0aCBmaWxlbmFtZVxyXG4gICAgICAgIHRoaXMucmVsYXRlZENvbnRlbnRFbC5lbXB0eSgpO1xyXG4gICAgICAgIHRoaXMucmVsYXRlZENvbnRlbnRFbC5jcmVhdGVFbCgnaDMnLCB7IHRleHQ6ICdSZWxhdGVkIHRvOiAnICsgZmlsZS5iYXNlbmFtZSB9KTtcclxuICAgICAgICBcclxuICAgICAgICAvLyBEaXNwbGF5IGNvbmNlcHRzXHJcbiAgICAgICAgY29uc3QgY29uY2VwdHMgPSB0aGlzLnBsdWdpbkFwaS5leHRyYWN0Q29uY2VwdHMoZmlsZS5wYXRoKTtcclxuICAgICAgICBpZiAoY29uY2VwdHMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICBjb25zdCBjb25jZXB0c0VsID0gdGhpcy5yZWxhdGVkQ29udGVudEVsLmNyZWF0ZURpdih7IGNsczogJ2tub3dsZWRnZS1zeW50aGVzaXMtY29uY2VwdHMnIH0pO1xyXG4gICAgICAgICAgICBjb25jZXB0c0VsLmNyZWF0ZUVsKCdoNCcsIHsgdGV4dDogJ0tleSBDb25jZXB0cycgfSk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBjb25zdCBjb25jZXB0c0xpc3QgPSBjb25jZXB0c0VsLmNyZWF0ZURpdih7IGNsczogJ2tub3dsZWRnZS1zeW50aGVzaXMtY29uY2VwdHMtbGlzdCcgfSk7XHJcbiAgICAgICAgICAgIGZvciAoY29uc3QgY29uY2VwdCBvZiBjb25jZXB0cykge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdGFnRWwgPSBjb25jZXB0c0xpc3QuY3JlYXRlU3Bhbih7IFxyXG4gICAgICAgICAgICAgICAgICAgIGNsczogJ2tub3dsZWRnZS1zeW50aGVzaXMtY29uY2VwdC10YWcnLFxyXG4gICAgICAgICAgICAgICAgICAgIHRleHQ6IGNvbmNlcHRcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIERpc3BsYXkgcmVsYXRlZCBub3Rlc1xyXG4gICAgICAgIGlmIChyZWxhdGVkTm90ZXMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICBjb25zdCByZWxhdGVkRWwgPSB0aGlzLnJlbGF0ZWRDb250ZW50RWwuY3JlYXRlRGl2KHsgY2xzOiAna25vd2xlZGdlLXN5bnRoZXNpcy1yZWxhdGVkJyB9KTtcclxuICAgICAgICAgICAgcmVsYXRlZEVsLmNyZWF0ZUVsKCdoNCcsIHsgdGV4dDogJ1JlbGF0ZWQgTm90ZXMnIH0pO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgY29uc3QgcmVsYXRlZExpc3QgPSByZWxhdGVkRWwuY3JlYXRlRGl2KHsgY2xzOiAna25vd2xlZGdlLXN5bnRoZXNpcy1yZWxhdGVkLWxpc3QnIH0pO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgZm9yIChjb25zdCByZWxhdGVkIG9mIHJlbGF0ZWROb3Rlcykge1xyXG4gICAgICAgICAgICAgICAgY29uc3Qgbm90ZUVsID0gcmVsYXRlZExpc3QuY3JlYXRlRGl2KHsgY2xzOiAna25vd2xlZGdlLXN5bnRoZXNpcy1yZWxhdGVkLW5vdGUnIH0pO1xyXG4gICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAvLyBDcmVhdGUgbGluayB0byB0aGUgbm90ZVxyXG4gICAgICAgICAgICAgICAgY29uc3QgbGlua0VsID0gbm90ZUVsLmNyZWF0ZUVsKCdhJywgeyBcclxuICAgICAgICAgICAgICAgICAgICBjbHM6ICdrbm93bGVkZ2Utc3ludGhlc2lzLW5vdGUtbGluaycsXHJcbiAgICAgICAgICAgICAgICAgICAgdGV4dDogcmVsYXRlZC5maWxlLmJhc2VuYW1lXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgLy8gQWRkIGNsaWNrIGhhbmRsZXIgdG8gb3BlbiB0aGUgbm90ZVxyXG4gICAgICAgICAgICAgICAgbGlua0VsLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgYXN5bmMgKGUpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbGVhZiA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRMZWFmKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGxlYWYpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgbGVhZi5vcGVuRmlsZShyZWxhdGVkLmZpbGUpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAvLyBBZGQgcmVsZXZhbmNlIGluZGljYXRvclxyXG4gICAgICAgICAgICAgICAgY29uc3QgcmVsZXZhbmNlRWwgPSBub3RlRWwuY3JlYXRlRGl2KHsgXHJcbiAgICAgICAgICAgICAgICAgICAgY2xzOiAna25vd2xlZGdlLXN5bnRoZXNpcy1yZWxldmFuY2UtYmFyJyBcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICBjb25zdCBpbmRpY2F0b3JFbCA9IHJlbGV2YW5jZUVsLmNyZWF0ZURpdih7IFxyXG4gICAgICAgICAgICAgICAgICAgIGNsczogJ2tub3dsZWRnZS1zeW50aGVzaXMtcmVsZXZhbmNlLWluZGljYXRvcicgXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgLy8gU2V0IHdpZHRoIGJhc2VkIG9uIHJlbGV2YW5jZSBzY29yZSAoMC0xMDAlKVxyXG4gICAgICAgICAgICAgICAgaW5kaWNhdG9yRWwuc3R5bGUud2lkdGggPSBgJHtNYXRoLnJvdW5kKHJlbGF0ZWQucmVsZXZhbmNlICogMTAwKX0lYDtcclxuICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgLy8gQWRkIHNoYXJlZCBjb25jZXB0c1xyXG4gICAgICAgICAgICAgICAgaWYgKHJlbGF0ZWQuc2hhcmVkQ29uY2VwdHMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHNoYXJlZEVsID0gbm90ZUVsLmNyZWF0ZURpdih7IFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjbHM6ICdrbm93bGVkZ2Utc3ludGhlc2lzLXNoYXJlZC1jb25jZXB0cycgXHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAgICAgc2hhcmVkRWwuY3JlYXRlU3Bhbih7IFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjbHM6ICdrbm93bGVkZ2Utc3ludGhlc2lzLXNoYXJlZC1sYWJlbCcsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRleHQ6ICdTaGFyZWQgY29uY2VwdHM6ICdcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGNvbmNlcHQgb2YgcmVsYXRlZC5zaGFyZWRDb25jZXB0cykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzaGFyZWRFbC5jcmVhdGVTcGFuKHsgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbHM6ICdrbm93bGVkZ2Utc3ludGhlc2lzLWNvbmNlcHQtdGFnIGtub3dsZWRnZS1zeW50aGVzaXMtc2hhcmVkJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHQ6IGNvbmNlcHRcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5yZWxhdGVkQ29udGVudEVsLmNyZWF0ZUVsKCdwJywgeyBcclxuICAgICAgICAgICAgICAgIHRleHQ6ICdObyByZWxhdGVkIG5vdGVzIGZvdW5kLiBUcnkgYWRkaW5nIG1vcmUgY29udGVudCBvciBjb25jZXB0cy4nLFxyXG4gICAgICAgICAgICAgICAgY2xzOiAna25vd2xlZGdlLXN5bnRoZXNpcy1uby1yZXN1bHRzJ1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gQWRkIGJ1dHRvbiB0byBnZW5lcmF0ZSBzdW1tYXJ5XHJcbiAgICAgICAgY29uc3QgYWN0aW9uc0VsID0gdGhpcy5yZWxhdGVkQ29udGVudEVsLmNyZWF0ZURpdih7IGNsczogJ2tub3dsZWRnZS1zeW50aGVzaXMtYWN0aW9ucycgfSk7XHJcbiAgICAgICAgY29uc3Qgc3VtbWFyeUJ0biA9IGFjdGlvbnNFbC5jcmVhdGVFbCgnYnV0dG9uJywgeyBcclxuICAgICAgICAgICAgY2xzOiAna25vd2xlZGdlLXN5bnRoZXNpcy1zdW1tYXJ5LWJ0bicsXHJcbiAgICAgICAgICAgIHRleHQ6ICdHZW5lcmF0ZSBTdW1tYXJ5J1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIFxyXG4gICAgICAgIHN1bW1hcnlCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmN1cnJlbnRGaWxlKSB7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbkFwaS5nZW5lcmF0ZVN1bW1hcnkodGhpcy5jdXJyZW50RmlsZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgLyoqXHJcbiAgICAgKiBDbGVhciB0aGUgdmlld1xyXG4gICAgICovXHJcbiAgICBwdWJsaWMgY2xlYXIoKTogdm9pZCB7XHJcbiAgICAgICAgdGhpcy5yZWxhdGVkQ29udGVudEVsLmVtcHR5KCk7XHJcbiAgICAgICAgdGhpcy5jdXJyZW50RmlsZSA9IG51bGw7XHJcbiAgICAgICAgXHJcbiAgICAgICAgdGhpcy5yZWxhdGVkQ29udGVudEVsLmNyZWF0ZUVsKCdoMycsIHsgdGV4dDogJ1JlbGF0ZWQgTm90ZXMnIH0pO1xyXG4gICAgICAgIHRoaXMucmVsYXRlZENvbnRlbnRFbC5jcmVhdGVFbCgncCcsIHsgXHJcbiAgICAgICAgICAgIHRleHQ6ICdPcGVuIGEgbm90ZSB0byBzZWUgcmVsYXRlZCBjb250ZW50LicsXHJcbiAgICAgICAgICAgIGNsczogJ2tub3dsZWRnZS1zeW50aGVzaXMtcGxhY2Vob2xkZXInXHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbn0iLCAiLy8gc3JjL3VpL3NldHRpbmdzLXRhYi50c1xyXG5pbXBvcnQgeyBBcHAsIE5vdGljZSwgUGx1Z2luLCBQbHVnaW5TZXR0aW5nVGFiLCBTZXR0aW5nIH0gZnJvbSAnb2JzaWRpYW4nO1xyXG5pbXBvcnQgeyBLbm93bGVkZ2VTeW50aGVzaXNTZXR0aW5ncyB9IGZyb20gJy4uL3V0aWxzL3R5cGVzJztcclxuaW1wb3J0IEtub3dsZWRnZVN5bnRoZXNpc1BsdWdpbiBmcm9tICcuLi8uLi9tYWluJzsgXHJcblxyXG4vKipcclxuICogU2V0dGluZ3MgdGFiIGltcGxlbWVudGF0aW9uXHJcbiAqL1xyXG5leHBvcnQgY2xhc3MgS25vd2xlZGdlU3ludGhlc2lzU2V0dGluZ1RhYiBleHRlbmRzIFBsdWdpblNldHRpbmdUYWIge1xyXG4gICAgcHJpdmF0ZSBwbHVnaW46IEtub3dsZWRnZVN5bnRoZXNpc1BsdWdpbjsgLy8gVXNlIHRoZSBzcGVjaWZpYyBwbHVnaW4gY2xhc3MgdHlwZVxyXG5cclxuICAgIGNvbnN0cnVjdG9yKGFwcDogQXBwLCBwbHVnaW46IEtub3dsZWRnZVN5bnRoZXNpc1BsdWdpbikge1xyXG4gICAgICAgIHN1cGVyKGFwcCwgcGx1Z2luKTtcclxuICAgICAgICB0aGlzLnBsdWdpbiA9IHBsdWdpbjtcclxuICAgIH1cclxuXHJcbiAgICBkaXNwbGF5KCk6IHZvaWQge1xyXG4gICAgICAgIGNvbnN0IHsgY29udGFpbmVyRWwgfSA9IHRoaXM7XHJcbiAgICAgICAgY29udGFpbmVyRWwuZW1wdHkoKTtcclxuXHJcbiAgICAgICAgY29udGFpbmVyRWwuY3JlYXRlRWwoJ2gyJywgeyB0ZXh0OiAnS25vd2xlZGdlIFN5bnRoZXNpcyBTZXR0aW5ncycgfSk7XHJcblxyXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxyXG4gICAgICAgICAgICAuc2V0TmFtZSgnQ29uY2VwdCBFeHRyYWN0aW9uIFNlbnNpdGl2aXR5JylcclxuICAgICAgICAgICAgLnNldERlc2MoJ0hpZ2hlciB2YWx1ZXMgZXh0cmFjdCBtb3JlIGNvbmNlcHRzICgxLTEwKScpXHJcbiAgICAgICAgICAgIC5hZGRTbGlkZXIoc2xpZGVyID0+IHNsaWRlclxyXG4gICAgICAgICAgICAgICAgLnNldExpbWl0cygxLCAxMCwgMSlcclxuICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5leHRyYWN0aW9uU2Vuc2l0aXZpdHkpXHJcbiAgICAgICAgICAgICAgICAuc2V0RHluYW1pY1Rvb2x0aXAoKVxyXG4gICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmV4dHJhY3Rpb25TZW5zaXRpdml0eSA9IHZhbHVlO1xyXG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG4gICAgICAgICAgICAgICAgfSkpO1xyXG5cclxuICAgICAgICAvLyBPdGhlciBzZXR0aW5ncy4uLlxyXG5cclxuICAgICAgICAvLyBBZGQgYSBidXR0b24gdG8gcmVwcm9jZXNzIGFsbCBub3Rlc1xyXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxyXG4gICAgICAgICAgICAuc2V0TmFtZSgnUmVwcm9jZXNzIEFsbCBOb3RlcycpXHJcbiAgICAgICAgICAgIC5zZXREZXNjKCdVcGRhdGUgdGhlIGNvbmNlcHQgZ3JhcGggd2l0aCBhbGwgbm90ZXMgaW4gdGhlIHZhdWx0JylcclxuICAgICAgICAgICAgLmFkZEJ1dHRvbihidXR0b24gPT4gYnV0dG9uXHJcbiAgICAgICAgICAgICAgICAuc2V0QnV0dG9uVGV4dCgnUmVwcm9jZXNzJylcclxuICAgICAgICAgICAgICAgIC5vbkNsaWNrKGFzeW5jICgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5wcm9jZXNzQWxsTm90ZXMoKTtcclxuICAgICAgICAgICAgICAgIH0pKTtcclxuICAgICAgICAgICAgICAgIFxyXG4gICAgICAgIC8vIEFkZCBhIGJ1dHRvbiB0byBjbGVhciBhbGwgZGF0YVxyXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxyXG4gICAgICAgICAgICAuc2V0TmFtZSgnQ2xlYXIgQWxsIERhdGEnKVxyXG4gICAgICAgICAgICAuc2V0RGVzYygnUmVzZXQgYWxsIGNvbmNlcHQgYW5kIHJlbGF0aW9uc2hpcCBkYXRhJylcclxuICAgICAgICAgICAgLmFkZEJ1dHRvbihidXR0b24gPT4gYnV0dG9uXHJcbiAgICAgICAgICAgICAgICAuc2V0QnV0dG9uVGV4dCgnQ2xlYXIgRGF0YScpXHJcbiAgICAgICAgICAgICAgICAuc2V0V2FybmluZygpXHJcbiAgICAgICAgICAgICAgICAub25DbGljayhhc3luYyAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgY29uZmlybWVkID0gY29uZmlybSgnQXJlIHlvdSBzdXJlIHlvdSB3YW50IHRvIGNsZWFyIGFsbCBLbm93bGVkZ2UgU3ludGhlc2lzIGRhdGE/IFRoaXMgY2Fubm90IGJlIHVuZG9uZS4nKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoY29uZmlybWVkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLmRhdGFNYW5hZ2VyLmNsZWFyRGF0YSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBuZXcgTm90aWNlKCdLbm93bGVkZ2UgU3ludGhlc2lzIGRhdGEgY2xlYXJlZCcpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pKTtcclxuICAgIH1cclxufSJdLAogICJtYXBwaW5ncyI6ICI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSxJQUFBQSxtQkFPTzs7O0FDSEEsSUFBTSxzQkFBTixNQUFtRDtBQUFBLEVBQW5EO0FBRUg7QUFBQSxTQUFRLFlBQXlCLG9CQUFJLElBQUk7QUFBQSxNQUNyQztBQUFBLE1BQUs7QUFBQSxNQUFNO0FBQUEsTUFBTztBQUFBLE1BQU87QUFBQSxNQUFNO0FBQUEsTUFBTztBQUFBLE1BQU07QUFBQSxNQUFPO0FBQUEsTUFBTztBQUFBLE1BQzFEO0FBQUEsTUFBTTtBQUFBLE1BQVE7QUFBQSxNQUFTO0FBQUEsTUFBUTtBQUFBLE1BQU87QUFBQSxNQUFPO0FBQUEsTUFBTTtBQUFBLE1BQVE7QUFBQSxNQUMzRDtBQUFBLE1BQU07QUFBQSxNQUFNO0FBQUEsTUFBUTtBQUFBLE1BQU07QUFBQSxNQUFR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SSxVQUFVLGdCQUFnQix1QkFBdUI7QUFFekUsUUFBSSxPQUFPLFNBQVMsR0FBRztBQUNuQixZQUFNLE9BQU8sT0FBTyxDQUFDLEVBQUU7QUFDdkIsWUFBTSxlQUFlLEtBQUssYUFBYTtBQUFBLFFBQ25DLEtBQUs7QUFBQSxRQUNMLEtBQUssU0FBUztBQUFBLE1BQ2xCO0FBRUEsV0FBSyxtQkFBbUIsTUFBTSxZQUFZO0FBQUEsSUFDOUM7QUFBQSxFQUNKO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQU1BLE1BQWEsa0JBQWlDO0FBQzFDLFVBQU0sS0FBSyxjQUFjLGdCQUFnQjtBQUFBLEVBQzdDO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQU1BLE1BQWEsWUFBMkI7QUFDcEMsVUFBTSxLQUFLLFlBQVksVUFBVTtBQUFBLEVBQ3JDO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBT0EsTUFBYSxnQkFBZ0IsTUFBcUM7QUFDOUQsV0FBTyxLQUFLLGFBQWE7QUFBQSxNQUNyQixLQUFLO0FBQUEsTUFDTCxLQUFLLFNBQVM7QUFBQSxJQUNsQjtBQUFBLEVBQ0o7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFPTyxnQkFBZ0IsU0FBMkI7QUFDOUMsV0FBTyxLQUFLLGlCQUFpQixnQkFBZ0IsT0FBTztBQUFBLEVBQ3hEO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBT0EsTUFBYSxpQkFBaUIsVUFBa0IsU0FBZ0M7QUFFNUUsVUFBTSxXQUFXLEtBQUssYUFBYSxnQkFBZ0IsUUFBUTtBQUczRCxRQUFJLENBQUMsU0FBUyxTQUFTLE9BQU8sR0FBRztBQUM3QixlQUFTLEtBQUssT0FBTztBQUdyQixXQUFLLGFBQWEsUUFBUSxVQUFVLFFBQVE7QUFHNUMsWUFBTSxLQUFLLFlBQVksZ0JBQWdCO0FBR3ZDLFVBQUksd0JBQU8sa0JBQWtCLGtCQUFrQjtBQUFBLElBQ25EO0FBQUEsRUFDSjtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFNTyxnQkFBZ0IsTUFBOEI7QUFDakQsV0FBTyxLQUFLLGlCQUFpQixnQkFBZ0IsSUFBSTtBQUFBLEVBQ3JEO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQU1PLGNBQTBDO0FBQzdDLFdBQU8sS0FBSztBQUFBLEVBQ2hCO0FBQ0o7IiwKICAibmFtZXMiOiBbImltcG9ydF9vYnNpZGlhbiIsICJpbXBvcnRfb2JzaWRpYW4iLCAiaW1wb3J0X29ic2lkaWFuIiwgImZpcnN0UGFyYWdyYXBoIiwgImltcG9ydF9vYnNpZGlhbiIsICJpbXBvcnRfb2JzaWRpYW4iXQp9Cg==
