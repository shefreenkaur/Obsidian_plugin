/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// main.ts
var main_exports = {};
__export(main_exports, {
  default: () => KnowledgeSynthesisPlugin
});
module.exports = __toCommonJS(main_exports);
var import_obsidian6 = require("obsidian");

// src/utils/text-processing.ts
var TextProcessingUtils = class {
  constructor() {
    //Common English stop words to filter out
    this.stopWords = /* @__PURE__ */ new Set([
      "a",
      "an",
      "the",
      "and",
      "or",
      "but",
      "is",
      "are",
      "was",
      "were",
      "be",
      "been",
      "being",
      "have",
      "has",
      "had",
      "do",
      "does",
      "did",
      "to",
      "from",
      "in",
      "out",
      "on",
      "off",
      "over",
      "under",
      "again",
      "further",
      "then",
      "once",
      "here",
      "there",
      "when",
      "where",
      "why",
      "how",
      "all",
      "any",
      "both",
      "each",
      "few",
      "more",
      "most",
      "other",
      "some",
      "such",
      "no",
      "nor",
      "not",
      "only",
      "own",
      "same",
      "so",
      "than",
      "too",
      "very",
      "can",
      "will",
      "just",
      "should",
      "now"
    ]);
  }
  /**
   * Tokenize text into words
   * @param text Input text to tokenize
   * @returns Array of tokens
   */
  tokenize(text) {
    const normalized = text.toLowerCase().replace(/[^\w\s]/g, " ").replace(/\s+/g, " ").trim();
    return normalized.split(" ");
  }
  /**
   * Calculate term frequency for tokens
   * @param tokens Array of tokens
   * @returns Map of terms to their frequency
   */
  calculateTermFrequency(tokens) {
    const termFrequency = /* @__PURE__ */ new Map();
    for (const token of tokens) {
      const count = termFrequency.get(token) || 0;
      termFrequency.set(token, count + 1);
    }
    return termFrequency;
  }
  /**
   * Remove common stop words from tokens
   * @param tokens Array of tokens
   * @returns Filtered array with stop words removed
   */
  removeStopWords(tokens) {
    return tokens.filter((token) => !this.stopWords.has(token) && token.length > 1);
  }
  /**
   * Basic stemming algorithm for English
   * Implements a simple version of Porter stemming
   * @param tokens Array of tokens
   * @returns Array of stemmed tokens
   */
  stemWords(tokens) {
    return tokens.map((token) => {
      if (token.endsWith("ing")) {
        return token.slice(0, -3);
      } else if (token.endsWith("ly")) {
        return token.slice(0, -2);
      } else if (token.endsWith("s") && !token.endsWith("ss")) {
        return token.slice(0, -1);
      } else if (token.endsWith("ed") && token.length > 4) {
        return token.slice(0, -2);
      } else {
        return token;
      }
    });
  }
  /**
   * Extract potential named entities from text
   * Very simplified implementation for proof of concept
   * @param text Input text
   * @returns Array of potential named entities
   */
  extractNamedEntities(text) {
    const sentences = text.split(/[.!?]+/);
    const entities = [];
    for (const sentence of sentences) {
      const words = sentence.trim().split(" ");
      for (let i = 0; i < words.length; i++) {
        const word = words[i];
        if (i > 0 && word.length > 1 && /^[A-Z][a-z]+$/.test(word)) {
          entities.push(word);
        }
        if (i < words.length - 1 && word.length > 1 && /^[A-Z][a-z]+$/.test(word) && /^[A-Z][a-z]+$/.test(words[i + 1])) {
          entities.push(`${word} ${words[i + 1]}`);
        }
      }
    }
    return [...new Set(entities)];
  }
};

// src/core/concept-extractor.ts
var ConceptExtractorImpl = class {
  //Store user feedback on concepts
  constructor() {
    this.sensitivity = 5;
    this.userFeedback = /* @__PURE__ */ new Map();
    this.textProcessor = new TextProcessingUtils();
  }
  /**
   * Extract concepts from text content
   * @param content Text content to analyze
   * @returns Array of extracted concepts
   */
  extractConcepts(content) {
    if (!content || content.trim() === "") {
      return [];
    }
    const concepts = [
      ...this.extractFromTfIdf(content),
      ...this.extractFromHeadings(content),
      ...this.extractFromEmphasis(content),
      ...this.extractFromNamedEntities(content)
    ];
    const filteredConcepts = concepts.filter((concept) => {
      const feedback = this.userFeedback.get(concept);
      if (feedback === false) {
        return false;
      }
      return true;
    });
    return [...new Set(filteredConcepts)];
  }
  /**
   * Set sensitivity for extraction (1-10)
   * @param sensitivity Sensitivity level (1-10)
   */
  setSensitivity(sensitivity) {
    this.sensitivity = Math.max(1, Math.min(10, sensitivity));
  }
  /**
   * Learn from user feedback on concept relevance
   * @param concept The concept receiving feedback
   * @param isRelevant Whether the user marked it as relevant
   */
  learnFromUserFeedback(concept, isRelevant) {
    this.userFeedback.set(concept, isRelevant);
  }
  /**
   * Extract concepts using TF-IDF like approach
   * @param content Text content to analyze
   * @returns Array of concepts
   */
  extractFromTfIdf(content) {
    const tokens = this.textProcessor.tokenize(content);
    const filteredTokens = this.textProcessor.removeStopWords(tokens);
    const termFrequency = this.textProcessor.calculateTermFrequency(filteredTokens);
    const threshold = Math.max(2, Math.floor(20 / (11 - this.sensitivity)));
    const sortedTerms = Array.from(termFrequency.entries()).filter(([_, freq]) => freq >= threshold).sort((a, b) => b[1] - a[1]).slice(0, this.sensitivity * 3).map(([term, _]) => term);
    return sortedTerms;
  }
  /**
   * Extract concepts from markdown headings
   * @param content Markdown content
   * @returns Array of concepts from headings
   */
  extractFromHeadings(content) {
    const headingRegex = /^#+\s+(.+)$/gm;
    const headings = [];
    let match;
    while ((match = headingRegex.exec(content)) !== null) {
      headings.push(match[1].trim());
    }
    return headings;
  }
  /**
   * Extract concepts from emphasized text (bold/italic)
   * @param content Markdown content
   * @returns Array of concepts from emphasized text
   */
  extractFromEmphasis(content) {
    const emphasisRegex = /(\*\*|__)(.*?)\1|(\*|_)(.*?)\3/g;
    const emphasized = [];
    let match;
    while ((match = emphasisRegex.exec(content)) !== null) {
      const text = match[2] || match[4];
      if (text && text.trim().length > 0) {
        emphasized.push(text.trim());
      }
    }
    return emphasized;
  }
  /**
   * Extract named entities as concepts
   * @param content Text content
   * @returns Array of named entities
   */
  extractFromNamedEntities(content) {
    return this.textProcessor.extractNamedEntities(content);
  }
};

// src/core/concept-graph.ts
var import_obsidian = require("obsidian");
var ConceptGraphImpl = class {
  constructor(vault) {
    this.notes = /* @__PURE__ */ new Map();
    this.concepts = /* @__PURE__ */ new Map();
    this.vault = vault;
  }
  /**
   * Add a note to the graph with its concepts
   * @param path Path to the note
   * @param concepts Array of concepts in the note
   */
  addNote(path, concepts) {
    this.notes.set(path, {
      path,
      concepts,
      lastUpdated: Date.now()
    });
    for (const concept of concepts) {
      const conceptNode = this.concepts.get(concept) || {
        name: concept,
        notePaths: [],
        weight: 1
      };
      if (!conceptNode.notePaths.includes(path)) {
        conceptNode.notePaths.push(path);
      }
      conceptNode.weight = conceptNode.notePaths.length;
      this.concepts.set(concept, conceptNode);
    }
  }
  /**
   * Remove a note from the graph
   * @param path Path to the note to remove
   */
  removeNote(path) {
    const note = this.notes.get(path);
    if (!note) {
      return;
    }
    for (const concept of note.concepts) {
      const conceptNode = this.concepts.get(concept);
      if (conceptNode) {
        conceptNode.notePaths = conceptNode.notePaths.filter((p) => p !== path);
        conceptNode.weight = conceptNode.notePaths.length;
        if (conceptNode.notePaths.length === 0) {
          this.concepts.delete(concept);
        } else {
          this.concepts.set(concept, conceptNode);
        }
      }
    }
    this.notes.delete(path);
  }
  /**
   * Find notes related to a given note
   * @param notePath Path to the note
   * @param maxResults Maximum number of results to return
   * @returns Array of related notes sorted by relevance
   */
  findRelatedNotes(notePath, maxResults = 10) {
    const note = this.notes.get(notePath);
    if (!note) {
      return [];
    }
    const scores = /* @__PURE__ */ new Map();
    for (const concept of note.concepts) {
      const conceptNode = this.concepts.get(concept);
      if (!conceptNode)
        continue;
      for (const relatedPath of conceptNode.notePaths) {
        if (relatedPath === notePath)
          continue;
        const scoreData = scores.get(relatedPath) || {
          relevance: 0,
          sharedConcepts: []
        };
        scoreData.relevance += conceptNode.weight;
        if (!scoreData.sharedConcepts.includes(concept)) {
          scoreData.sharedConcepts.push(concept);
        }
        scores.set(relatedPath, scoreData);
      }
    }
    const relatedNotes = [];
    const maxScore = Math.max(...Array.from(scores.values()).map((data) => data.relevance), 1);
    for (const [path, data] of scores.entries()) {
      const file = this.vault.getAbstractFileByPath(path);
      if (!file || !(file instanceof import_obsidian.TFile))
        continue;
      relatedNotes.push({
        file,
        relevance: data.relevance / maxScore,
        // Normalize to 0-1
        sharedConcepts: data.sharedConcepts
      });
    }
    return relatedNotes.sort((a, b) => b.relevance - a.relevance).slice(0, maxResults);
  }
  /**
   * Get all concepts for a note
   * @param notePath Path to the note
   * @returns Array of concepts
   */
  getNoteConcepts(notePath) {
    const note = this.notes.get(notePath);
    return note ? note.concepts : [];
  }
  /**
   * Get graph data for visualization
   * @returns Object with nodes and edges arrays for visualization
   */
  getConceptNetwork() {
    const nodes = [];
    const edges = [];
    for (const [path, note] of this.notes.entries()) {
      nodes.push({
        id: path,
        label: path.split("/").pop() || path,
        // Use filename as label
        type: "note"
      });
    }
    for (const [name, concept] of this.concepts.entries()) {
      if (concept.notePaths.length > 1) {
        nodes.push({
          id: `concept-${name}`,
          label: name,
          type: "concept",
          weight: concept.weight
        });
        for (const path of concept.notePaths) {
          edges.push({
            source: `concept-${name}`,
            target: path,
            value: 1
          });
        }
      }
    }
    return { nodes, edges };
  }
};

// src/core/data-manager.ts
var DataManagerImpl = class {
  constructor(plugin) {
    // Current data version for migration support
    this.CURRENT_VERSION = 1;
    this.plugin = plugin;
    this.data = {
      version: this.CURRENT_VERSION,
      notes: {},
      concepts: {},
      userFeedback: {}
    };
  }
  /**
   * Save concept data to disk
   */
  async saveConceptData() {
    await this.plugin.saveData(this.data);
  }
  /**
   * Load concept data from disk
   */
  async loadConceptData() {
    try {
      const savedData = await this.plugin.loadData();
      if (!savedData) {
        return;
      }
      if (savedData.version !== this.CURRENT_VERSION) {
        this.data = this.migrateData(savedData);
      } else {
        this.data = savedData;
      }
    } catch (error) {
      console.error("Failed to load concept data:", error);
    }
  }
  /**
   * Clear all stored data
   */
  async clearData() {
    this.data = {
      version: this.CURRENT_VERSION,
      notes: {},
      concepts: {},
      userFeedback: {}
    };
    await this.saveConceptData();
  }
  /**
   * Get the loaded data
   */
  getData() {
    return this.data;
  }
  /**
   * Set the data (used when updating from the concept graph)
   */
  setData(notes, concepts, userFeedback) {
    this.data = {
      version: this.CURRENT_VERSION,
      notes,
      concepts,
      userFeedback
    };
  }
  /**
   * Migrate data from an older version to the current version
   */
  migrateData(oldData) {
    return {
      version: this.CURRENT_VERSION,
      notes: oldData.notes || {},
      concepts: oldData.concepts || {},
      userFeedback: oldData.userFeedback || {}
    };
  }
};

// src/services/note-processor.ts
var import_obsidian2 = require("obsidian");
var NoteProcessor = class {
  // path -> lastModified
  constructor(vault, conceptExtractor, conceptGraph, saveCallback) {
    this.vault = vault;
    this.conceptExtractor = conceptExtractor;
    this.conceptGraph = conceptGraph;
    this.saveCallback = saveCallback;
    // Keep track of processed files to avoid redundant processing
    this.processedFiles = /* @__PURE__ */ new Map();
  }
  /**
   * Process a single note file
   * @param file Note file to process
   */
  async processNote(file) {
    if (!this.shouldProcessNote(file)) {
      return;
    }
    try {
      const content = await this.vault.read(file);
      const concepts = this.conceptExtractor.extractConcepts(content);
      this.conceptGraph.addNote(file.path, concepts);
      this.processedFiles.set(file.path, file.stat.mtime);
      await this.saveCallback();
    } catch (error) {
      console.error(`Error processing file ${file.path}:`, error);
    }
  }
  /**
   * Check if a file needs processing
   * @param file File to check
   * @returns true if file needs processing, false otherwise
   */
  shouldProcessNote(file) {
    if (file.extension !== "md") {
      return false;
    }
    const lastModified = file.stat.mtime;
    const lastProcessed = this.processedFiles.get(file.path);
    return !lastProcessed || lastProcessed < lastModified;
  }
  /**
   * Process all notes in the vault
   */
  async processAllNotes() {
    const files = this.vault.getMarkdownFiles();
    let processedCount = 0;
    const notice = new import_obsidian2.Notice(`Processing ${files.length} notes...`, 0);
    for (const file of files) {
      await this.processNote(file);
      processedCount++;
      if (processedCount % 10 === 0) {
        notice.setMessage(`Processed ${processedCount}/${files.length} notes...`);
      }
    }
    await this.saveCallback();
    notice.hide();
    new import_obsidian2.Notice(`Completed processing ${processedCount} notes.`);
  }
};

// src/services/summary-generator.ts
var import_obsidian3 = require("obsidian");
var SummaryGenerator = class {
  constructor(app, conceptGraph, getRelatedNotes) {
    this.app = app;
    this.conceptGraph = conceptGraph;
    this.getRelatedNotes = getRelatedNotes;
  }
  /**
   * Generate a summary from related notes
   * @param file File to generate summary for
   * @returns The content of the generated summary
   */
  async generateSummary(file) {
    var _a;
    const relatedNotes = await this.getRelatedNotes(file);
    if (relatedNotes.length === 0) {
      new import_obsidian3.Notice("No related notes found to generate summary");
      return "";
    }
    const summaryTitle = `Summary of ${file.basename}`;
    let summaryContent = `# ${summaryTitle}

`;
    summaryContent += `> [!info] Summary generated from ${file.basename} and ${relatedNotes.length} related notes
`;
    summaryContent += `> Generated on ${new Date().toLocaleString()}

`;
    const originalContent = await this.app.vault.read(file);
    summaryContent += `## Original Note: ${file.basename}

`;
    const firstParagraph = originalContent.split("\n\n")[0];
    summaryContent += `${firstParagraph}

`;
    const concepts = this.conceptGraph.getNoteConcepts(file.path);
    if (concepts.length > 0) {
      summaryContent += `## Key Concepts

`;
      summaryContent += concepts.map((c) => `- ${c}`).join("\n");
      summaryContent += `

`;
    }
    summaryContent += `## Related Notes

`;
    for (const related of relatedNotes) {
      summaryContent += `### ${related.file.basename}

`;
      if (related.sharedConcepts.length > 0) {
        summaryContent += `Shared concepts: ${related.sharedConcepts.join(", ")}

`;
      }
      try {
        const relatedContent = await this.app.vault.read(related.file);
        const firstParagraph2 = relatedContent.split("\n\n")[0];
        summaryContent += `${firstParagraph2}

`;
      } catch (error) {
        summaryContent += `Error reading note content.

`;
      }
      summaryContent += `[[${related.file.path}|View full note]]

`;
    }
    try {
      const summaryPath = `${((_a = file.parent) == null ? void 0 : _a.path) || ""}/${summaryTitle}.md`;
      let summaryFile = this.app.vault.getAbstractFileByPath(summaryPath);
      if (summaryFile) {
        await this.app.vault.modify(summaryFile, summaryContent);
      } else {
        summaryFile = await this.app.vault.create(summaryPath, summaryContent);
      }
      this.app.workspace.getLeaf().openFile(summaryFile);
      return summaryContent;
    } catch (error) {
      console.error("Error creating summary:", error);
      new import_obsidian3.Notice("Error creating summary note");
      return "";
    }
  }
};

// src/ui/related-notes-view.ts
var import_obsidian4 = require("obsidian");
var RELATED_NOTES_VIEW_TYPE = "knowledge-synthesis-related-notes";
var RelatedNotesView = class extends import_obsidian4.ItemView {
  constructor(leaf, pluginApi) {
    super(leaf);
    // Changed from contentEl to avoid conflicts
    this.currentFile = null;
    this.pluginApi = pluginApi;
  }
  getViewType() {
    return RELATED_NOTES_VIEW_TYPE;
  }
  getDisplayText() {
    return "Related Notes";
  }
  async onOpen() {
    const { containerEl } = this;
    containerEl.empty();
    this.relatedContentEl = containerEl.createDiv({ cls: "knowledge-synthesis-related-notes" });
    this.relatedContentEl.createEl("h3", { text: "Related Notes" });
    this.relatedContentEl.createEl("p", {
      text: "Open a note to see related content.",
      cls: "knowledge-synthesis-placeholder"
    });
  }
  /**
   * Update the view with related notes for a file
   * @param file Current active file
   * @param relatedNotes Array of related notes
   */
  updateRelatedNotes(file, relatedNotes) {
    this.currentFile = file;
    this.relatedContentEl.empty();
    this.relatedContentEl.createEl("h3", { text: "Related to: " + file.basename });
    const concepts = this.pluginApi.extractConcepts(file.path);
    if (concepts.length > 0) {
      const conceptsEl = this.relatedContentEl.createDiv({ cls: "knowledge-synthesis-concepts" });
      conceptsEl.createEl("h4", { text: "Key Concepts" });
      const conceptsList = conceptsEl.createDiv({ cls: "knowledge-synthesis-concepts-list" });
      for (const concept of concepts) {
        const tagEl = conceptsList.createSpan({
          cls: "knowledge-synthesis-concept-tag",
          text: concept
        });
      }
    }
    if (relatedNotes.length > 0) {
      const relatedEl = this.relatedContentEl.createDiv({ cls: "knowledge-synthesis-related" });
      relatedEl.createEl("h4", { text: "Related Notes" });
      const relatedList = relatedEl.createDiv({ cls: "knowledge-synthesis-related-list" });
      for (const related of relatedNotes) {
        const noteEl = relatedList.createDiv({ cls: "knowledge-synthesis-related-note" });
        const linkEl = noteEl.createEl("a", {
          cls: "knowledge-synthesis-note-link",
          text: related.file.basename
        });
        linkEl.addEventListener("click", async (e) => {
          e.preventDefault();
          const leaf = this.app.workspace.getLeaf();
          if (leaf) {
            await leaf.openFile(related.file);
          }
        });
        const relevanceEl = noteEl.createDiv({
          cls: "knowledge-synthesis-relevance-bar"
        });
        const indicatorEl = relevanceEl.createDiv({
          cls: "knowledge-synthesis-relevance-indicator"
        });
        indicatorEl.style.width = `${Math.round(related.relevance * 100)}%`;
        if (related.sharedConcepts.length > 0) {
          const sharedEl = noteEl.createDiv({
            cls: "knowledge-synthesis-shared-concepts"
          });
          sharedEl.createSpan({
            cls: "knowledge-synthesis-shared-label",
            text: "Shared concepts: "
          });
          for (const concept of related.sharedConcepts) {
            sharedEl.createSpan({
              cls: "knowledge-synthesis-concept-tag knowledge-synthesis-shared",
              text: concept
            });
          }
        }
      }
    } else {
      this.relatedContentEl.createEl("p", {
        text: "No related notes found. Try adding more content or concepts.",
        cls: "knowledge-synthesis-no-results"
      });
    }
    const actionsEl = this.relatedContentEl.createDiv({ cls: "knowledge-synthesis-actions" });
    const summaryBtn = actionsEl.createEl("button", {
      cls: "knowledge-synthesis-summary-btn",
      text: "Generate Summary"
    });
    summaryBtn.addEventListener("click", async () => {
      if (this.currentFile) {
        await this.pluginApi.generateSummary(this.currentFile);
      }
    });
  }
  /**
   * Clear the view
   */
  clear() {
    this.relatedContentEl.empty();
    this.currentFile = null;
    this.relatedContentEl.createEl("h3", { text: "Related Notes" });
    this.relatedContentEl.createEl("p", {
      text: "Open a note to see related content.",
      cls: "knowledge-synthesis-placeholder"
    });
  }
};

// src/ui/settings-tab.ts
var import_obsidian5 = require("obsidian");
var KnowledgeSynthesisSettingTab = class extends import_obsidian5.PluginSettingTab {
  // Use the specific plugin class type
  constructor(app, plugin) {
    super(app, plugin);
    this.plugin = plugin;
  }
  display() {
    const { containerEl } = this;
    containerEl.empty();
    containerEl.createEl("h2", { text: "Knowledge Synthesis Settings" });
    new import_obsidian5.Setting(containerEl).setName("Concept Extraction Sensitivity").setDesc("Higher values extract more concepts (1-10)").addSlider((slider) => slider.setLimits(1, 10, 1).setValue(this.plugin.settings.extractionSensitivity).setDynamicTooltip().onChange(async (value) => {
      this.plugin.settings.extractionSensitivity = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian5.Setting(containerEl).setName("Reprocess All Notes").setDesc("Update the concept graph with all notes in the vault").addButton((button) => button.setButtonText("Reprocess").onClick(async () => {
      await this.plugin.processAllNotes();
    }));
    new import_obsidian5.Setting(containerEl).setName("Clear All Data").setDesc("Reset all concept and relationship data").addButton((button) => button.setButtonText("Clear Data").setWarning().onClick(async () => {
      const confirmed = confirm("Are you sure you want to clear all Knowledge Synthesis data? This cannot be undone.");
      if (confirmed) {
        await this.plugin.dataManager.clearData();
        new import_obsidian5.Notice("Knowledge Synthesis data cleared");
      }
    }));
  }
};

// main.ts
var DEFAULT_SETTINGS = {
  extractionSensitivity: 5,
  maxRelatedNotes: 10,
  realTimeSuggestions: true,
  includeTags: true,
  includeLinks: true
};
var KnowledgeSynthesisPlugin = class extends import_obsidian6.Plugin {
  /**
   * Plugin initialization
   */
  async onload() {
    console.log("Loading Knowledge Synthesis plugin");
    await this.loadSettings();
    this.conceptExtractor = new ConceptExtractorImpl();
    this.conceptExtractor.setSensitivity(this.settings.extractionSensitivity);
    this.conceptGraph = new ConceptGraphImpl(this.app.vault);
    this.dataManager = new DataManagerImpl(this);
    this.noteProcessor = new NoteProcessor(
      this.app.vault,
      this.conceptExtractor,
      this.conceptGraph,
      () => this.dataManager.saveConceptData()
    );
    this.summaryGenerator = new SummaryGenerator(
      this.app,
      this.conceptGraph,
      (file) => this.getRelatedNotes(file)
    );
    await this.dataManager.loadConceptData();
    this.registerView(
      RELATED_NOTES_VIEW_TYPE,
      (leaf) => new RelatedNotesView(leaf, this)
    );
    this.addRibbonIcon("network", "Knowledge Synthesis", () => {
      this.activateView();
    });
    this.addCommands();
    this.registerEvents();
    this.addSettingTab(new KnowledgeSynthesisSettingTab(this.app, this));
    this.processAllNotes();
    console.log("Knowledge Synthesis plugin loaded");
  }
  /**
   * Clean up when plugin is disabled
   */
  onunload() {
    console.log("Knowledge Synthesis plugin unloaded");
  }
  /**
   * Load plugin settings
   */
  async loadSettings() {
    this.settings = Object.assign({}, DEFAULT_SETTINGS, await this.loadData());
  }
  /**
   * Save plugin settings
   */
  async saveSettings() {
    await this.saveData(this.settings);
    this.conceptExtractor.setSensitivity(this.settings.extractionSensitivity);
  }
  /**
   * Add plugin commands to Obsidian command palette
   */
  addCommands() {
    this.addCommand({
      id: "extract-concepts",
      name: "Extract Concepts from Current Note",
      checkCallback: (checking) => {
        const activeView = this.app.workspace.getActiveViewOfType(import_obsidian6.MarkdownView);
        if (activeView) {
          if (!checking) {
            this.processCurrentNote();
          }
          return true;
        }
        return false;
      }
    });
    this.addCommand({
      id: "show-related-notes",
      name: "Show Related Notes",
      checkCallback: (checking) => {
        const activeView = this.app.workspace.getActiveViewOfType(import_obsidian6.MarkdownView);
        if (activeView) {
          if (!checking) {
            this.activateView();
          }
          return true;
        }
        return false;
      }
    });
    this.addCommand({
      id: "generate-summary",
      name: "Generate Summary from Related Notes",
      checkCallback: (checking) => {
        const activeView = this.app.workspace.getActiveViewOfType(import_obsidian6.MarkdownView);
        if (activeView && activeView.file) {
          if (!checking) {
            this.generateSummary(activeView.file);
          }
          return true;
        }
        return false;
      }
    });
  }
  /**
   * Register event handlers
   */
  registerEvents() {
    this.registerEvent(
      this.app.vault.on("modify", (file) => {
        if (file instanceof import_obsidian6.TFile && file.extension === "md") {
          if (this.settings.realTimeSuggestions) {
            this.noteProcessor.processNote(file);
          }
        }
      })
    );
    this.registerEvent(
      this.app.vault.on("delete", (file) => {
        if (file instanceof import_obsidian6.TFile && file.extension === "md") {
          this.conceptGraph.removeNote(file.path);
          this.dataManager.saveConceptData();
        }
      })
    );
    this.registerEvent(
      this.app.vault.on("rename", (file, oldPath) => {
        if (file instanceof import_obsidian6.TFile && file.extension === "md") {
          this.conceptGraph.removeNote(oldPath);
          this.noteProcessor.processNote(file);
        }
      })
    );
    this.registerEvent(
      this.app.workspace.on("active-leaf-change", (leaf) => {
        if ((leaf == null ? void 0 : leaf.view) instanceof import_obsidian6.MarkdownView && this.settings.realTimeSuggestions) {
          this.processCurrentNote();
        }
      })
    );
  }
  /**
   * Process the current active note
   */
  async processCurrentNote() {
    const activeView = this.app.workspace.getActiveViewOfType(import_obsidian6.MarkdownView);
    if (activeView && activeView.file) {
      await this.noteProcessor.processNote(activeView.file);
      this.updateRelatedNotesView(activeView.file);
    }
  }
  /**
   * Activate the related notes view
   */
  async activateView() {
    const leaves = this.app.workspace.getLeavesOfType(RELATED_NOTES_VIEW_TYPE);
    if (leaves.length === 0) {
      const leaf = this.app.workspace.getRightLeaf(false);
      if (leaf) {
        await leaf.setViewState({
          type: RELATED_NOTES_VIEW_TYPE,
          active: true
        });
      }
    }
    const existingLeaves = this.app.workspace.getLeavesOfType(RELATED_NOTES_VIEW_TYPE);
    if (existingLeaves.length > 0) {
      this.app.workspace.revealLeaf(existingLeaves[0]);
      const activeView = this.app.workspace.getActiveViewOfType(import_obsidian6.MarkdownView);
      if (activeView && activeView.file) {
        this.updateRelatedNotesView(activeView.file);
      }
    }
  }
  /**
   * Update the related notes view with data for a file
   * @param file File to show related notes for
   */
  updateRelatedNotesView(file) {
    const leaves = this.app.workspace.getLeavesOfType(RELATED_NOTES_VIEW_TYPE);
    if (leaves.length > 0) {
      const view = leaves[0].view;
      const relatedNotes = this.conceptGraph.findRelatedNotes(
        file.path,
        this.settings.maxRelatedNotes
      );
      view.updateRelatedNotes(file, relatedNotes);
    }
  }
  /**
   * Process all existing notes in the vault
   * Public for settings tab access
   */
  async processAllNotes() {
    await this.noteProcessor.processAllNotes();
  }
  /**
   * Clear all stored data
   * Public for settings tab access
   */
  async clearData() {
    await this.dataManager.clearData();
  }
  /**
   * API method: Get related notes for a file
   * @param file File to find related notes for
   * @returns Array of related notes
   */
  async getRelatedNotes(file) {
    return this.conceptGraph.findRelatedNotes(
      file.path,
      this.settings.maxRelatedNotes
    );
  }
  /**
   * API method: Extract concepts from content
   * @param content Text content to analyze
   * @returns Array of extracted concepts
   */
  extractConcepts(content) {
    return this.conceptExtractor.extractConcepts(content);
  }
  /**
   * API method: Add a concept to a note (used by UI when user adds a concept)
   * @param filePath Path to the file
   * @param concept Concept to add
   */
  async addConceptToNote(filePath, concept) {
    const concepts = this.conceptGraph.getNoteConcepts(filePath);
    if (!concepts.includes(concept)) {
      concepts.push(concept);
      this.conceptGraph.addNote(filePath, concepts);
      await this.dataManager.saveConceptData();
      new import_obsidian6.Notice(`Added concept "${concept}" to note`);
    }
  }
  /**
   * API method: Generate a summary from related notes
   * @param file File to generate summary for
   */
  generateSummary(file) {
    return this.summaryGenerator.generateSummary(file);
  }
  /**
   * API method: Get plugin settings
   * @returns Current plugin settings
   */
  getSettings() {
    return this.settings;
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsibWFpbi50cyIsICJzcmMvdXRpbHMvdGV4dC1wcm9jZXNzaW5nLnRzIiwgInNyYy9jb3JlL2NvbmNlcHQtZXh0cmFjdG9yLnRzIiwgInNyYy9jb3JlL2NvbmNlcHQtZ3JhcGgudHMiLCAic3JjL2NvcmUvZGF0YS1tYW5hZ2VyLnRzIiwgInNyYy9zZXJ2aWNlcy9ub3RlLXByb2Nlc3Nvci50cyIsICJzcmMvc2VydmljZXMvc3VtbWFyeS1nZW5lcmF0b3IudHMiLCAic3JjL3VpL3JlbGF0ZWQtbm90ZXMtdmlldy50cyIsICJzcmMvdWkvc2V0dGluZ3MtdGFiLnRzIl0sCiAgInNvdXJjZXNDb250ZW50IjogWyJpbXBvcnQgeyBcclxuICAgIEFwcCwgXHJcbiAgICBNYXJrZG93blZpZXcsIFxyXG4gICAgTm90aWNlLCBcclxuICAgIFBsdWdpbiwgXHJcbiAgICBURmlsZSxcclxuICAgIFdvcmtzcGFjZUxlYWZcclxufSBmcm9tICdvYnNpZGlhbic7XHJcblxyXG4vLyBJbXBvcnQgdHlwZXNcclxuaW1wb3J0IHsgXHJcbiAgICBLbm93bGVkZ2VTeW50aGVzaXNTZXR0aW5ncywgXHJcbiAgICBDb25jZXB0RXh0cmFjdG9yLCBcclxuICAgIENvbmNlcHRHcmFwaCwgXHJcbiAgICBSZWxhdGVkTm90ZSxcclxuICAgIFBsdWdpbkFQSVxyXG59IGZyb20gJy4vc3JjL3V0aWxzL3R5cGVzJztcclxuXHJcbi8vIEltcG9ydCBpbXBsZW1lbnRhdGlvbnNcclxuaW1wb3J0IHsgQ29uY2VwdEV4dHJhY3RvckltcGwgfSBmcm9tICcuL3NyYy9jb3JlL2NvbmNlcHQtZXh0cmFjdG9yJztcclxuaW1wb3J0IHsgQ29uY2VwdEdyYXBoSW1wbCB9IGZyb20gJy4vc3JjL2NvcmUvY29uY2VwdC1ncmFwaCc7XHJcbmltcG9ydCB7IERhdGFNYW5hZ2VySW1wbCB9IGZyb20gJy4vc3JjL2NvcmUvZGF0YS1tYW5hZ2VyJztcclxuaW1wb3J0IHsgTm90ZVByb2Nlc3NvciB9IGZyb20gJy4vc3JjL3NlcnZpY2VzL25vdGUtcHJvY2Vzc29yJztcclxuaW1wb3J0IHsgU3VtbWFyeUdlbmVyYXRvciB9IGZyb20gJy4vc3JjL3NlcnZpY2VzL3N1bW1hcnktZ2VuZXJhdG9yJztcclxuaW1wb3J0IHsgUmVsYXRlZE5vdGVzVmlldywgUkVMQVRFRF9OT1RFU19WSUVXX1RZUEUgfSBmcm9tICcuL3NyYy91aS9yZWxhdGVkLW5vdGVzLXZpZXcnO1xyXG5pbXBvcnQgeyBLbm93bGVkZ2VTeW50aGVzaXNTZXR0aW5nVGFiIH0gZnJvbSAnLi9zcmMvdWkvc2V0dGluZ3MtdGFiJztcclxuXHJcbi8vIERlZmF1bHQgc2V0dGluZ3NcclxuY29uc3QgREVGQVVMVF9TRVRUSU5HUzogS25vd2xlZGdlU3ludGhlc2lzU2V0dGluZ3MgPSB7XHJcbiAgICBleHRyYWN0aW9uU2Vuc2l0aXZpdHk6IDUsXHJcbiAgICBtYXhSZWxhdGVkTm90ZXM6IDEwLFxyXG4gICAgcmVhbFRpbWVTdWdnZXN0aW9uczogdHJ1ZSxcclxuICAgIGluY2x1ZGVUYWdzOiB0cnVlLFxyXG4gICAgaW5jbHVkZUxpbmtzOiB0cnVlXHJcbn1cclxuXHJcbi8qKlxyXG4gKiBNYWluIHBsdWdpbiBjbGFzcyBmb3IgS25vd2xlZGdlIFN5bnRoZXNpc1xyXG4gKiBDb29yZGluYXRlcyBhbGwgY29tcG9uZW50cyBhbmQgaW50ZWdyYXRlcyB3aXRoIE9ic2lkaWFuXHJcbiAqL1xyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBLbm93bGVkZ2VTeW50aGVzaXNQbHVnaW4gZXh0ZW5kcyBQbHVnaW4gaW1wbGVtZW50cyBQbHVnaW5BUEkgIHtcclxuICAgIC8vIFBsdWdpbiBzZXR0aW5nc1xyXG4gICAgc2V0dGluZ3M6IEtub3dsZWRnZVN5bnRoZXNpc1NldHRpbmdzO1xyXG4gICAgXHJcbiAgICAvLyBDb3JlIGNvbXBvbmVudHNcclxuICAgIHByaXZhdGUgY29uY2VwdEV4dHJhY3RvcjogQ29uY2VwdEV4dHJhY3RvcjtcclxuICAgIHByaXZhdGUgY29uY2VwdEdyYXBoOiBDb25jZXB0R3JhcGg7XHJcbiAgICBwdWJsaWMgZGF0YU1hbmFnZXI6IERhdGFNYW5hZ2VySW1wbDsgLy8gUHVibGljIHNvIGl0IGNhbiBiZSBhY2Nlc3NlZCBieSBTZXR0aW5nc1RhYlxyXG4gICAgXHJcbiAgICAvLyBTZXJ2aWNlc1xyXG4gICAgcHJpdmF0ZSBub3RlUHJvY2Vzc29yOiBOb3RlUHJvY2Vzc29yO1xyXG4gICAgcHJpdmF0ZSBzdW1tYXJ5R2VuZXJhdG9yOiBTdW1tYXJ5R2VuZXJhdG9yO1xyXG4gICAgXHJcbiAgICAvKipcclxuICAgICAqIFBsdWdpbiBpbml0aWFsaXphdGlvblxyXG4gICAgICovXHJcbiAgICBhc3luYyBvbmxvYWQoKSB7XHJcbiAgICAgICAgY29uc29sZS5sb2coJ0xvYWRpbmcgS25vd2xlZGdlIFN5bnRoZXNpcyBwbHVnaW4nKTtcclxuICAgICAgICBcclxuICAgICAgICAvLyBMb2FkIHNldHRpbmdzXHJcbiAgICAgICAgYXdhaXQgdGhpcy5sb2FkU2V0dGluZ3MoKTtcclxuICAgICAgICBcclxuICAgICAgICAvLyBJbml0aWFsaXplIGNvcmUgY29tcG9uZW50c1xyXG4gICAgICAgIHRoaXMuY29uY2VwdEV4dHJhY3RvciA9IG5ldyBDb25jZXB0RXh0cmFjdG9ySW1wbCgpO1xyXG4gICAgICAgIHRoaXMuY29uY2VwdEV4dHJhY3Rvci5zZXRTZW5zaXRpdml0eSh0aGlzLnNldHRpbmdzLmV4dHJhY3Rpb25TZW5zaXRpdml0eSk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgdGhpcy5jb25jZXB0R3JhcGggPSBuZXcgQ29uY2VwdEdyYXBoSW1wbCh0aGlzLmFwcC52YXVsdCk7XHJcbiAgICAgICAgdGhpcy5kYXRhTWFuYWdlciA9IG5ldyBEYXRhTWFuYWdlckltcGwodGhpcyk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gSW5pdGlhbGl6ZSBzZXJ2aWNlc1xyXG4gICAgICAgIHRoaXMubm90ZVByb2Nlc3NvciA9IG5ldyBOb3RlUHJvY2Vzc29yKFxyXG4gICAgICAgICAgICB0aGlzLmFwcC52YXVsdCxcclxuICAgICAgICAgICAgdGhpcy5jb25jZXB0RXh0cmFjdG9yLFxyXG4gICAgICAgICAgICB0aGlzLmNvbmNlcHRHcmFwaCxcclxuICAgICAgICAgICAgKCkgPT4gdGhpcy5kYXRhTWFuYWdlci5zYXZlQ29uY2VwdERhdGEoKVxyXG4gICAgICAgICk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgdGhpcy5zdW1tYXJ5R2VuZXJhdG9yID0gbmV3IFN1bW1hcnlHZW5lcmF0b3IoXHJcbiAgICAgICAgICAgIHRoaXMuYXBwLFxyXG4gICAgICAgICAgICB0aGlzLmNvbmNlcHRHcmFwaCxcclxuICAgICAgICAgICAgKGZpbGUpID0+IHRoaXMuZ2V0UmVsYXRlZE5vdGVzKGZpbGUpXHJcbiAgICAgICAgKTtcclxuICAgICAgICBcclxuICAgICAgICAvLyBMb2FkIHNhdmVkIGRhdGFcclxuICAgICAgICBhd2FpdCB0aGlzLmRhdGFNYW5hZ2VyLmxvYWRDb25jZXB0RGF0YSgpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIFJlZ2lzdGVyIHZpZXcgZm9yIHJlbGF0ZWQgbm90ZXNcclxuICAgICAgICB0aGlzLnJlZ2lzdGVyVmlldyhcclxuICAgICAgICAgICAgUkVMQVRFRF9OT1RFU19WSUVXX1RZUEUsXHJcbiAgICAgICAgICAgIChsZWFmKSA9PiBuZXcgUmVsYXRlZE5vdGVzVmlldyhsZWFmLCB0aGlzKVxyXG4gICAgICAgICk7XHJcblxyXG4gICAgICAgIC8vIEFkZCByaWJib24gaWNvbiBmb3IgcXVpY2sgYWNjZXNzXHJcbiAgICAgICAgdGhpcy5hZGRSaWJib25JY29uKCduZXR3b3JrJywgJ0tub3dsZWRnZSBTeW50aGVzaXMnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuYWN0aXZhdGVWaWV3KCk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIC8vIFJlZ2lzdGVyIGNvbW1hbmRzXHJcbiAgICAgICAgdGhpcy5hZGRDb21tYW5kcygpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIFJlZ2lzdGVyIGV2ZW50IGhhbmRsZXJzXHJcbiAgICAgICAgdGhpcy5yZWdpc3RlckV2ZW50cygpO1xyXG5cclxuICAgICAgICAvLyBBZGQgc2V0dGluZ3MgdGFiXHJcbiAgICAgICAgdGhpcy5hZGRTZXR0aW5nVGFiKG5ldyBLbm93bGVkZ2VTeW50aGVzaXNTZXR0aW5nVGFiKHRoaXMuYXBwLCB0aGlzKSk7XHJcblxyXG4gICAgICAgIC8vIFByb2Nlc3MgZXhpc3Rpbmcgbm90ZXMgaW4gdGhlIHZhdWx0XHJcbiAgICAgICAgdGhpcy5wcm9jZXNzQWxsTm90ZXMoKTtcclxuICAgICAgICBcclxuICAgICAgICBjb25zb2xlLmxvZygnS25vd2xlZGdlIFN5bnRoZXNpcyBwbHVnaW4gbG9hZGVkJyk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBDbGVhbiB1cCB3aGVuIHBsdWdpbiBpcyBkaXNhYmxlZFxyXG4gICAgICovXHJcbiAgICBvbnVubG9hZCgpIHtcclxuICAgICAgICBjb25zb2xlLmxvZygnS25vd2xlZGdlIFN5bnRoZXNpcyBwbHVnaW4gdW5sb2FkZWQnKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIExvYWQgcGx1Z2luIHNldHRpbmdzXHJcbiAgICAgKi9cclxuICAgIGFzeW5jIGxvYWRTZXR0aW5ncygpIHtcclxuICAgICAgICB0aGlzLnNldHRpbmdzID0gT2JqZWN0LmFzc2lnbih7fSwgREVGQVVMVF9TRVRUSU5HUywgYXdhaXQgdGhpcy5sb2FkRGF0YSgpKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFNhdmUgcGx1Z2luIHNldHRpbmdzXHJcbiAgICAgKi9cclxuICAgIGFzeW5jIHNhdmVTZXR0aW5ncygpIHtcclxuICAgICAgICBhd2FpdCB0aGlzLnNhdmVEYXRhKHRoaXMuc2V0dGluZ3MpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIFVwZGF0ZSBleHRyYWN0b3Igc2Vuc2l0aXZpdHkgd2hlbiBzZXR0aW5ncyBjaGFuZ2VcclxuICAgICAgICB0aGlzLmNvbmNlcHRFeHRyYWN0b3Iuc2V0U2Vuc2l0aXZpdHkodGhpcy5zZXR0aW5ncy5leHRyYWN0aW9uU2Vuc2l0aXZpdHkpO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvKipcclxuICAgICAqIEFkZCBwbHVnaW4gY29tbWFuZHMgdG8gT2JzaWRpYW4gY29tbWFuZCBwYWxldHRlXHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgYWRkQ29tbWFuZHMoKSB7XHJcbiAgICAgICAgLy8gQ29tbWFuZCB0byBleHRyYWN0IGNvbmNlcHRzIGZyb20gY3VycmVudCBub3RlXHJcbiAgICAgICAgdGhpcy5hZGRDb21tYW5kKHtcclxuICAgICAgICAgICAgaWQ6ICdleHRyYWN0LWNvbmNlcHRzJyxcclxuICAgICAgICAgICAgbmFtZTogJ0V4dHJhY3QgQ29uY2VwdHMgZnJvbSBDdXJyZW50IE5vdGUnLFxyXG4gICAgICAgICAgICBjaGVja0NhbGxiYWNrOiAoY2hlY2tpbmc6IGJvb2xlYW4pID0+IHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGFjdGl2ZVZpZXcgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlVmlld09mVHlwZShNYXJrZG93blZpZXcpO1xyXG4gICAgICAgICAgICAgICAgaWYgKGFjdGl2ZVZpZXcpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoIWNoZWNraW5nKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucHJvY2Vzc0N1cnJlbnROb3RlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gQ29tbWFuZCB0byBzaG93IHJlbGF0ZWQgbm90ZXNcclxuICAgICAgICB0aGlzLmFkZENvbW1hbmQoe1xyXG4gICAgICAgICAgICBpZDogJ3Nob3ctcmVsYXRlZC1ub3RlcycsXHJcbiAgICAgICAgICAgIG5hbWU6ICdTaG93IFJlbGF0ZWQgTm90ZXMnLFxyXG4gICAgICAgICAgICBjaGVja0NhbGxiYWNrOiAoY2hlY2tpbmc6IGJvb2xlYW4pID0+IHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGFjdGl2ZVZpZXcgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlVmlld09mVHlwZShNYXJrZG93blZpZXcpO1xyXG4gICAgICAgICAgICAgICAgaWYgKGFjdGl2ZVZpZXcpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoIWNoZWNraW5nKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYWN0aXZhdGVWaWV3KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gQ29tbWFuZCB0byBnZW5lcmF0ZSBzdW1tYXJ5IGZyb20gcmVsYXRlZCBub3Rlc1xyXG4gICAgICAgIHRoaXMuYWRkQ29tbWFuZCh7XHJcbiAgICAgICAgICAgIGlkOiAnZ2VuZXJhdGUtc3VtbWFyeScsXHJcbiAgICAgICAgICAgIG5hbWU6ICdHZW5lcmF0ZSBTdW1tYXJ5IGZyb20gUmVsYXRlZCBOb3RlcycsXHJcbiAgICAgICAgICAgIGNoZWNrQ2FsbGJhY2s6IChjaGVja2luZzogYm9vbGVhbikgPT4ge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgYWN0aXZlVmlldyA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVWaWV3T2ZUeXBlKE1hcmtkb3duVmlldyk7XHJcbiAgICAgICAgICAgICAgICBpZiAoYWN0aXZlVmlldyAmJiBhY3RpdmVWaWV3LmZpbGUpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoIWNoZWNraW5nKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZ2VuZXJhdGVTdW1tYXJ5KGFjdGl2ZVZpZXcuZmlsZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8qKlxyXG4gICAgICogUmVnaXN0ZXIgZXZlbnQgaGFuZGxlcnNcclxuICAgICAqL1xyXG4gICAgcHJpdmF0ZSByZWdpc3RlckV2ZW50cygpIHtcclxuICAgICAgICAvLyBQcm9jZXNzIG5vdGUgd2hlbiBpdCdzIHNhdmVkXHJcbiAgICAgICAgdGhpcy5yZWdpc3RlckV2ZW50KFxyXG4gICAgICAgICAgICB0aGlzLmFwcC52YXVsdC5vbignbW9kaWZ5JywgKGZpbGUpID0+IHtcclxuICAgICAgICAgICAgICAgIGlmIChmaWxlIGluc3RhbmNlb2YgVEZpbGUgJiYgZmlsZS5leHRlbnNpb24gPT09ICdtZCcpIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyBPbmx5IHByb2Nlc3MgaWYgcmVhbFRpbWVTdWdnZXN0aW9ucyBpcyBlbmFibGVkXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuc2V0dGluZ3MucmVhbFRpbWVTdWdnZXN0aW9ucykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm5vdGVQcm9jZXNzb3IucHJvY2Vzc05vdGUoZmlsZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gUmVtb3ZlIG5vdGUgZnJvbSBncmFwaCB3aGVuIGRlbGV0ZWRcclxuICAgICAgICB0aGlzLnJlZ2lzdGVyRXZlbnQoXHJcbiAgICAgICAgICAgIHRoaXMuYXBwLnZhdWx0Lm9uKCdkZWxldGUnLCAoZmlsZSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYgKGZpbGUgaW5zdGFuY2VvZiBURmlsZSAmJiBmaWxlLmV4dGVuc2lvbiA9PT0gJ21kJykge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY29uY2VwdEdyYXBoLnJlbW92ZU5vdGUoZmlsZS5wYXRoKTtcclxuICAgICAgICAgICAgICAgICAgICAvLyBTYXZlIGNoYW5nZXNcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmRhdGFNYW5hZ2VyLnNhdmVDb25jZXB0RGF0YSgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gVXBkYXRlIHdoZW4gYSBmaWxlIGlzIHJlbmFtZWRcclxuICAgICAgICB0aGlzLnJlZ2lzdGVyRXZlbnQoXHJcbiAgICAgICAgICAgIHRoaXMuYXBwLnZhdWx0Lm9uKCdyZW5hbWUnLCAoZmlsZSwgb2xkUGF0aCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYgKGZpbGUgaW5zdGFuY2VvZiBURmlsZSAmJiBmaWxlLmV4dGVuc2lvbiA9PT0gJ21kJykge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIFJlbW92ZSBvbGQgcGF0aCBhbmQgYWRkIHdpdGggbmV3IHBhdGhcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmNvbmNlcHRHcmFwaC5yZW1vdmVOb3RlKG9sZFBhdGgpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMubm90ZVByb2Nlc3Nvci5wcm9jZXNzTm90ZShmaWxlKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSlcclxuICAgICAgICApO1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIFByb2Nlc3MgY3VycmVudCBub3RlIHdoZW4gYWN0aXZlIGxlYWYgY2hhbmdlc1xyXG4gICAgICAgIHRoaXMucmVnaXN0ZXJFdmVudChcclxuICAgICAgICAgICAgdGhpcy5hcHAud29ya3NwYWNlLm9uKCdhY3RpdmUtbGVhZi1jaGFuZ2UnLCAobGVhZikgPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYgKGxlYWY/LnZpZXcgaW5zdGFuY2VvZiBNYXJrZG93blZpZXcgJiYgdGhpcy5zZXR0aW5ncy5yZWFsVGltZVN1Z2dlc3Rpb25zKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wcm9jZXNzQ3VycmVudE5vdGUoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSlcclxuICAgICAgICApO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvKipcclxuICAgICAqIFByb2Nlc3MgdGhlIGN1cnJlbnQgYWN0aXZlIG5vdGVcclxuICAgICAqL1xyXG4gICAgcHJpdmF0ZSBhc3luYyBwcm9jZXNzQ3VycmVudE5vdGUoKSB7XHJcbiAgICAgICAgY29uc3QgYWN0aXZlVmlldyA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVWaWV3T2ZUeXBlKE1hcmtkb3duVmlldyk7XHJcbiAgICAgICAgaWYgKGFjdGl2ZVZpZXcgJiYgYWN0aXZlVmlldy5maWxlKSB7XHJcbiAgICAgICAgICAgIGF3YWl0IHRoaXMubm90ZVByb2Nlc3Nvci5wcm9jZXNzTm90ZShhY3RpdmVWaWV3LmZpbGUpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgLy8gVXBkYXRlIHJlbGF0ZWQgbm90ZXMgdmlldyBpZiBpdCdzIG9wZW5cclxuICAgICAgICAgICAgdGhpcy51cGRhdGVSZWxhdGVkTm90ZXNWaWV3KGFjdGl2ZVZpZXcuZmlsZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvKipcclxuICAgICAqIEFjdGl2YXRlIHRoZSByZWxhdGVkIG5vdGVzIHZpZXdcclxuICAgICAqL1xyXG4gICAgcHJpdmF0ZSBhc3luYyBhY3RpdmF0ZVZpZXcoKSB7XHJcbiAgICAgICAgLy8gQ2hlY2sgaWYgdmlldyBpcyBhbHJlYWR5IG9wZW5cclxuICAgICAgICBjb25zdCBsZWF2ZXMgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0TGVhdmVzT2ZUeXBlKFJFTEFURURfTk9URVNfVklFV19UWVBFKTtcclxuICAgICAgICBcclxuICAgICAgICBpZiAobGVhdmVzLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICAgICAgICAvLyBDcmVhdGUgdGhlIHZpZXcgaWYgaXQgZG9lc24ndCBleGlzdFxyXG4gICAgICAgICAgICBjb25zdCBsZWFmID0gdGhpcy5hcHAud29ya3NwYWNlLmdldFJpZ2h0TGVhZihmYWxzZSk7XHJcbiAgICAgICAgICAgIGlmIChsZWFmKSB7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCBsZWFmLnNldFZpZXdTdGF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogUkVMQVRFRF9OT1RFU19WSUVXX1RZUEUsXHJcbiAgICAgICAgICAgICAgICAgICAgYWN0aXZlOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gRm9jdXMgdGhlIHZpZXdcclxuICAgICAgICBjb25zdCBleGlzdGluZ0xlYXZlcyA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRMZWF2ZXNPZlR5cGUoUkVMQVRFRF9OT1RFU19WSUVXX1RZUEUpO1xyXG4gICAgICAgIGlmIChleGlzdGluZ0xlYXZlcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgIHRoaXMuYXBwLndvcmtzcGFjZS5yZXZlYWxMZWFmKGV4aXN0aW5nTGVhdmVzWzBdKTtcclxuICAgICAgICBcclxuICAgICAgICAgICAgLy8gVXBkYXRlIHdpdGggY3VycmVudCBmaWxlXHJcbiAgICAgICAgICAgIGNvbnN0IGFjdGl2ZVZpZXcgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlVmlld09mVHlwZShNYXJrZG93blZpZXcpO1xyXG4gICAgICAgICAgICBpZiAoYWN0aXZlVmlldyAmJiBhY3RpdmVWaWV3LmZpbGUpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlUmVsYXRlZE5vdGVzVmlldyhhY3RpdmVWaWV3LmZpbGUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvKipcclxuICAgICAqIFVwZGF0ZSB0aGUgcmVsYXRlZCBub3RlcyB2aWV3IHdpdGggZGF0YSBmb3IgYSBmaWxlXHJcbiAgICAgKiBAcGFyYW0gZmlsZSBGaWxlIHRvIHNob3cgcmVsYXRlZCBub3RlcyBmb3JcclxuICAgICAqL1xyXG4gICAgcHJpdmF0ZSB1cGRhdGVSZWxhdGVkTm90ZXNWaWV3KGZpbGU6IFRGaWxlKSB7XHJcbiAgICAgICAgY29uc3QgbGVhdmVzID0gdGhpcy5hcHAud29ya3NwYWNlLmdldExlYXZlc09mVHlwZShSRUxBVEVEX05PVEVTX1ZJRVdfVFlQRSk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgaWYgKGxlYXZlcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHZpZXcgPSBsZWF2ZXNbMF0udmlldyBhcyBSZWxhdGVkTm90ZXNWaWV3O1xyXG4gICAgICAgICAgICBjb25zdCByZWxhdGVkTm90ZXMgPSB0aGlzLmNvbmNlcHRHcmFwaC5maW5kUmVsYXRlZE5vdGVzKFxyXG4gICAgICAgICAgICAgICAgZmlsZS5wYXRoLCBcclxuICAgICAgICAgICAgICAgIHRoaXMuc2V0dGluZ3MubWF4UmVsYXRlZE5vdGVzXHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICB2aWV3LnVwZGF0ZVJlbGF0ZWROb3RlcyhmaWxlLCByZWxhdGVkTm90ZXMpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIFxyXG4gICAgLyoqXHJcbiAgICAgKiBQcm9jZXNzIGFsbCBleGlzdGluZyBub3RlcyBpbiB0aGUgdmF1bHRcclxuICAgICAqIFB1YmxpYyBmb3Igc2V0dGluZ3MgdGFiIGFjY2Vzc1xyXG4gICAgICovXHJcbiAgICBwdWJsaWMgYXN5bmMgcHJvY2Vzc0FsbE5vdGVzKCk6IFByb21pc2U8dm9pZD4ge1xyXG4gICAgICAgIGF3YWl0IHRoaXMubm90ZVByb2Nlc3Nvci5wcm9jZXNzQWxsTm90ZXMoKTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgLyoqXHJcbiAgICAgKiBDbGVhciBhbGwgc3RvcmVkIGRhdGFcclxuICAgICAqIFB1YmxpYyBmb3Igc2V0dGluZ3MgdGFiIGFjY2Vzc1xyXG4gICAgICovXHJcbiAgICBwdWJsaWMgYXN5bmMgY2xlYXJEYXRhKCk6IFByb21pc2U8dm9pZD4ge1xyXG4gICAgICAgIGF3YWl0IHRoaXMuZGF0YU1hbmFnZXIuY2xlYXJEYXRhKCk7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8qKlxyXG4gICAgICogQVBJIG1ldGhvZDogR2V0IHJlbGF0ZWQgbm90ZXMgZm9yIGEgZmlsZVxyXG4gICAgICogQHBhcmFtIGZpbGUgRmlsZSB0byBmaW5kIHJlbGF0ZWQgbm90ZXMgZm9yXHJcbiAgICAgKiBAcmV0dXJucyBBcnJheSBvZiByZWxhdGVkIG5vdGVzXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBhc3luYyBnZXRSZWxhdGVkTm90ZXMoZmlsZTogVEZpbGUpOiBQcm9taXNlPFJlbGF0ZWROb3RlW10+IHtcclxuICAgICAgICByZXR1cm4gdGhpcy5jb25jZXB0R3JhcGguZmluZFJlbGF0ZWROb3RlcyhcclxuICAgICAgICAgICAgZmlsZS5wYXRoLCBcclxuICAgICAgICAgICAgdGhpcy5zZXR0aW5ncy5tYXhSZWxhdGVkTm90ZXNcclxuICAgICAgICApO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvKipcclxuICAgICAqIEFQSSBtZXRob2Q6IEV4dHJhY3QgY29uY2VwdHMgZnJvbSBjb250ZW50XHJcbiAgICAgKiBAcGFyYW0gY29udGVudCBUZXh0IGNvbnRlbnQgdG8gYW5hbHl6ZVxyXG4gICAgICogQHJldHVybnMgQXJyYXkgb2YgZXh0cmFjdGVkIGNvbmNlcHRzXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBleHRyYWN0Q29uY2VwdHMoY29udGVudDogc3RyaW5nKTogc3RyaW5nW10ge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmNvbmNlcHRFeHRyYWN0b3IuZXh0cmFjdENvbmNlcHRzKGNvbnRlbnQpO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvKipcclxuICAgICAqIEFQSSBtZXRob2Q6IEFkZCBhIGNvbmNlcHQgdG8gYSBub3RlICh1c2VkIGJ5IFVJIHdoZW4gdXNlciBhZGRzIGEgY29uY2VwdClcclxuICAgICAqIEBwYXJhbSBmaWxlUGF0aCBQYXRoIHRvIHRoZSBmaWxlXHJcbiAgICAgKiBAcGFyYW0gY29uY2VwdCBDb25jZXB0IHRvIGFkZFxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgYXN5bmMgYWRkQ29uY2VwdFRvTm90ZShmaWxlUGF0aDogc3RyaW5nLCBjb25jZXB0OiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcclxuICAgICAgICAvLyBHZXQgY3VycmVudCBjb25jZXB0c1xyXG4gICAgICAgIGNvbnN0IGNvbmNlcHRzID0gdGhpcy5jb25jZXB0R3JhcGguZ2V0Tm90ZUNvbmNlcHRzKGZpbGVQYXRoKTtcclxuICAgICAgICBcclxuICAgICAgICAvLyBBZGQgbmV3IGNvbmNlcHQgaWYgbm90IGFscmVhZHkgcHJlc2VudFxyXG4gICAgICAgIGlmICghY29uY2VwdHMuaW5jbHVkZXMoY29uY2VwdCkpIHtcclxuICAgICAgICAgICAgY29uY2VwdHMucHVzaChjb25jZXB0KTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIFVwZGF0ZSB0aGUgZ3JhcGhcclxuICAgICAgICAgICAgdGhpcy5jb25jZXB0R3JhcGguYWRkTm90ZShmaWxlUGF0aCwgY29uY2VwdHMpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgLy8gU2F2ZSBjaGFuZ2VzXHJcbiAgICAgICAgICAgIGF3YWl0IHRoaXMuZGF0YU1hbmFnZXIuc2F2ZUNvbmNlcHREYXRhKCk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyBOb3RpZnkgc3VjY2Vzc1xyXG4gICAgICAgICAgICBuZXcgTm90aWNlKGBBZGRlZCBjb25jZXB0IFwiJHtjb25jZXB0fVwiIHRvIG5vdGVgKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8qKlxyXG4gICAgICogQVBJIG1ldGhvZDogR2VuZXJhdGUgYSBzdW1tYXJ5IGZyb20gcmVsYXRlZCBub3Rlc1xyXG4gICAgICogQHBhcmFtIGZpbGUgRmlsZSB0byBnZW5lcmF0ZSBzdW1tYXJ5IGZvclxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgZ2VuZXJhdGVTdW1tYXJ5KGZpbGU6IFRGaWxlKTogUHJvbWlzZTxzdHJpbmc+IHtcclxuICAgICAgICByZXR1cm4gdGhpcy5zdW1tYXJ5R2VuZXJhdG9yLmdlbmVyYXRlU3VtbWFyeShmaWxlKTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgLyoqXHJcbiAgICAgKiBBUEkgbWV0aG9kOiBHZXQgcGx1Z2luIHNldHRpbmdzXHJcbiAgICAgKiBAcmV0dXJucyBDdXJyZW50IHBsdWdpbiBzZXR0aW5nc1xyXG4gICAgICovXHJcbiAgICBwdWJsaWMgZ2V0U2V0dGluZ3MoKTogS25vd2xlZGdlU3ludGhlc2lzU2V0dGluZ3Mge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnNldHRpbmdzO1xyXG4gICAgfVxyXG59IiwgImltcG9ydCB7IFRleHRQcm9jZXNzb3IgfSBmcm9tICcuL3R5cGVzJztcclxuXHJcbi8vSW1wbGVtZW50YXRpb24gb2YgdGV4dCBwcm9jZXNzaW5nIHV0aWxpdGllcyBmb3IgTkxQXHJcblxyXG5leHBvcnQgY2xhc3MgVGV4dFByb2Nlc3NpbmdVdGlscyBpbXBsZW1lbnRzIFRleHRQcm9jZXNzb3Ige1xyXG4gICAgLy9Db21tb24gRW5nbGlzaCBzdG9wIHdvcmRzIHRvIGZpbHRlciBvdXRcclxuICAgIHByaXZhdGUgc3RvcFdvcmRzOiBTZXQ8c3RyaW5nPiA9IG5ldyBTZXQoW1xyXG4gICAgICAgICdhJywgJ2FuJywgJ3RoZScsICdhbmQnLCAnb3InLCAnYnV0JywgJ2lzJywgJ2FyZScsICd3YXMnLCAnd2VyZScsIFxyXG4gICAgICAgICdiZScsICdiZWVuJywgJ2JlaW5nJywgJ2hhdmUnLCAnaGFzJywgJ2hhZCcsICdkbycsICdkb2VzJywgJ2RpZCcsXHJcbiAgICAgICAgJ3RvJywgJ2Zyb20nLCAnaW4nLCAnb3V0JywgJ29uJywgJ29mZicsICdvdmVyJywgJ3VuZGVyJywgJ2FnYWluJyxcclxuICAgICAgICAnZnVydGhlcicsICd0aGVuJywgJ29uY2UnLCAnaGVyZScsICd0aGVyZScsICd3aGVuJywgJ3doZXJlJywgJ3doeScsXHJcbiAgICAgICAgJ2hvdycsICdhbGwnLCAnYW55JywgJ2JvdGgnLCAnZWFjaCcsICdmZXcnLCAnbW9yZScsICdtb3N0JywgJ290aGVyJyxcclxuICAgICAgICAnc29tZScsICdzdWNoJywgJ25vJywgJ25vcicsICdub3QnLCAnb25seScsICdvd24nLCAnc2FtZScsICdzbycsIFxyXG4gICAgICAgICd0aGFuJywgJ3RvbycsICd2ZXJ5JywgJ2NhbicsICd3aWxsJywgJ2p1c3QnLCAnc2hvdWxkJywgJ25vdydcclxuICAgIF0pO1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogVG9rZW5pemUgdGV4dCBpbnRvIHdvcmRzXHJcbiAgICAgKiBAcGFyYW0gdGV4dCBJbnB1dCB0ZXh0IHRvIHRva2VuaXplXHJcbiAgICAgKiBAcmV0dXJucyBBcnJheSBvZiB0b2tlbnNcclxuICAgICAqL1xyXG4gICAgcHVibGljIHRva2VuaXplKHRleHQ6IHN0cmluZyk6IHN0cmluZ1tdIHtcclxuICAgICAgICAvL1JlbW92ZSBzcGVjaWFsIGNoYXJhY3RlcnMgYW5kIHRva2VuaXplXHJcbiAgICAgICAgY29uc3Qgbm9ybWFsaXplZCA9IHRleHQudG9Mb3dlckNhc2UoKVxyXG4gICAgICAgICAgICAucmVwbGFjZSgvW15cXHdcXHNdL2csICcgJykgIC8vUmVwbGFjZSBzcGVjaWFsIGNoYXJzIHdpdGggc3BhY2VcclxuICAgICAgICAgICAgLnJlcGxhY2UoL1xccysvZywgJyAnKSAgICAgIC8vUmVwbGFjZSBtdWx0aXBsZSBzcGFjZXMgd2l0aCBzaW5nbGUgc3BhY2VcclxuICAgICAgICAgICAgLnRyaW0oKTsgICAgICAgICAgICAgICAgICAgLy9UcmltIGxlYWRpbmcvdHJhaWxpbmcgc3BhY2VzXHJcbiAgICAgICAgXHJcbiAgICAgICAgcmV0dXJuIG5vcm1hbGl6ZWQuc3BsaXQoJyAnKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIENhbGN1bGF0ZSB0ZXJtIGZyZXF1ZW5jeSBmb3IgdG9rZW5zXHJcbiAgICAgKiBAcGFyYW0gdG9rZW5zIEFycmF5IG9mIHRva2Vuc1xyXG4gICAgICogQHJldHVybnMgTWFwIG9mIHRlcm1zIHRvIHRoZWlyIGZyZXF1ZW5jeVxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgY2FsY3VsYXRlVGVybUZyZXF1ZW5jeSh0b2tlbnM6IHN0cmluZ1tdKTogTWFwPHN0cmluZywgbnVtYmVyPiB7XHJcbiAgICAgICAgY29uc3QgdGVybUZyZXF1ZW5jeSA9IG5ldyBNYXA8c3RyaW5nLCBudW1iZXI+KCk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgZm9yIChjb25zdCB0b2tlbiBvZiB0b2tlbnMpIHtcclxuICAgICAgICAgICAgY29uc3QgY291bnQgPSB0ZXJtRnJlcXVlbmN5LmdldCh0b2tlbikgfHwgMDtcclxuICAgICAgICAgICAgdGVybUZyZXF1ZW5jeS5zZXQodG9rZW4sIGNvdW50ICsgMSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgIHJldHVybiB0ZXJtRnJlcXVlbmN5O1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogUmVtb3ZlIGNvbW1vbiBzdG9wIHdvcmRzIGZyb20gdG9rZW5zXHJcbiAgICAgKiBAcGFyYW0gdG9rZW5zIEFycmF5IG9mIHRva2Vuc1xyXG4gICAgICogQHJldHVybnMgRmlsdGVyZWQgYXJyYXkgd2l0aCBzdG9wIHdvcmRzIHJlbW92ZWRcclxuICAgICAqL1xyXG4gICAgcHVibGljIHJlbW92ZVN0b3BXb3Jkcyh0b2tlbnM6IHN0cmluZ1tdKTogc3RyaW5nW10ge1xyXG4gICAgICAgIHJldHVybiB0b2tlbnMuZmlsdGVyKHRva2VuID0+ICF0aGlzLnN0b3BXb3Jkcy5oYXModG9rZW4pICYmIHRva2VuLmxlbmd0aCA+IDEpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQmFzaWMgc3RlbW1pbmcgYWxnb3JpdGhtIGZvciBFbmdsaXNoXHJcbiAgICAgKiBJbXBsZW1lbnRzIGEgc2ltcGxlIHZlcnNpb24gb2YgUG9ydGVyIHN0ZW1taW5nXHJcbiAgICAgKiBAcGFyYW0gdG9rZW5zIEFycmF5IG9mIHRva2Vuc1xyXG4gICAgICogQHJldHVybnMgQXJyYXkgb2Ygc3RlbW1lZCB0b2tlbnNcclxuICAgICAqL1xyXG4gICAgcHVibGljIHN0ZW1Xb3Jkcyh0b2tlbnM6IHN0cmluZ1tdKTogc3RyaW5nW10ge1xyXG4gICAgICAgIHJldHVybiB0b2tlbnMubWFwKHRva2VuID0+IHtcclxuICAgICAgICAgICAgLy8gQmFzaWMgc3RlbW1pbmcgcnVsZXMgKHNpbXBsaWZpZWQpXHJcbiAgICAgICAgICAgIGlmICh0b2tlbi5lbmRzV2l0aCgnaW5nJykpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0b2tlbi5zbGljZSgwLCAtMyk7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAodG9rZW4uZW5kc1dpdGgoJ2x5JykpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0b2tlbi5zbGljZSgwLCAtMik7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAodG9rZW4uZW5kc1dpdGgoJ3MnKSAmJiAhdG9rZW4uZW5kc1dpdGgoJ3NzJykpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0b2tlbi5zbGljZSgwLCAtMSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAodG9rZW4uZW5kc1dpdGgoJ2VkJykgJiYgdG9rZW4ubGVuZ3RoID4gNCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRva2VuLnNsaWNlKDAsIC0yKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0b2tlbjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogRXh0cmFjdCBwb3RlbnRpYWwgbmFtZWQgZW50aXRpZXMgZnJvbSB0ZXh0XHJcbiAgICAgKiBWZXJ5IHNpbXBsaWZpZWQgaW1wbGVtZW50YXRpb24gZm9yIHByb29mIG9mIGNvbmNlcHRcclxuICAgICAqIEBwYXJhbSB0ZXh0IElucHV0IHRleHRcclxuICAgICAqIEByZXR1cm5zIEFycmF5IG9mIHBvdGVudGlhbCBuYW1lZCBlbnRpdGllc1xyXG4gICAgICovXHJcbiAgICBwdWJsaWMgZXh0cmFjdE5hbWVkRW50aXRpZXModGV4dDogc3RyaW5nKTogc3RyaW5nW10ge1xyXG4gICAgICAgIGNvbnN0IHNlbnRlbmNlcyA9IHRleHQuc3BsaXQoL1suIT9dKy8pO1xyXG4gICAgICAgIGNvbnN0IGVudGl0aWVzOiBzdHJpbmdbXSA9IFtdO1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vU2ltcGxlIG5hbWVkIGVudGl0eSBkZXRlY3Rpb24gYmFzZWQgb24gY2FwaXRhbGl6YXRpb24gaS5lLiB0aGlzIGNoZWNrcyBmb3IgbmFtZXNcclxuICAgICAgICBmb3IgKGNvbnN0IHNlbnRlbmNlIG9mIHNlbnRlbmNlcykge1xyXG4gICAgICAgICAgICBjb25zdCB3b3JkcyA9IHNlbnRlbmNlLnRyaW0oKS5zcGxpdCgnICcpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB3b3Jkcy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgY29uc3Qgd29yZCA9IHdvcmRzW2ldO1xyXG4gICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAvL1NraXAgZmlyc3Qgd29yZCBvZiBzZW50ZW5jZSBhbmQgY2hlY2sgZm9yIGNhcGl0YWxpemF0aW9uXHJcbiAgICAgICAgICAgICAgICBpZiAoaSA+IDAgJiYgd29yZC5sZW5ndGggPiAxICYmIC9eW0EtWl1bYS16XSskLy50ZXN0KHdvcmQpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZW50aXRpZXMucHVzaCh3b3JkKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgLy9DaGVjayBmb3IgY29uc2VjdXRpdmUgY2FwaXRhbGl6ZWQgd29yZHMgKGNvbXBvdW5kIGVudGl0aWVzKVxyXG4gICAgICAgICAgICAgICAgaWYgKGkgPCB3b3Jkcy5sZW5ndGggLSAxICYmIFxyXG4gICAgICAgICAgICAgICAgICAgIHdvcmQubGVuZ3RoID4gMSAmJiBcclxuICAgICAgICAgICAgICAgICAgICAvXltBLVpdW2Etel0rJC8udGVzdCh3b3JkKSAmJiBcclxuICAgICAgICAgICAgICAgICAgICAvXltBLVpdW2Etel0rJC8udGVzdCh3b3Jkc1tpKzFdKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGVudGl0aWVzLnB1c2goYCR7d29yZH0gJHt3b3Jkc1tpKzFdfWApO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgIHJldHVybiBbLi4ubmV3IFNldChlbnRpdGllcyldOy8vUmVtb3ZlIGR1cGxpY2F0ZXNcclxuICAgIH1cclxufSIsICJpbXBvcnQgeyBDb25jZXB0RXh0cmFjdG9yIH0gZnJvbSAnc3JjL3V0aWxzL3R5cGVzJztcclxuaW1wb3J0IHsgVGV4dFByb2Nlc3NpbmdVdGlscyB9IGZyb20gJ3NyYy91dGlscy90ZXh0LXByb2Nlc3NpbmcnO1xyXG5cclxuLyoqXHJcbiAqIEltcGxlbWVudGF0aW9uIG9mIENvbmNlcHQgRXh0cmFjdGlvbiB1c2luZyBOTFAgdGVjaG5pcXVlc1xyXG4gKi9cclxuZXhwb3J0IGNsYXNzIENvbmNlcHRFeHRyYWN0b3JJbXBsIGltcGxlbWVudHMgQ29uY2VwdEV4dHJhY3RvciB7XHJcbiAgICBwcml2YXRlIHNlbnNpdGl2aXR5OiBudW1iZXIgPSA1OyAvL0RlZmF1bHQgc2Vuc2l0aXZpdHkgKDEtMTApXHJcbiAgICBwcml2YXRlIHRleHRQcm9jZXNzb3I6IFRleHRQcm9jZXNzaW5nVXRpbHM7XHJcbiAgICBwcml2YXRlIHVzZXJGZWVkYmFjazogTWFwPHN0cmluZywgYm9vbGVhbj4gPSBuZXcgTWFwKCk7IC8vU3RvcmUgdXNlciBmZWVkYmFjayBvbiBjb25jZXB0c1xyXG4gICAgXHJcbiAgICBjb25zdHJ1Y3RvcigpIHtcclxuICAgICAgICB0aGlzLnRleHRQcm9jZXNzb3IgPSBuZXcgVGV4dFByb2Nlc3NpbmdVdGlscygpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogRXh0cmFjdCBjb25jZXB0cyBmcm9tIHRleHQgY29udGVudFxyXG4gICAgICogQHBhcmFtIGNvbnRlbnQgVGV4dCBjb250ZW50IHRvIGFuYWx5emVcclxuICAgICAqIEByZXR1cm5zIEFycmF5IG9mIGV4dHJhY3RlZCBjb25jZXB0c1xyXG4gICAgICovXHJcbiAgICBwdWJsaWMgZXh0cmFjdENvbmNlcHRzKGNvbnRlbnQ6IHN0cmluZyk6IHN0cmluZ1tdIHtcclxuICAgICAgICAvL1NraXAgZW1wdHkgY29udGVudFxyXG4gICAgICAgIGlmICghY29udGVudCB8fCBjb250ZW50LnRyaW0oKSA9PT0gJycpIHtcclxuICAgICAgICAgICAgcmV0dXJuIFtdO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gRXh0cmFjdCBjb25jZXB0cyB1c2luZyBtdWx0aXBsZSB0ZWNobmlxdWVzXHJcbiAgICAgICAgY29uc3QgY29uY2VwdHM6IHN0cmluZ1tdID0gW1xyXG4gICAgICAgICAgICAuLi50aGlzLmV4dHJhY3RGcm9tVGZJZGYoY29udGVudCksXHJcbiAgICAgICAgICAgIC4uLnRoaXMuZXh0cmFjdEZyb21IZWFkaW5ncyhjb250ZW50KSxcclxuICAgICAgICAgICAgLi4udGhpcy5leHRyYWN0RnJvbUVtcGhhc2lzKGNvbnRlbnQpLFxyXG4gICAgICAgICAgICAuLi50aGlzLmV4dHJhY3RGcm9tTmFtZWRFbnRpdGllcyhjb250ZW50KVxyXG4gICAgICAgIF07XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy9BcHBseSB1c2VyIGZlZWRiYWNrXHJcbiAgICAgICAgY29uc3QgZmlsdGVyZWRDb25jZXB0cyA9IGNvbmNlcHRzLmZpbHRlcihjb25jZXB0ID0+IHtcclxuICAgICAgICAgICAgY29uc3QgZmVlZGJhY2sgPSB0aGlzLnVzZXJGZWVkYmFjay5nZXQoY29uY2VwdCk7XHJcbiAgICAgICAgICAgIC8vSWYgd2UgaGF2ZSBleHBsaWNpdCBuZWdhdGl2ZSBmZWVkYmFjaywgZmlsdGVyIGl0IG91dFxyXG4gICAgICAgICAgICBpZiAoZmVlZGJhY2sgPT09IGZhbHNlKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy9SZW1vdmUgZHVwbGljYXRlcyBhbmQgcmV0dXJuIHNvcnRlZCBieSBpbXBvcnRhbmNlXHJcbiAgICAgICAgcmV0dXJuIFsuLi5uZXcgU2V0KGZpbHRlcmVkQ29uY2VwdHMpXTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFNldCBzZW5zaXRpdml0eSBmb3IgZXh0cmFjdGlvbiAoMS0xMClcclxuICAgICAqIEBwYXJhbSBzZW5zaXRpdml0eSBTZW5zaXRpdml0eSBsZXZlbCAoMS0xMClcclxuICAgICAqL1xyXG4gICAgcHVibGljIHNldFNlbnNpdGl2aXR5KHNlbnNpdGl2aXR5OiBudW1iZXIpOiB2b2lkIHtcclxuICAgICAgICAvLyBFbnN1cmUgc2Vuc2l0aXZpdHkgaXMgd2l0aGluIHZhbGlkIHJhbmdlXHJcbiAgICAgICAgdGhpcy5zZW5zaXRpdml0eSA9IE1hdGgubWF4KDEsIE1hdGgubWluKDEwLCBzZW5zaXRpdml0eSkpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogTGVhcm4gZnJvbSB1c2VyIGZlZWRiYWNrIG9uIGNvbmNlcHQgcmVsZXZhbmNlXHJcbiAgICAgKiBAcGFyYW0gY29uY2VwdCBUaGUgY29uY2VwdCByZWNlaXZpbmcgZmVlZGJhY2tcclxuICAgICAqIEBwYXJhbSBpc1JlbGV2YW50IFdoZXRoZXIgdGhlIHVzZXIgbWFya2VkIGl0IGFzIHJlbGV2YW50XHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBsZWFybkZyb21Vc2VyRmVlZGJhY2soY29uY2VwdDogc3RyaW5nLCBpc1JlbGV2YW50OiBib29sZWFuKTogdm9pZCB7XHJcbiAgICAgICAgdGhpcy51c2VyRmVlZGJhY2suc2V0KGNvbmNlcHQsIGlzUmVsZXZhbnQpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogRXh0cmFjdCBjb25jZXB0cyB1c2luZyBURi1JREYgbGlrZSBhcHByb2FjaFxyXG4gICAgICogQHBhcmFtIGNvbnRlbnQgVGV4dCBjb250ZW50IHRvIGFuYWx5emVcclxuICAgICAqIEByZXR1cm5zIEFycmF5IG9mIGNvbmNlcHRzXHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgZXh0cmFjdEZyb21UZklkZihjb250ZW50OiBzdHJpbmcpOiBzdHJpbmdbXSB7XHJcbiAgICAgICAgLy9Ub2tlbml6ZSB0aGUgY29udGVudFxyXG4gICAgICAgIGNvbnN0IHRva2VucyA9IHRoaXMudGV4dFByb2Nlc3Nvci50b2tlbml6ZShjb250ZW50KTtcclxuICAgICAgICBcclxuICAgICAgICAvL3JlbW92ZSBzdG9wIHdvcmRzXHJcbiAgICAgICAgY29uc3QgZmlsdGVyZWRUb2tlbnMgPSB0aGlzLnRleHRQcm9jZXNzb3IucmVtb3ZlU3RvcFdvcmRzKHRva2Vucyk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy9jYWxjdWxhdGUgdGVybSBmcmVxdWVuY3lcclxuICAgICAgICBjb25zdCB0ZXJtRnJlcXVlbmN5ID0gdGhpcy50ZXh0UHJvY2Vzc29yLmNhbGN1bGF0ZVRlcm1GcmVxdWVuY3koZmlsdGVyZWRUb2tlbnMpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vc29ydCBieSBmcmVxdWVuY3kgYW5kIHRha2UgdG9wIE4gYmFzZWQgb24gc2Vuc2l0aXZpdHlcclxuICAgICAgICBjb25zdCB0aHJlc2hvbGQgPSBNYXRoLm1heCgyLCBNYXRoLmZsb29yKDIwIC8gKDExIC0gdGhpcy5zZW5zaXRpdml0eSkpKTtcclxuICAgICAgICBcclxuICAgICAgICAvL2NvbnZlcnQgdG8gYXJyYXkgYW5kIHNvcnQgYnkgZnJlcXVlbmN5XHJcbiAgICAgICAgY29uc3Qgc29ydGVkVGVybXMgPSBBcnJheS5mcm9tKHRlcm1GcmVxdWVuY3kuZW50cmllcygpKVxyXG4gICAgICAgICAgICAuZmlsdGVyKChbXywgZnJlcV0pID0+IGZyZXEgPj0gdGhyZXNob2xkKVxyXG4gICAgICAgICAgICAuc29ydCgoYSwgYikgPT4gYlsxXSAtIGFbMV0pXHJcbiAgICAgICAgICAgIC5zbGljZSgwLCB0aGlzLnNlbnNpdGl2aXR5ICogMykgLy90YWtlIG1vcmUgdGVybXMgd2l0aCBoaWdoZXIgc2Vuc2l0aXZpdHlcclxuICAgICAgICAgICAgLm1hcCgoW3Rlcm0sIF9dKSA9PiB0ZXJtKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgcmV0dXJuIHNvcnRlZFRlcm1zO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogRXh0cmFjdCBjb25jZXB0cyBmcm9tIG1hcmtkb3duIGhlYWRpbmdzXHJcbiAgICAgKiBAcGFyYW0gY29udGVudCBNYXJrZG93biBjb250ZW50XHJcbiAgICAgKiBAcmV0dXJucyBBcnJheSBvZiBjb25jZXB0cyBmcm9tIGhlYWRpbmdzXHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgZXh0cmFjdEZyb21IZWFkaW5ncyhjb250ZW50OiBzdHJpbmcpOiBzdHJpbmdbXSB7XHJcbiAgICAgICAgY29uc3QgaGVhZGluZ1JlZ2V4ID0gL14jK1xccysoLispJC9nbTtcclxuICAgICAgICBjb25zdCBoZWFkaW5nczogc3RyaW5nW10gPSBbXTtcclxuICAgICAgICBsZXQgbWF0Y2g7XHJcbiAgICAgICAgXHJcbiAgICAgICAgd2hpbGUgKChtYXRjaCA9IGhlYWRpbmdSZWdleC5leGVjKGNvbnRlbnQpKSAhPT0gbnVsbCkge1xyXG4gICAgICAgICAgICBoZWFkaW5ncy5wdXNoKG1hdGNoWzFdLnRyaW0oKSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgIHJldHVybiBoZWFkaW5ncztcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIEV4dHJhY3QgY29uY2VwdHMgZnJvbSBlbXBoYXNpemVkIHRleHQgKGJvbGQvaXRhbGljKVxyXG4gICAgICogQHBhcmFtIGNvbnRlbnQgTWFya2Rvd24gY29udGVudFxyXG4gICAgICogQHJldHVybnMgQXJyYXkgb2YgY29uY2VwdHMgZnJvbSBlbXBoYXNpemVkIHRleHRcclxuICAgICAqL1xyXG4gICAgcHJpdmF0ZSBleHRyYWN0RnJvbUVtcGhhc2lzKGNvbnRlbnQ6IHN0cmluZyk6IHN0cmluZ1tdIHtcclxuICAgICAgICBjb25zdCBlbXBoYXNpc1JlZ2V4ID0gLyhcXCpcXCp8X18pKC4qPylcXDF8KFxcKnxfKSguKj8pXFwzL2c7XHJcbiAgICAgICAgY29uc3QgZW1waGFzaXplZDogc3RyaW5nW10gPSBbXTtcclxuICAgICAgICBsZXQgbWF0Y2g7XHJcbiAgICAgICAgXHJcbiAgICAgICAgd2hpbGUgKChtYXRjaCA9IGVtcGhhc2lzUmVnZXguZXhlYyhjb250ZW50KSkgIT09IG51bGwpIHtcclxuICAgICAgICAgICAgY29uc3QgdGV4dCA9IG1hdGNoWzJdIHx8IG1hdGNoWzRdO1xyXG4gICAgICAgICAgICBpZiAodGV4dCAmJiB0ZXh0LnRyaW0oKS5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICBlbXBoYXNpemVkLnB1c2godGV4dC50cmltKCkpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgIHJldHVybiBlbXBoYXNpemVkO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogRXh0cmFjdCBuYW1lZCBlbnRpdGllcyBhcyBjb25jZXB0c1xyXG4gICAgICogQHBhcmFtIGNvbnRlbnQgVGV4dCBjb250ZW50XHJcbiAgICAgKiBAcmV0dXJucyBBcnJheSBvZiBuYW1lZCBlbnRpdGllc1xyXG4gICAgICovXHJcbiAgICBwcml2YXRlIGV4dHJhY3RGcm9tTmFtZWRFbnRpdGllcyhjb250ZW50OiBzdHJpbmcpOiBzdHJpbmdbXSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMudGV4dFByb2Nlc3Nvci5leHRyYWN0TmFtZWRFbnRpdGllcyhjb250ZW50KTtcclxuICAgIH1cclxufSIsICJpbXBvcnQgeyBDb25jZXB0R3JhcGgsIFJlbGF0ZWROb3RlIH0gZnJvbSAnLi4vdXRpbHMvdHlwZXMnO1xyXG5pbXBvcnQgeyBURmlsZSwgVmF1bHQgfSBmcm9tICdvYnNpZGlhbic7XHJcblxyXG4vKipcclxuICogU3RydWN0dXJlIHRvIHN0b3JlIG5vdGUgZGF0YSBpbiB0aGUgZ3JhcGhcclxuICovXHJcbmludGVyZmFjZSBOb3RlTm9kZSB7XHJcbiAgICBwYXRoOiBzdHJpbmc7XHJcbiAgICBjb25jZXB0czogc3RyaW5nW107XHJcbiAgICBsYXN0VXBkYXRlZDogbnVtYmVyO1xyXG59XHJcblxyXG4vKipcclxuICogU3RydWN0dXJlIHRvIHN0b3JlIGNvbmNlcHQgZGF0YSBpbiB0aGUgZ3JhcGhcclxuICovXHJcbmludGVyZmFjZSBDb25jZXB0Tm9kZSB7XHJcbiAgICBuYW1lOiBzdHJpbmc7XHJcbiAgICBub3RlUGF0aHM6IHN0cmluZ1tdO1xyXG4gICAgd2VpZ2h0OiBudW1iZXI7IC8vIENvbmNlcHQgaW1wb3J0YW5jZVxyXG59XHJcblxyXG4vKipcclxuICogSW1wbGVtZW50YXRpb24gb2YgdGhlIENvbmNlcHQgR3JhcGggdGhhdCBtYW5hZ2VzIHJlbGF0aW9uc2hpcHMgYmV0d2VlbiBub3Rlc1xyXG4gKi9cclxuZXhwb3J0IGNsYXNzIENvbmNlcHRHcmFwaEltcGwgaW1wbGVtZW50cyBDb25jZXB0R3JhcGgge1xyXG4gICAgcHJpdmF0ZSBub3RlczogTWFwPHN0cmluZywgTm90ZU5vZGU+ID0gbmV3IE1hcCgpO1xyXG4gICAgcHJpdmF0ZSBjb25jZXB0czogTWFwPHN0cmluZywgQ29uY2VwdE5vZGU+ID0gbmV3IE1hcCgpO1xyXG4gICAgcHJpdmF0ZSB2YXVsdDogVmF1bHQ7XHJcbiAgICBcclxuICAgIGNvbnN0cnVjdG9yKHZhdWx0OiBWYXVsdCkge1xyXG4gICAgICAgIHRoaXMudmF1bHQgPSB2YXVsdDtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIEFkZCBhIG5vdGUgdG8gdGhlIGdyYXBoIHdpdGggaXRzIGNvbmNlcHRzXHJcbiAgICAgKiBAcGFyYW0gcGF0aCBQYXRoIHRvIHRoZSBub3RlXHJcbiAgICAgKiBAcGFyYW0gY29uY2VwdHMgQXJyYXkgb2YgY29uY2VwdHMgaW4gdGhlIG5vdGVcclxuICAgICAqL1xyXG4gICAgcHVibGljIGFkZE5vdGUocGF0aDogc3RyaW5nLCBjb25jZXB0czogc3RyaW5nW10pOiB2b2lkIHtcclxuICAgICAgICAvLyBDcmVhdGUgb3IgdXBkYXRlIHRoZSBub3RlIG5vZGVcclxuICAgICAgICB0aGlzLm5vdGVzLnNldChwYXRoLCB7XHJcbiAgICAgICAgICAgIHBhdGgsXHJcbiAgICAgICAgICAgIGNvbmNlcHRzLFxyXG4gICAgICAgICAgICBsYXN0VXBkYXRlZDogRGF0ZS5ub3coKVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIFVwZGF0ZSBjb25jZXB0IG5vZGVzXHJcbiAgICAgICAgZm9yIChjb25zdCBjb25jZXB0IG9mIGNvbmNlcHRzKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGNvbmNlcHROb2RlID0gdGhpcy5jb25jZXB0cy5nZXQoY29uY2VwdCkgfHwge1xyXG4gICAgICAgICAgICAgICAgbmFtZTogY29uY2VwdCxcclxuICAgICAgICAgICAgICAgIG5vdGVQYXRoczogW10sXHJcbiAgICAgICAgICAgICAgICB3ZWlnaHQ6IDFcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIEFkZCB0aGlzIG5vdGUgdG8gdGhlIGNvbmNlcHQgaWYgbm90IGFscmVhZHkgcHJlc2VudFxyXG4gICAgICAgICAgICBpZiAoIWNvbmNlcHROb2RlLm5vdGVQYXRocy5pbmNsdWRlcyhwYXRoKSkge1xyXG4gICAgICAgICAgICAgICAgY29uY2VwdE5vZGUubm90ZVBhdGhzLnB1c2gocGF0aCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIFVwZGF0ZSB0aGUgY29uY2VwdCdzIHdlaWdodCBiYXNlZCBvbiBmcmVxdWVuY3lcclxuICAgICAgICAgICAgY29uY2VwdE5vZGUud2VpZ2h0ID0gY29uY2VwdE5vZGUubm90ZVBhdGhzLmxlbmd0aDtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIFNhdmUgdGhlIHVwZGF0ZWQgY29uY2VwdFxyXG4gICAgICAgICAgICB0aGlzLmNvbmNlcHRzLnNldChjb25jZXB0LCBjb25jZXB0Tm9kZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogUmVtb3ZlIGEgbm90ZSBmcm9tIHRoZSBncmFwaFxyXG4gICAgICogQHBhcmFtIHBhdGggUGF0aCB0byB0aGUgbm90ZSB0byByZW1vdmVcclxuICAgICAqL1xyXG4gICAgcHVibGljIHJlbW92ZU5vdGUocGF0aDogc3RyaW5nKTogdm9pZCB7XHJcbiAgICAgICAgLy8gR2V0IHRoZSBub3RlJ3MgY29uY2VwdHMgYmVmb3JlIHJlbW92YWxcclxuICAgICAgICBjb25zdCBub3RlID0gdGhpcy5ub3Rlcy5nZXQocGF0aCk7XHJcbiAgICAgICAgaWYgKCFub3RlKSB7XHJcbiAgICAgICAgICAgIHJldHVybjsgLy8gTm90ZSBkb2Vzbid0IGV4aXN0IGluIHRoZSBncmFwaFxyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICAvLyBSZW1vdmUgbm90ZSBmcm9tIGFsbCBpdHMgY29uY2VwdHNcclxuICAgICAgICBmb3IgKGNvbnN0IGNvbmNlcHQgb2Ygbm90ZS5jb25jZXB0cykge1xyXG4gICAgICAgICAgICBjb25zdCBjb25jZXB0Tm9kZSA9IHRoaXMuY29uY2VwdHMuZ2V0KGNvbmNlcHQpO1xyXG4gICAgICAgICAgICBpZiAoY29uY2VwdE5vZGUpIHtcclxuICAgICAgICAgICAgICAgIC8vIEZpbHRlciBvdXQgdGhpcyBub3RlIHBhdGhcclxuICAgICAgICAgICAgICAgIGNvbmNlcHROb2RlLm5vdGVQYXRocyA9IGNvbmNlcHROb2RlLm5vdGVQYXRocy5maWx0ZXIocCA9PiBwICE9PSBwYXRoKTtcclxuICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgLy8gVXBkYXRlIHdlaWdodFxyXG4gICAgICAgICAgICAgICAgY29uY2VwdE5vZGUud2VpZ2h0ID0gY29uY2VwdE5vZGUubm90ZVBhdGhzLmxlbmd0aDtcclxuICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgLy8gUmVtb3ZlIGNvbmNlcHQgaWYgaXQgbm8gbG9uZ2VyIGhhcyBhbnkgbm90ZXNcclxuICAgICAgICAgICAgICAgIGlmIChjb25jZXB0Tm9kZS5ub3RlUGF0aHMubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jb25jZXB0cy5kZWxldGUoY29uY2VwdCk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY29uY2VwdHMuc2V0KGNvbmNlcHQsIGNvbmNlcHROb2RlKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICAvLyBSZW1vdmUgdGhlIG5vdGUgaXRzZWxmXHJcbiAgICAgICAgdGhpcy5ub3Rlcy5kZWxldGUocGF0aCk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBGaW5kIG5vdGVzIHJlbGF0ZWQgdG8gYSBnaXZlbiBub3RlXHJcbiAgICAgKiBAcGFyYW0gbm90ZVBhdGggUGF0aCB0byB0aGUgbm90ZVxyXG4gICAgICogQHBhcmFtIG1heFJlc3VsdHMgTWF4aW11bSBudW1iZXIgb2YgcmVzdWx0cyB0byByZXR1cm5cclxuICAgICAqIEByZXR1cm5zIEFycmF5IG9mIHJlbGF0ZWQgbm90ZXMgc29ydGVkIGJ5IHJlbGV2YW5jZVxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgZmluZFJlbGF0ZWROb3Rlcyhub3RlUGF0aDogc3RyaW5nLCBtYXhSZXN1bHRzOiBudW1iZXIgPSAxMCk6IFJlbGF0ZWROb3RlW10ge1xyXG4gICAgICAgIGNvbnN0IG5vdGUgPSB0aGlzLm5vdGVzLmdldChub3RlUGF0aCk7XHJcbiAgICAgICAgaWYgKCFub3RlKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBbXTsgLy8gTm90ZSBkb2Vzbid0IGV4aXN0IGluIHRoZSBncmFwaFxyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICAvLyBDYWxjdWxhdGUgcmVsZXZhbmNlIHNjb3JlcyBmb3IgYWxsIG5vdGVzXHJcbiAgICAgICAgY29uc3Qgc2NvcmVzOiBNYXA8c3RyaW5nLCB7IFxyXG4gICAgICAgICAgICByZWxldmFuY2U6IG51bWJlciwgXHJcbiAgICAgICAgICAgIHNoYXJlZENvbmNlcHRzOiBzdHJpbmdbXSBcclxuICAgICAgICB9PiA9IG5ldyBNYXAoKTtcclxuICAgICAgICBcclxuICAgICAgICAvLyBJdGVyYXRlIHRocm91Z2ggY29uY2VwdHMgaW4gdGhlIHRhcmdldCBub3RlXHJcbiAgICAgICAgZm9yIChjb25zdCBjb25jZXB0IG9mIG5vdGUuY29uY2VwdHMpIHtcclxuICAgICAgICAgICAgY29uc3QgY29uY2VwdE5vZGUgPSB0aGlzLmNvbmNlcHRzLmdldChjb25jZXB0KTtcclxuICAgICAgICAgICAgaWYgKCFjb25jZXB0Tm9kZSkgY29udGludWU7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyBGb3IgZWFjaCBub3RlIHRoYXQgaGFzIHRoaXMgY29uY2VwdFxyXG4gICAgICAgICAgICBmb3IgKGNvbnN0IHJlbGF0ZWRQYXRoIG9mIGNvbmNlcHROb2RlLm5vdGVQYXRocykge1xyXG4gICAgICAgICAgICAgICAgLy8gU2tpcCB0aGUgb3JpZ2luYWwgbm90ZVxyXG4gICAgICAgICAgICAgICAgaWYgKHJlbGF0ZWRQYXRoID09PSBub3RlUGF0aCkgY29udGludWU7XHJcbiAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgIC8vIEdldCBvciBpbml0aWFsaXplIHNjb3JlIGRhdGFcclxuICAgICAgICAgICAgICAgIGNvbnN0IHNjb3JlRGF0YSA9IHNjb3Jlcy5nZXQocmVsYXRlZFBhdGgpIHx8IHsgXHJcbiAgICAgICAgICAgICAgICAgICAgcmVsZXZhbmNlOiAwLCBcclxuICAgICAgICAgICAgICAgICAgICBzaGFyZWRDb25jZXB0czogW10gXHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAvLyBJbmNyZW1lbnQgcmVsZXZhbmNlIHNjb3JlIGJhc2VkIG9uIGNvbmNlcHQgd2VpZ2h0XHJcbiAgICAgICAgICAgICAgICBzY29yZURhdGEucmVsZXZhbmNlICs9IGNvbmNlcHROb2RlLndlaWdodDtcclxuICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgLy8gQWRkIHRvIHNoYXJlZCBjb25jZXB0cyBpZiBub3QgYWxyZWFkeSB0aGVyZVxyXG4gICAgICAgICAgICAgICAgaWYgKCFzY29yZURhdGEuc2hhcmVkQ29uY2VwdHMuaW5jbHVkZXMoY29uY2VwdCkpIHtcclxuICAgICAgICAgICAgICAgICAgICBzY29yZURhdGEuc2hhcmVkQ29uY2VwdHMucHVzaChjb25jZXB0KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgc2NvcmVzLnNldChyZWxhdGVkUGF0aCwgc2NvcmVEYXRhKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICAvLyBDb252ZXJ0IHRvIGFycmF5IGFuZCBub3JtYWxpemUgc2NvcmVzXHJcbiAgICAgICAgY29uc3QgcmVsYXRlZE5vdGVzOiBSZWxhdGVkTm90ZVtdID0gW107XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gRmluZCBtYXhpbXVtIHNjb3JlIGZvciBub3JtYWxpemF0aW9uXHJcbiAgICAgICAgY29uc3QgbWF4U2NvcmUgPSBNYXRoLm1heCguLi5BcnJheS5mcm9tKHNjb3Jlcy52YWx1ZXMoKSlcclxuICAgICAgICAgICAgLm1hcChkYXRhID0+IGRhdGEucmVsZXZhbmNlKSwgMSk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gQ29udmVydCBzY29yZXMgdG8gUmVsYXRlZE5vdGUgb2JqZWN0c1xyXG4gICAgICAgIGZvciAoY29uc3QgW3BhdGgsIGRhdGFdIG9mIHNjb3Jlcy5lbnRyaWVzKCkpIHtcclxuICAgICAgICAgICAgLy8gR2V0IHRoZSBmaWxlIGZyb20gdmF1bHRcclxuICAgICAgICAgICAgY29uc3QgZmlsZSA9IHRoaXMudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKHBhdGgpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgLy8gU2tpcCBpZiBmaWxlIGRvZXNuJ3QgZXhpc3Qgb3IgaXNuJ3QgYSBURmlsZVxyXG4gICAgICAgICAgICBpZiAoIWZpbGUgfHwgIShmaWxlIGluc3RhbmNlb2YgVEZpbGUpKSBjb250aW51ZTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIHJlbGF0ZWROb3Rlcy5wdXNoKHtcclxuICAgICAgICAgICAgICAgIGZpbGU6IGZpbGUgYXMgVEZpbGUsXHJcbiAgICAgICAgICAgICAgICByZWxldmFuY2U6IGRhdGEucmVsZXZhbmNlIC8gbWF4U2NvcmUsIC8vIE5vcm1hbGl6ZSB0byAwLTFcclxuICAgICAgICAgICAgICAgIHNoYXJlZENvbmNlcHRzOiBkYXRhLnNoYXJlZENvbmNlcHRzXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICAvLyBTb3J0IGJ5IHJlbGV2YW5jZSAoaGlnaGVzdCBmaXJzdCkgYW5kIGxpbWl0IHJlc3VsdHNcclxuICAgICAgICByZXR1cm4gcmVsYXRlZE5vdGVzXHJcbiAgICAgICAgICAgIC5zb3J0KChhLCBiKSA9PiBiLnJlbGV2YW5jZSAtIGEucmVsZXZhbmNlKVxyXG4gICAgICAgICAgICAuc2xpY2UoMCwgbWF4UmVzdWx0cyk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBHZXQgYWxsIGNvbmNlcHRzIGZvciBhIG5vdGVcclxuICAgICAqIEBwYXJhbSBub3RlUGF0aCBQYXRoIHRvIHRoZSBub3RlXHJcbiAgICAgKiBAcmV0dXJucyBBcnJheSBvZiBjb25jZXB0c1xyXG4gICAgICovXHJcbiAgICBwdWJsaWMgZ2V0Tm90ZUNvbmNlcHRzKG5vdGVQYXRoOiBzdHJpbmcpOiBzdHJpbmdbXSB7XHJcbiAgICAgICAgY29uc3Qgbm90ZSA9IHRoaXMubm90ZXMuZ2V0KG5vdGVQYXRoKTtcclxuICAgICAgICByZXR1cm4gbm90ZSA/IG5vdGUuY29uY2VwdHMgOiBbXTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIEdldCBncmFwaCBkYXRhIGZvciB2aXN1YWxpemF0aW9uXHJcbiAgICAgKiBAcmV0dXJucyBPYmplY3Qgd2l0aCBub2RlcyBhbmQgZWRnZXMgYXJyYXlzIGZvciB2aXN1YWxpemF0aW9uXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBnZXRDb25jZXB0TmV0d29yaygpOiB7IG5vZGVzOiBhbnlbXSwgZWRnZXM6IGFueVtdIH0ge1xyXG4gICAgICAgIGNvbnN0IG5vZGVzOiBhbnlbXSA9IFtdO1xyXG4gICAgICAgIGNvbnN0IGVkZ2VzOiBhbnlbXSA9IFtdO1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIEFkZCBub3RlIG5vZGVzXHJcbiAgICAgICAgZm9yIChjb25zdCBbcGF0aCwgbm90ZV0gb2YgdGhpcy5ub3Rlcy5lbnRyaWVzKCkpIHtcclxuICAgICAgICAgICAgbm9kZXMucHVzaCh7XHJcbiAgICAgICAgICAgICAgICBpZDogcGF0aCxcclxuICAgICAgICAgICAgICAgIGxhYmVsOiBwYXRoLnNwbGl0KCcvJykucG9wKCkgfHwgcGF0aCwgLy8gVXNlIGZpbGVuYW1lIGFzIGxhYmVsXHJcbiAgICAgICAgICAgICAgICB0eXBlOiAnbm90ZSdcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIEFkZCBjb25jZXB0IG5vZGVzIChmb3IgY29uY2VwdHMgdGhhdCBhcHBlYXIgaW4gbXVsdGlwbGUgbm90ZXMpXHJcbiAgICAgICAgZm9yIChjb25zdCBbbmFtZSwgY29uY2VwdF0gb2YgdGhpcy5jb25jZXB0cy5lbnRyaWVzKCkpIHtcclxuICAgICAgICAgICAgaWYgKGNvbmNlcHQubm90ZVBhdGhzLmxlbmd0aCA+IDEpIHtcclxuICAgICAgICAgICAgICAgIG5vZGVzLnB1c2goe1xyXG4gICAgICAgICAgICAgICAgICAgIGlkOiBgY29uY2VwdC0ke25hbWV9YCxcclxuICAgICAgICAgICAgICAgICAgICBsYWJlbDogbmFtZSxcclxuICAgICAgICAgICAgICAgICAgICB0eXBlOiAnY29uY2VwdCcsXHJcbiAgICAgICAgICAgICAgICAgICAgd2VpZ2h0OiBjb25jZXB0LndlaWdodFxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgIC8vIEFkZCBlZGdlcyBmcm9tIGNvbmNlcHQgdG8gbm90ZXNcclxuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgcGF0aCBvZiBjb25jZXB0Lm5vdGVQYXRocykge1xyXG4gICAgICAgICAgICAgICAgICAgIGVkZ2VzLnB1c2goe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzb3VyY2U6IGBjb25jZXB0LSR7bmFtZX1gLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXQ6IHBhdGgsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiAxXHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgcmV0dXJuIHsgbm9kZXMsIGVkZ2VzIH07XHJcbiAgICB9XHJcbn0iLCAiaW1wb3J0IHsgRGF0YU1hbmFnZXIgfSBmcm9tICcuLi91dGlscy90eXBlcyc7XHJcbmltcG9ydCB7IFBsdWdpbiB9IGZyb20gJ29ic2lkaWFuJztcclxuXHJcbi8qKlxyXG4gKiBJbnRlcmZhY2UgZm9yIHBlcnNpc3RlbnQgZGF0YSBzdG9yYWdlXHJcbiAqL1xyXG5pbnRlcmZhY2UgQ29uY2VwdERhdGEge1xyXG4gICAgdmVyc2lvbjogbnVtYmVyO1xyXG4gICAgbm90ZXM6IFJlY29yZDxzdHJpbmcsIHtcclxuICAgICAgICBjb25jZXB0czogc3RyaW5nW107XHJcbiAgICAgICAgbGFzdFVwZGF0ZWQ6IG51bWJlcjtcclxuICAgIH0+O1xyXG4gICAgY29uY2VwdHM6IFJlY29yZDxzdHJpbmcsIHtcclxuICAgICAgICBub3RlUGF0aHM6IHN0cmluZ1tdO1xyXG4gICAgICAgIHdlaWdodDogbnVtYmVyO1xyXG4gICAgfT47XHJcbiAgICB1c2VyRmVlZGJhY2s6IFJlY29yZDxzdHJpbmcsIGJvb2xlYW4+O1xyXG59XHJcblxyXG4vKipcclxuICogSW1wbGVtZW50YXRpb24gb2YgZGF0YSBwZXJzaXN0ZW5jZSBmb3IgY29uY2VwdHMgYW5kIHJlbGF0aW9uc2hpcHNcclxuICovXHJcbmV4cG9ydCBjbGFzcyBEYXRhTWFuYWdlckltcGwgaW1wbGVtZW50cyBEYXRhTWFuYWdlciB7XHJcbiAgICBwcml2YXRlIHBsdWdpbjogUGx1Z2luO1xyXG4gICAgcHJpdmF0ZSBkYXRhOiBDb25jZXB0RGF0YTtcclxuICAgIFxyXG4gICAgLy8gQ3VycmVudCBkYXRhIHZlcnNpb24gZm9yIG1pZ3JhdGlvbiBzdXBwb3J0XHJcbiAgICBwcml2YXRlIHJlYWRvbmx5IENVUlJFTlRfVkVSU0lPTiA9IDE7XHJcbiAgICBcclxuICAgIGNvbnN0cnVjdG9yKHBsdWdpbjogUGx1Z2luKSB7XHJcbiAgICAgICAgdGhpcy5wbHVnaW4gPSBwbHVnaW47XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gSW5pdGlhbGl6ZSB3aXRoIGVtcHR5IGRhdGFcclxuICAgICAgICB0aGlzLmRhdGEgPSB7XHJcbiAgICAgICAgICAgIHZlcnNpb246IHRoaXMuQ1VSUkVOVF9WRVJTSU9OLFxyXG4gICAgICAgICAgICBub3Rlczoge30sXHJcbiAgICAgICAgICAgIGNvbmNlcHRzOiB7fSxcclxuICAgICAgICAgICAgdXNlckZlZWRiYWNrOiB7fVxyXG4gICAgICAgIH07XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBTYXZlIGNvbmNlcHQgZGF0YSB0byBkaXNrXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBhc3luYyBzYXZlQ29uY2VwdERhdGEoKTogUHJvbWlzZTx2b2lkPiB7XHJcbiAgICAgICAgLy8gSW4gT2JzaWRpYW4gUGx1Z2luIEFQSSwgc2F2ZURhdGEgdGFrZXMgb25seSBvbmUgYXJndW1lbnQ6IHRoZSBkYXRhIHRvIHNhdmVcclxuICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlRGF0YSh0aGlzLmRhdGEpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogTG9hZCBjb25jZXB0IGRhdGEgZnJvbSBkaXNrXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBhc3luYyBsb2FkQ29uY2VwdERhdGEoKTogUHJvbWlzZTx2b2lkPiB7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgLy8gbG9hZERhdGEgZG9lc24ndCB0YWtlIGFyZ3VtZW50cyBpbiB0aGUgT2JzaWRpYW4gUGx1Z2luIEFQSVxyXG4gICAgICAgICAgICBjb25zdCBzYXZlZERhdGEgPSBhd2FpdCB0aGlzLnBsdWdpbi5sb2FkRGF0YSgpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgLy8gSWYgbm8gZGF0YSBleGlzdHMgeWV0LCBrZWVwIHRoZSBkZWZhdWx0IGVtcHR5IGRhdGFcclxuICAgICAgICAgICAgaWYgKCFzYXZlZERhdGEpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgLy8gQ2hlY2sgaWYgZGF0YSBtaWdyYXRpb24gaXMgbmVlZGVkXHJcbiAgICAgICAgICAgIGlmIChzYXZlZERhdGEudmVyc2lvbiAhPT0gdGhpcy5DVVJSRU5UX1ZFUlNJT04pIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuZGF0YSA9IHRoaXMubWlncmF0ZURhdGEoc2F2ZWREYXRhKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuZGF0YSA9IHNhdmVkRGF0YTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0ZhaWxlZCB0byBsb2FkIGNvbmNlcHQgZGF0YTonLCBlcnJvcik7XHJcbiAgICAgICAgICAgIC8vIEtlZXAgdXNpbmcgdGhlIGRlZmF1bHQgZW1wdHkgZGF0YVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIENsZWFyIGFsbCBzdG9yZWQgZGF0YVxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgYXN5bmMgY2xlYXJEYXRhKCk6IFByb21pc2U8dm9pZD4ge1xyXG4gICAgICAgIHRoaXMuZGF0YSA9IHtcclxuICAgICAgICAgICAgdmVyc2lvbjogdGhpcy5DVVJSRU5UX1ZFUlNJT04sXHJcbiAgICAgICAgICAgIG5vdGVzOiB7fSxcclxuICAgICAgICAgICAgY29uY2VwdHM6IHt9LFxyXG4gICAgICAgICAgICB1c2VyRmVlZGJhY2s6IHt9XHJcbiAgICAgICAgfTtcclxuICAgICAgICBcclxuICAgICAgICBhd2FpdCB0aGlzLnNhdmVDb25jZXB0RGF0YSgpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogR2V0IHRoZSBsb2FkZWQgZGF0YVxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgZ2V0RGF0YSgpOiBDb25jZXB0RGF0YSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZGF0YTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFNldCB0aGUgZGF0YSAodXNlZCB3aGVuIHVwZGF0aW5nIGZyb20gdGhlIGNvbmNlcHQgZ3JhcGgpXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBzZXREYXRhKFxyXG4gICAgICAgIG5vdGVzOiBSZWNvcmQ8c3RyaW5nLCB7IGNvbmNlcHRzOiBzdHJpbmdbXSwgbGFzdFVwZGF0ZWQ6IG51bWJlciB9PixcclxuICAgICAgICBjb25jZXB0czogUmVjb3JkPHN0cmluZywgeyBub3RlUGF0aHM6IHN0cmluZ1tdLCB3ZWlnaHQ6IG51bWJlciB9PixcclxuICAgICAgICB1c2VyRmVlZGJhY2s6IFJlY29yZDxzdHJpbmcsIGJvb2xlYW4+XHJcbiAgICApOiB2b2lkIHtcclxuICAgICAgICB0aGlzLmRhdGEgPSB7XHJcbiAgICAgICAgICAgIHZlcnNpb246IHRoaXMuQ1VSUkVOVF9WRVJTSU9OLFxyXG4gICAgICAgICAgICBub3RlcyxcclxuICAgICAgICAgICAgY29uY2VwdHMsXHJcbiAgICAgICAgICAgIHVzZXJGZWVkYmFja1xyXG4gICAgICAgIH07XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBNaWdyYXRlIGRhdGEgZnJvbSBhbiBvbGRlciB2ZXJzaW9uIHRvIHRoZSBjdXJyZW50IHZlcnNpb25cclxuICAgICAqL1xyXG4gICAgcHJpdmF0ZSBtaWdyYXRlRGF0YShvbGREYXRhOiBhbnkpOiBDb25jZXB0RGF0YSB7XHJcbiAgICAgICAgLy8gVGhpcyBpcyBhIHBsYWNlaG9sZGVyIGZvciBmdXR1cmUgbWlncmF0aW9uc1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHZlcnNpb246IHRoaXMuQ1VSUkVOVF9WRVJTSU9OLFxyXG4gICAgICAgICAgICBub3Rlczogb2xkRGF0YS5ub3RlcyB8fCB7fSxcclxuICAgICAgICAgICAgY29uY2VwdHM6IG9sZERhdGEuY29uY2VwdHMgfHwge30sXHJcbiAgICAgICAgICAgIHVzZXJGZWVkYmFjazogb2xkRGF0YS51c2VyRmVlZGJhY2sgfHwge31cclxuICAgICAgICB9O1xyXG4gICAgfVxyXG59IiwgImltcG9ydCB7IFRGaWxlLCBWYXVsdCwgTm90aWNlIH0gZnJvbSAnb2JzaWRpYW4nO1xyXG5pbXBvcnQgeyBDb25jZXB0RXh0cmFjdG9yLCBDb25jZXB0R3JhcGgsIE5vdGVQcm9jZXNzb3JTZXJ2aWNlIH0gZnJvbSAnLi4vdXRpbHMvdHlwZXMnO1xyXG5cclxuLyoqXHJcbiAqIFNlcnZpY2UgdG8gaGFuZGxlIG5vdGUgcHJvY2Vzc2luZyBmb3IgY29uY2VwdCBleHRyYWN0aW9uIGFuZCByZWxhdGlvbnNoaXAgdHJhY2tpbmdcclxuICovXHJcbmV4cG9ydCBjbGFzcyBOb3RlUHJvY2Vzc29yIGltcGxlbWVudHMgTm90ZVByb2Nlc3NvclNlcnZpY2Uge1xyXG4gICAgLy8gS2VlcCB0cmFjayBvZiBwcm9jZXNzZWQgZmlsZXMgdG8gYXZvaWQgcmVkdW5kYW50IHByb2Nlc3NpbmdcclxuICAgIHByaXZhdGUgcHJvY2Vzc2VkRmlsZXM6IE1hcDxzdHJpbmcsIG51bWJlcj4gPSBuZXcgTWFwKCk7IC8vIHBhdGggLT4gbGFzdE1vZGlmaWVkXHJcbiAgICBcclxuICAgIGNvbnN0cnVjdG9yKFxyXG4gICAgICAgIHByaXZhdGUgdmF1bHQ6IFZhdWx0LFxyXG4gICAgICAgIHByaXZhdGUgY29uY2VwdEV4dHJhY3RvcjogQ29uY2VwdEV4dHJhY3RvcixcclxuICAgICAgICBwcml2YXRlIGNvbmNlcHRHcmFwaDogQ29uY2VwdEdyYXBoLFxyXG4gICAgICAgIHByaXZhdGUgc2F2ZUNhbGxiYWNrOiAoKSA9PiBQcm9taXNlPHZvaWQ+XHJcbiAgICApIHt9XHJcbiAgICBcclxuICAgIC8qKlxyXG4gICAgICogUHJvY2VzcyBhIHNpbmdsZSBub3RlIGZpbGVcclxuICAgICAqIEBwYXJhbSBmaWxlIE5vdGUgZmlsZSB0byBwcm9jZXNzXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBhc3luYyBwcm9jZXNzTm90ZShmaWxlOiBURmlsZSk6IFByb21pc2U8dm9pZD4ge1xyXG4gICAgICAgIC8vIFNraXAgaWYgZmlsZSB3YXMgcmVjZW50bHkgcHJvY2Vzc2VkIChvcHRpbWl6YXRpb24pXHJcbiAgICAgICAgaWYgKCF0aGlzLnNob3VsZFByb2Nlc3NOb3RlKGZpbGUpKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgLy8gUmVhZCB0aGUgZmlsZSBjb250ZW50XHJcbiAgICAgICAgICAgIGNvbnN0IGNvbnRlbnQgPSBhd2FpdCB0aGlzLnZhdWx0LnJlYWQoZmlsZSk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyBFeHRyYWN0IGNvbmNlcHRzXHJcbiAgICAgICAgICAgIGNvbnN0IGNvbmNlcHRzID0gdGhpcy5jb25jZXB0RXh0cmFjdG9yLmV4dHJhY3RDb25jZXB0cyhjb250ZW50KTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIEFkZCB0byBjb25jZXB0IGdyYXBoXHJcbiAgICAgICAgICAgIHRoaXMuY29uY2VwdEdyYXBoLmFkZE5vdGUoZmlsZS5wYXRoLCBjb25jZXB0cyk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyBNYXJrIGFzIHByb2Nlc3NlZFxyXG4gICAgICAgICAgICB0aGlzLnByb2Nlc3NlZEZpbGVzLnNldChmaWxlLnBhdGgsIGZpbGUuc3RhdC5tdGltZSk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyBTYXZlIGNoYW5nZXNcclxuICAgICAgICAgICAgYXdhaXQgdGhpcy5zYXZlQ2FsbGJhY2soKTtcclxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKGBFcnJvciBwcm9jZXNzaW5nIGZpbGUgJHtmaWxlLnBhdGh9OmAsIGVycm9yKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8qKlxyXG4gICAgICogQ2hlY2sgaWYgYSBmaWxlIG5lZWRzIHByb2Nlc3NpbmdcclxuICAgICAqIEBwYXJhbSBmaWxlIEZpbGUgdG8gY2hlY2tcclxuICAgICAqIEByZXR1cm5zIHRydWUgaWYgZmlsZSBuZWVkcyBwcm9jZXNzaW5nLCBmYWxzZSBvdGhlcndpc2VcclxuICAgICAqL1xyXG4gICAgcHVibGljIHNob3VsZFByb2Nlc3NOb3RlKGZpbGU6IFRGaWxlKTogYm9vbGVhbiB7XHJcbiAgICAgICAgLy8gU2tpcCBub24tbWFya2Rvd24gZmlsZXNcclxuICAgICAgICBpZiAoZmlsZS5leHRlbnNpb24gIT09ICdtZCcpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICBjb25zdCBsYXN0TW9kaWZpZWQgPSBmaWxlLnN0YXQubXRpbWU7XHJcbiAgICAgICAgY29uc3QgbGFzdFByb2Nlc3NlZCA9IHRoaXMucHJvY2Vzc2VkRmlsZXMuZ2V0KGZpbGUucGF0aCk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gUHJvY2VzcyBpZiBuZXZlciBwcm9jZXNzZWQgb3IgbW9kaWZpZWQgc2luY2UgbGFzdCBwcm9jZXNzaW5nXHJcbiAgICAgICAgcmV0dXJuICFsYXN0UHJvY2Vzc2VkIHx8IGxhc3RQcm9jZXNzZWQgPCBsYXN0TW9kaWZpZWQ7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8qKlxyXG4gICAgICogUHJvY2VzcyBhbGwgbm90ZXMgaW4gdGhlIHZhdWx0XHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBhc3luYyBwcm9jZXNzQWxsTm90ZXMoKTogUHJvbWlzZTx2b2lkPiB7XHJcbiAgICAgICAgY29uc3QgZmlsZXMgPSB0aGlzLnZhdWx0LmdldE1hcmtkb3duRmlsZXMoKTtcclxuICAgICAgICBsZXQgcHJvY2Vzc2VkQ291bnQgPSAwO1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIFNob3cgbm90aWNlXHJcbiAgICAgICAgY29uc3Qgbm90aWNlID0gbmV3IE5vdGljZShgUHJvY2Vzc2luZyAke2ZpbGVzLmxlbmd0aH0gbm90ZXMuLi5gLCAwKTtcclxuICAgICAgICBcclxuICAgICAgICBmb3IgKGNvbnN0IGZpbGUgb2YgZmlsZXMpIHtcclxuICAgICAgICAgICAgYXdhaXQgdGhpcy5wcm9jZXNzTm90ZShmaWxlKTtcclxuICAgICAgICAgICAgcHJvY2Vzc2VkQ291bnQrKztcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIFVwZGF0ZSBub3RpY2UgcGVyaW9kaWNhbGx5XHJcbiAgICAgICAgICAgIGlmIChwcm9jZXNzZWRDb3VudCAlIDEwID09PSAwKSB7XHJcbiAgICAgICAgICAgICAgICBub3RpY2Uuc2V0TWVzc2FnZShgUHJvY2Vzc2VkICR7cHJvY2Vzc2VkQ291bnR9LyR7ZmlsZXMubGVuZ3RofSBub3Rlcy4uLmApO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIFNhdmUgZGF0YSB3aGVuIGNvbXBsZXRlXHJcbiAgICAgICAgYXdhaXQgdGhpcy5zYXZlQ2FsbGJhY2soKTtcclxuICAgICAgICBcclxuICAgICAgICAvLyBDbG9zZSBub3RpY2VcclxuICAgICAgICBub3RpY2UuaGlkZSgpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIFNob3cgY29tcGxldGlvbiBub3RpY2VcclxuICAgICAgICBuZXcgTm90aWNlKGBDb21wbGV0ZWQgcHJvY2Vzc2luZyAke3Byb2Nlc3NlZENvdW50fSBub3Rlcy5gKTtcclxuICAgIH1cclxufSIsICJpbXBvcnQgeyBBcHAsIFRGaWxlLCBOb3RpY2UgfSBmcm9tICdvYnNpZGlhbic7XHJcbmltcG9ydCB7IFN1bW1hcnlHZW5lcmF0b3JTZXJ2aWNlLCBSZWxhdGVkTm90ZSwgQ29uY2VwdEdyYXBoIH0gZnJvbSAnLi4vdXRpbHMvdHlwZXMnO1xyXG5cclxuLyoqXHJcbiAqIFNlcnZpY2UgdG8gZ2VuZXJhdGUgc3VtbWFyaWVzIGZyb20gcmVsYXRlZCBub3Rlc1xyXG4gKi9cclxuZXhwb3J0IGNsYXNzIFN1bW1hcnlHZW5lcmF0b3IgaW1wbGVtZW50cyBTdW1tYXJ5R2VuZXJhdG9yU2VydmljZSB7XHJcbiAgICBjb25zdHJ1Y3RvcihcclxuICAgICAgICBwcml2YXRlIGFwcDogQXBwLFxyXG4gICAgICAgIHByaXZhdGUgY29uY2VwdEdyYXBoOiBDb25jZXB0R3JhcGgsXHJcbiAgICAgICAgcHJpdmF0ZSBnZXRSZWxhdGVkTm90ZXM6IChmaWxlOiBURmlsZSkgPT4gUHJvbWlzZTxSZWxhdGVkTm90ZVtdPlxyXG4gICAgKSB7fVxyXG4gICAgXHJcbiAgICAvKipcclxuICAgICAqIEdlbmVyYXRlIGEgc3VtbWFyeSBmcm9tIHJlbGF0ZWQgbm90ZXNcclxuICAgICAqIEBwYXJhbSBmaWxlIEZpbGUgdG8gZ2VuZXJhdGUgc3VtbWFyeSBmb3JcclxuICAgICAqIEByZXR1cm5zIFRoZSBjb250ZW50IG9mIHRoZSBnZW5lcmF0ZWQgc3VtbWFyeVxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgYXN5bmMgZ2VuZXJhdGVTdW1tYXJ5KGZpbGU6IFRGaWxlKTogUHJvbWlzZTxzdHJpbmc+IHtcclxuICAgICAgICAvLyBHZXQgcmVsYXRlZCBub3Rlc1xyXG4gICAgICAgIGNvbnN0IHJlbGF0ZWROb3RlcyA9IGF3YWl0IHRoaXMuZ2V0UmVsYXRlZE5vdGVzKGZpbGUpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIGlmIChyZWxhdGVkTm90ZXMubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgICAgICAgIG5ldyBOb3RpY2UoJ05vIHJlbGF0ZWQgbm90ZXMgZm91bmQgdG8gZ2VuZXJhdGUgc3VtbWFyeScpO1xyXG4gICAgICAgICAgICByZXR1cm4gJyc7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIENyZWF0ZSBhIG5ldyBub3RlIHdpdGggc3VtbWFyeVxyXG4gICAgICAgIGNvbnN0IHN1bW1hcnlUaXRsZSA9IGBTdW1tYXJ5IG9mICR7ZmlsZS5iYXNlbmFtZX1gO1xyXG4gICAgICAgIGxldCBzdW1tYXJ5Q29udGVudCA9IGAjICR7c3VtbWFyeVRpdGxlfVxcblxcbmA7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gQWRkIG1ldGFkYXRhXHJcbiAgICAgICAgc3VtbWFyeUNvbnRlbnQgKz0gYD4gWyFpbmZvXSBTdW1tYXJ5IGdlbmVyYXRlZCBmcm9tICR7ZmlsZS5iYXNlbmFtZX0gYW5kICR7cmVsYXRlZE5vdGVzLmxlbmd0aH0gcmVsYXRlZCBub3Rlc1xcbmA7XHJcbiAgICAgICAgc3VtbWFyeUNvbnRlbnQgKz0gYD4gR2VuZXJhdGVkIG9uICR7bmV3IERhdGUoKS50b0xvY2FsZVN0cmluZygpfVxcblxcbmA7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gQWRkIG9yaWdpbmFsIG5vdGUgc3VtbWFyeVxyXG4gICAgICAgIGNvbnN0IG9yaWdpbmFsQ29udGVudCA9IGF3YWl0IHRoaXMuYXBwLnZhdWx0LnJlYWQoZmlsZSk7XHJcbiAgICAgICAgc3VtbWFyeUNvbnRlbnQgKz0gYCMjIE9yaWdpbmFsIE5vdGU6ICR7ZmlsZS5iYXNlbmFtZX1cXG5cXG5gO1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIEV4dHJhY3QgdGhlIGZpcnN0IGZldyBzZW50ZW5jZXMgYXMgYSBzdW1tYXJ5IChzaW1wbGlmaWVkKVxyXG4gICAgICAgIGNvbnN0IGZpcnN0UGFyYWdyYXBoID0gb3JpZ2luYWxDb250ZW50LnNwbGl0KCdcXG5cXG4nKVswXTtcclxuICAgICAgICBzdW1tYXJ5Q29udGVudCArPSBgJHtmaXJzdFBhcmFncmFwaH1cXG5cXG5gO1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIEFkZCBrZXkgY29uY2VwdHMgc2VjdGlvblxyXG4gICAgICAgIGNvbnN0IGNvbmNlcHRzID0gdGhpcy5jb25jZXB0R3JhcGguZ2V0Tm90ZUNvbmNlcHRzKGZpbGUucGF0aCk7XHJcbiAgICAgICAgaWYgKGNvbmNlcHRzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgc3VtbWFyeUNvbnRlbnQgKz0gYCMjIEtleSBDb25jZXB0c1xcblxcbmA7XHJcbiAgICAgICAgICAgIHN1bW1hcnlDb250ZW50ICs9IGNvbmNlcHRzLm1hcChjID0+IGAtICR7Y31gKS5qb2luKCdcXG4nKTtcclxuICAgICAgICAgICAgc3VtbWFyeUNvbnRlbnQgKz0gYFxcblxcbmA7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIEFkZCByZWxhdGVkIG5vdGVzXHJcbiAgICAgICAgc3VtbWFyeUNvbnRlbnQgKz0gYCMjIFJlbGF0ZWQgTm90ZXNcXG5cXG5gO1xyXG4gICAgICAgIFxyXG4gICAgICAgIGZvciAoY29uc3QgcmVsYXRlZCBvZiByZWxhdGVkTm90ZXMpIHtcclxuICAgICAgICAgICAgc3VtbWFyeUNvbnRlbnQgKz0gYCMjIyAke3JlbGF0ZWQuZmlsZS5iYXNlbmFtZX1cXG5cXG5gO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgLy8gQWRkIHNoYXJlZCBjb25jZXB0c1xyXG4gICAgICAgICAgICBpZiAocmVsYXRlZC5zaGFyZWRDb25jZXB0cy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICBzdW1tYXJ5Q29udGVudCArPSBgU2hhcmVkIGNvbmNlcHRzOiAke3JlbGF0ZWQuc2hhcmVkQ29uY2VwdHMuam9pbignLCAnKX1cXG5cXG5gO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyBBZGQgc25pcHBldCBmcm9tIHJlbGF0ZWQgbm90ZVxyXG4gICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgcmVsYXRlZENvbnRlbnQgPSBhd2FpdCB0aGlzLmFwcC52YXVsdC5yZWFkKHJlbGF0ZWQuZmlsZSk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBmaXJzdFBhcmFncmFwaCA9IHJlbGF0ZWRDb250ZW50LnNwbGl0KCdcXG5cXG4nKVswXTtcclxuICAgICAgICAgICAgICAgIHN1bW1hcnlDb250ZW50ICs9IGAke2ZpcnN0UGFyYWdyYXBofVxcblxcbmA7XHJcbiAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgICAgICAgICBzdW1tYXJ5Q29udGVudCArPSBgRXJyb3IgcmVhZGluZyBub3RlIGNvbnRlbnQuXFxuXFxuYDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgLy8gQWRkIGxpbmsgdG8gdGhlIG5vdGVcclxuICAgICAgICAgICAgc3VtbWFyeUNvbnRlbnQgKz0gYFtbJHtyZWxhdGVkLmZpbGUucGF0aH18VmlldyBmdWxsIG5vdGVdXVxcblxcbmA7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIENyZWF0ZSB0aGUgbmV3IG5vdGVcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAvLyBUcnkgdG8gZmluZCBhbiBleGlzdGluZyBzdW1tYXJ5IG5vdGUgdG8gdXBkYXRlXHJcbiAgICAgICAgICAgIGNvbnN0IHN1bW1hcnlQYXRoID0gYCR7ZmlsZS5wYXJlbnQ/LnBhdGggfHwgJyd9LyR7c3VtbWFyeVRpdGxlfS5tZGA7XHJcbiAgICAgICAgICAgIGxldCBzdW1tYXJ5RmlsZTogVEZpbGUgfCBudWxsID0gdGhpcy5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKHN1bW1hcnlQYXRoKSBhcyBURmlsZTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGlmIChzdW1tYXJ5RmlsZSkge1xyXG4gICAgICAgICAgICAgICAgLy8gVXBkYXRlIGV4aXN0aW5nIGZpbGVcclxuICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMuYXBwLnZhdWx0Lm1vZGlmeShzdW1tYXJ5RmlsZSwgc3VtbWFyeUNvbnRlbnQpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgLy8gQ3JlYXRlIG5ldyBmaWxlXHJcbiAgICAgICAgICAgICAgICBzdW1tYXJ5RmlsZSA9IGF3YWl0IHRoaXMuYXBwLnZhdWx0LmNyZWF0ZShzdW1tYXJ5UGF0aCwgc3VtbWFyeUNvbnRlbnQpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyBPcGVuIHRoZSBzdW1tYXJ5IG5vdGVcclxuICAgICAgICAgICAgdGhpcy5hcHAud29ya3NwYWNlLmdldExlYWYoKS5vcGVuRmlsZShzdW1tYXJ5RmlsZSk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICByZXR1cm4gc3VtbWFyeUNvbnRlbnQ7XHJcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgY3JlYXRpbmcgc3VtbWFyeTonLCBlcnJvcik7XHJcbiAgICAgICAgICAgIG5ldyBOb3RpY2UoJ0Vycm9yIGNyZWF0aW5nIHN1bW1hcnkgbm90ZScpO1xyXG4gICAgICAgICAgICByZXR1cm4gJyc7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59IiwgImltcG9ydCB7IEl0ZW1WaWV3LCBURmlsZSwgV29ya3NwYWNlTGVhZiB9IGZyb20gJ29ic2lkaWFuJztcclxuaW1wb3J0IHsgUmVsYXRlZE5vdGUsIFJlbGF0ZWROb3Rlc1ZpZXdDb250cm9sbGVyLCBQbHVnaW5BUEkgfSBmcm9tICcuLi91dGlscy90eXBlcyc7XHJcblxyXG4vLyBWaWV3IHR5cGUgZm9yIHJlbGF0ZWQgbm90ZXNcclxuZXhwb3J0IGNvbnN0IFJFTEFURURfTk9URVNfVklFV19UWVBFID0gJ2tub3dsZWRnZS1zeW50aGVzaXMtcmVsYXRlZC1ub3Rlcyc7XHJcblxyXG4vKipcclxuICogUmVsYXRlZCBOb3RlcyBWaWV3IGltcGxlbWVudGF0aW9uXHJcbiAqL1xyXG5leHBvcnQgY2xhc3MgUmVsYXRlZE5vdGVzVmlldyBleHRlbmRzIEl0ZW1WaWV3IGltcGxlbWVudHMgUmVsYXRlZE5vdGVzVmlld0NvbnRyb2xsZXIge1xyXG4gICAgcHJpdmF0ZSBwbHVnaW5BcGk6IFBsdWdpbkFQSTtcclxuICAgIHByaXZhdGUgcmVsYXRlZENvbnRlbnRFbDogSFRNTEVsZW1lbnQ7IC8vIENoYW5nZWQgZnJvbSBjb250ZW50RWwgdG8gYXZvaWQgY29uZmxpY3RzXHJcbiAgICBwcml2YXRlIGN1cnJlbnRGaWxlOiBURmlsZSB8IG51bGwgPSBudWxsO1xyXG4gICAgXHJcbiAgICBjb25zdHJ1Y3RvcihsZWFmOiBXb3Jrc3BhY2VMZWFmLCBwbHVnaW5BcGk6IFBsdWdpbkFQSSkge1xyXG4gICAgICAgIHN1cGVyKGxlYWYpO1xyXG4gICAgICAgIHRoaXMucGx1Z2luQXBpID0gcGx1Z2luQXBpO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICBnZXRWaWV3VHlwZSgpOiBzdHJpbmcge1xyXG4gICAgICAgIHJldHVybiBSRUxBVEVEX05PVEVTX1ZJRVdfVFlQRTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgZ2V0RGlzcGxheVRleHQoKTogc3RyaW5nIHtcclxuICAgICAgICByZXR1cm4gXCJSZWxhdGVkIE5vdGVzXCI7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIGFzeW5jIG9uT3BlbigpIHtcclxuICAgICAgICBjb25zdCB7IGNvbnRhaW5lckVsIH0gPSB0aGlzO1xyXG4gICAgICAgIGNvbnRhaW5lckVsLmVtcHR5KCk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gQ3JlYXRlIGNvbnRlbnQgY29udGFpbmVyXHJcbiAgICAgICAgdGhpcy5yZWxhdGVkQ29udGVudEVsID0gY29udGFpbmVyRWwuY3JlYXRlRGl2KHsgY2xzOiAna25vd2xlZGdlLXN5bnRoZXNpcy1yZWxhdGVkLW5vdGVzJyB9KTtcclxuICAgICAgICBcclxuICAgICAgICAvLyBDcmVhdGUgaGVhZGVyXHJcbiAgICAgICAgdGhpcy5yZWxhdGVkQ29udGVudEVsLmNyZWF0ZUVsKCdoMycsIHsgdGV4dDogJ1JlbGF0ZWQgTm90ZXMnIH0pO1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIFNob3cgcGxhY2Vob2xkZXIgdGV4dFxyXG4gICAgICAgIHRoaXMucmVsYXRlZENvbnRlbnRFbC5jcmVhdGVFbCgncCcsIHsgXHJcbiAgICAgICAgICAgIHRleHQ6ICdPcGVuIGEgbm90ZSB0byBzZWUgcmVsYXRlZCBjb250ZW50LicsXHJcbiAgICAgICAgICAgIGNsczogJ2tub3dsZWRnZS1zeW50aGVzaXMtcGxhY2Vob2xkZXInXHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8qKlxyXG4gICAgICogVXBkYXRlIHRoZSB2aWV3IHdpdGggcmVsYXRlZCBub3RlcyBmb3IgYSBmaWxlXHJcbiAgICAgKiBAcGFyYW0gZmlsZSBDdXJyZW50IGFjdGl2ZSBmaWxlXHJcbiAgICAgKiBAcGFyYW0gcmVsYXRlZE5vdGVzIEFycmF5IG9mIHJlbGF0ZWQgbm90ZXNcclxuICAgICAqL1xyXG4gICAgcHVibGljIHVwZGF0ZVJlbGF0ZWROb3RlcyhmaWxlOiBURmlsZSwgcmVsYXRlZE5vdGVzOiBSZWxhdGVkTm90ZVtdKTogdm9pZCB7XHJcbiAgICAgICAgdGhpcy5jdXJyZW50RmlsZSA9IGZpbGU7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gVXBkYXRlIGhlYWRlciB3aXRoIGZpbGVuYW1lXHJcbiAgICAgICAgdGhpcy5yZWxhdGVkQ29udGVudEVsLmVtcHR5KCk7XHJcbiAgICAgICAgdGhpcy5yZWxhdGVkQ29udGVudEVsLmNyZWF0ZUVsKCdoMycsIHsgdGV4dDogJ1JlbGF0ZWQgdG86ICcgKyBmaWxlLmJhc2VuYW1lIH0pO1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIERpc3BsYXkgY29uY2VwdHNcclxuICAgICAgICBjb25zdCBjb25jZXB0cyA9IHRoaXMucGx1Z2luQXBpLmV4dHJhY3RDb25jZXB0cyhmaWxlLnBhdGgpO1xyXG4gICAgICAgIGlmIChjb25jZXB0cy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGNvbmNlcHRzRWwgPSB0aGlzLnJlbGF0ZWRDb250ZW50RWwuY3JlYXRlRGl2KHsgY2xzOiAna25vd2xlZGdlLXN5bnRoZXNpcy1jb25jZXB0cycgfSk7XHJcbiAgICAgICAgICAgIGNvbmNlcHRzRWwuY3JlYXRlRWwoJ2g0JywgeyB0ZXh0OiAnS2V5IENvbmNlcHRzJyB9KTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGNvbnN0IGNvbmNlcHRzTGlzdCA9IGNvbmNlcHRzRWwuY3JlYXRlRGl2KHsgY2xzOiAna25vd2xlZGdlLXN5bnRoZXNpcy1jb25jZXB0cy1saXN0JyB9KTtcclxuICAgICAgICAgICAgZm9yIChjb25zdCBjb25jZXB0IG9mIGNvbmNlcHRzKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0YWdFbCA9IGNvbmNlcHRzTGlzdC5jcmVhdGVTcGFuKHsgXHJcbiAgICAgICAgICAgICAgICAgICAgY2xzOiAna25vd2xlZGdlLXN5bnRoZXNpcy1jb25jZXB0LXRhZycsXHJcbiAgICAgICAgICAgICAgICAgICAgdGV4dDogY29uY2VwdFxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gRGlzcGxheSByZWxhdGVkIG5vdGVzXHJcbiAgICAgICAgaWYgKHJlbGF0ZWROb3Rlcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHJlbGF0ZWRFbCA9IHRoaXMucmVsYXRlZENvbnRlbnRFbC5jcmVhdGVEaXYoeyBjbHM6ICdrbm93bGVkZ2Utc3ludGhlc2lzLXJlbGF0ZWQnIH0pO1xyXG4gICAgICAgICAgICByZWxhdGVkRWwuY3JlYXRlRWwoJ2g0JywgeyB0ZXh0OiAnUmVsYXRlZCBOb3RlcycgfSk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBjb25zdCByZWxhdGVkTGlzdCA9IHJlbGF0ZWRFbC5jcmVhdGVEaXYoeyBjbHM6ICdrbm93bGVkZ2Utc3ludGhlc2lzLXJlbGF0ZWQtbGlzdCcgfSk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBmb3IgKGNvbnN0IHJlbGF0ZWQgb2YgcmVsYXRlZE5vdGVzKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBub3RlRWwgPSByZWxhdGVkTGlzdC5jcmVhdGVEaXYoeyBjbHM6ICdrbm93bGVkZ2Utc3ludGhlc2lzLXJlbGF0ZWQtbm90ZScgfSk7XHJcbiAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgIC8vIENyZWF0ZSBsaW5rIHRvIHRoZSBub3RlXHJcbiAgICAgICAgICAgICAgICBjb25zdCBsaW5rRWwgPSBub3RlRWwuY3JlYXRlRWwoJ2EnLCB7IFxyXG4gICAgICAgICAgICAgICAgICAgIGNsczogJ2tub3dsZWRnZS1zeW50aGVzaXMtbm90ZS1saW5rJyxcclxuICAgICAgICAgICAgICAgICAgICB0ZXh0OiByZWxhdGVkLmZpbGUuYmFzZW5hbWVcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAvLyBBZGQgY2xpY2sgaGFuZGxlciB0byBvcGVuIHRoZSBub3RlXHJcbiAgICAgICAgICAgICAgICBsaW5rRWwuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBhc3luYyAoZSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBsZWFmID0gdGhpcy5hcHAud29ya3NwYWNlLmdldExlYWYoKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAobGVhZikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCBsZWFmLm9wZW5GaWxlKHJlbGF0ZWQuZmlsZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgIC8vIEFkZCByZWxldmFuY2UgaW5kaWNhdG9yXHJcbiAgICAgICAgICAgICAgICBjb25zdCByZWxldmFuY2VFbCA9IG5vdGVFbC5jcmVhdGVEaXYoeyBcclxuICAgICAgICAgICAgICAgICAgICBjbHM6ICdrbm93bGVkZ2Utc3ludGhlc2lzLXJlbGV2YW5jZS1iYXInIFxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgIGNvbnN0IGluZGljYXRvckVsID0gcmVsZXZhbmNlRWwuY3JlYXRlRGl2KHsgXHJcbiAgICAgICAgICAgICAgICAgICAgY2xzOiAna25vd2xlZGdlLXN5bnRoZXNpcy1yZWxldmFuY2UtaW5kaWNhdG9yJyBcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAvLyBTZXQgd2lkdGggYmFzZWQgb24gcmVsZXZhbmNlIHNjb3JlICgwLTEwMCUpXHJcbiAgICAgICAgICAgICAgICBpbmRpY2F0b3JFbC5zdHlsZS53aWR0aCA9IGAke01hdGgucm91bmQocmVsYXRlZC5yZWxldmFuY2UgKiAxMDApfSVgO1xyXG4gICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAvLyBBZGQgc2hhcmVkIGNvbmNlcHRzXHJcbiAgICAgICAgICAgICAgICBpZiAocmVsYXRlZC5zaGFyZWRDb25jZXB0cy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qgc2hhcmVkRWwgPSBub3RlRWwuY3JlYXRlRGl2KHsgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNsczogJ2tub3dsZWRnZS1zeW50aGVzaXMtc2hhcmVkLWNvbmNlcHRzJyBcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgICAgICBzaGFyZWRFbC5jcmVhdGVTcGFuKHsgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNsczogJ2tub3dsZWRnZS1zeW50aGVzaXMtc2hhcmVkLWxhYmVsJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGV4dDogJ1NoYXJlZCBjb25jZXB0czogJ1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3QgY29uY2VwdCBvZiByZWxhdGVkLnNoYXJlZENvbmNlcHRzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNoYXJlZEVsLmNyZWF0ZVNwYW4oeyBcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsczogJ2tub3dsZWRnZS1zeW50aGVzaXMtY29uY2VwdC10YWcga25vd2xlZGdlLXN5bnRoZXNpcy1zaGFyZWQnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dDogY29uY2VwdFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLnJlbGF0ZWRDb250ZW50RWwuY3JlYXRlRWwoJ3AnLCB7IFxyXG4gICAgICAgICAgICAgICAgdGV4dDogJ05vIHJlbGF0ZWQgbm90ZXMgZm91bmQuIFRyeSBhZGRpbmcgbW9yZSBjb250ZW50IG9yIGNvbmNlcHRzLicsXHJcbiAgICAgICAgICAgICAgICBjbHM6ICdrbm93bGVkZ2Utc3ludGhlc2lzLW5vLXJlc3VsdHMnXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICAvLyBBZGQgYnV0dG9uIHRvIGdlbmVyYXRlIHN1bW1hcnlcclxuICAgICAgICBjb25zdCBhY3Rpb25zRWwgPSB0aGlzLnJlbGF0ZWRDb250ZW50RWwuY3JlYXRlRGl2KHsgY2xzOiAna25vd2xlZGdlLXN5bnRoZXNpcy1hY3Rpb25zJyB9KTtcclxuICAgICAgICBjb25zdCBzdW1tYXJ5QnRuID0gYWN0aW9uc0VsLmNyZWF0ZUVsKCdidXR0b24nLCB7IFxyXG4gICAgICAgICAgICBjbHM6ICdrbm93bGVkZ2Utc3ludGhlc2lzLXN1bW1hcnktYnRuJyxcclxuICAgICAgICAgICAgdGV4dDogJ0dlbmVyYXRlIFN1bW1hcnknXHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgc3VtbWFyeUJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGFzeW5jICgpID0+IHtcclxuICAgICAgICAgICAgaWYgKHRoaXMuY3VycmVudEZpbGUpIHtcclxuICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luQXBpLmdlbmVyYXRlU3VtbWFyeSh0aGlzLmN1cnJlbnRGaWxlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvKipcclxuICAgICAqIENsZWFyIHRoZSB2aWV3XHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBjbGVhcigpOiB2b2lkIHtcclxuICAgICAgICB0aGlzLnJlbGF0ZWRDb250ZW50RWwuZW1wdHkoKTtcclxuICAgICAgICB0aGlzLmN1cnJlbnRGaWxlID0gbnVsbDtcclxuICAgICAgICBcclxuICAgICAgICB0aGlzLnJlbGF0ZWRDb250ZW50RWwuY3JlYXRlRWwoJ2gzJywgeyB0ZXh0OiAnUmVsYXRlZCBOb3RlcycgfSk7XHJcbiAgICAgICAgdGhpcy5yZWxhdGVkQ29udGVudEVsLmNyZWF0ZUVsKCdwJywgeyBcclxuICAgICAgICAgICAgdGV4dDogJ09wZW4gYSBub3RlIHRvIHNlZSByZWxhdGVkIGNvbnRlbnQuJyxcclxuICAgICAgICAgICAgY2xzOiAna25vd2xlZGdlLXN5bnRoZXNpcy1wbGFjZWhvbGRlcidcclxuICAgICAgICB9KTtcclxuICAgIH1cclxufSIsICIvLyBzcmMvdWkvc2V0dGluZ3MtdGFiLnRzXHJcbmltcG9ydCB7IEFwcCwgTm90aWNlLCBQbHVnaW4sIFBsdWdpblNldHRpbmdUYWIsIFNldHRpbmcgfSBmcm9tICdvYnNpZGlhbic7XHJcbmltcG9ydCB7IEtub3dsZWRnZVN5bnRoZXNpc1NldHRpbmdzIH0gZnJvbSAnLi4vdXRpbHMvdHlwZXMnO1xyXG5pbXBvcnQgS25vd2xlZGdlU3ludGhlc2lzUGx1Z2luIGZyb20gJy4uLy4uL21haW4nOyBcclxuXHJcbi8qKlxyXG4gKiBTZXR0aW5ncyB0YWIgaW1wbGVtZW50YXRpb25cclxuICovXHJcbmV4cG9ydCBjbGFzcyBLbm93bGVkZ2VTeW50aGVzaXNTZXR0aW5nVGFiIGV4dGVuZHMgUGx1Z2luU2V0dGluZ1RhYiB7XHJcbiAgICBwcml2YXRlIHBsdWdpbjogS25vd2xlZGdlU3ludGhlc2lzUGx1Z2luOyAvLyBVc2UgdGhlIHNwZWNpZmljIHBsdWdpbiBjbGFzcyB0eXBlXHJcblxyXG4gICAgY29uc3RydWN0b3IoYXBwOiBBcHAsIHBsdWdpbjogS25vd2xlZGdlU3ludGhlc2lzUGx1Z2luKSB7XHJcbiAgICAgICAgc3VwZXIoYXBwLCBwbHVnaW4pO1xyXG4gICAgICAgIHRoaXMucGx1Z2luID0gcGx1Z2luO1xyXG4gICAgfVxyXG5cclxuICAgIGRpc3BsYXkoKTogdm9pZCB7XHJcbiAgICAgICAgY29uc3QgeyBjb250YWluZXJFbCB9ID0gdGhpcztcclxuICAgICAgICBjb250YWluZXJFbC5lbXB0eSgpO1xyXG5cclxuICAgICAgICBjb250YWluZXJFbC5jcmVhdGVFbCgnaDInLCB7IHRleHQ6ICdLbm93bGVkZ2UgU3ludGhlc2lzIFNldHRpbmdzJyB9KTtcclxuXHJcbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXHJcbiAgICAgICAgICAgIC5zZXROYW1lKCdDb25jZXB0IEV4dHJhY3Rpb24gU2Vuc2l0aXZpdHknKVxyXG4gICAgICAgICAgICAuc2V0RGVzYygnSGlnaGVyIHZhbHVlcyBleHRyYWN0IG1vcmUgY29uY2VwdHMgKDEtMTApJylcclxuICAgICAgICAgICAgLmFkZFNsaWRlcihzbGlkZXIgPT4gc2xpZGVyXHJcbiAgICAgICAgICAgICAgICAuc2V0TGltaXRzKDEsIDEwLCAxKVxyXG4gICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmV4dHJhY3Rpb25TZW5zaXRpdml0eSlcclxuICAgICAgICAgICAgICAgIC5zZXREeW5hbWljVG9vbHRpcCgpXHJcbiAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuZXh0cmFjdGlvblNlbnNpdGl2aXR5ID0gdmFsdWU7XHJcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcbiAgICAgICAgICAgICAgICB9KSk7XHJcblxyXG4gICAgICAgIC8vIE90aGVyIHNldHRpbmdzLi4uXHJcblxyXG4gICAgICAgIC8vIEFkZCBhIGJ1dHRvbiB0byByZXByb2Nlc3MgYWxsIG5vdGVzXHJcbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXHJcbiAgICAgICAgICAgIC5zZXROYW1lKCdSZXByb2Nlc3MgQWxsIE5vdGVzJylcclxuICAgICAgICAgICAgLnNldERlc2MoJ1VwZGF0ZSB0aGUgY29uY2VwdCBncmFwaCB3aXRoIGFsbCBub3RlcyBpbiB0aGUgdmF1bHQnKVxyXG4gICAgICAgICAgICAuYWRkQnV0dG9uKGJ1dHRvbiA9PiBidXR0b25cclxuICAgICAgICAgICAgICAgIC5zZXRCdXR0b25UZXh0KCdSZXByb2Nlc3MnKVxyXG4gICAgICAgICAgICAgICAgLm9uQ2xpY2soYXN5bmMgKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnByb2Nlc3NBbGxOb3RlcygpO1xyXG4gICAgICAgICAgICAgICAgfSkpO1xyXG4gICAgICAgICAgICAgICAgXHJcbiAgICAgICAgLy8gQWRkIGEgYnV0dG9uIHRvIGNsZWFyIGFsbCBkYXRhXHJcbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXHJcbiAgICAgICAgICAgIC5zZXROYW1lKCdDbGVhciBBbGwgRGF0YScpXHJcbiAgICAgICAgICAgIC5zZXREZXNjKCdSZXNldCBhbGwgY29uY2VwdCBhbmQgcmVsYXRpb25zaGlwIGRhdGEnKVxyXG4gICAgICAgICAgICAuYWRkQnV0dG9uKGJ1dHRvbiA9PiBidXR0b25cclxuICAgICAgICAgICAgICAgIC5zZXRCdXR0b25UZXh0KCdDbGVhciBEYXRhJylcclxuICAgICAgICAgICAgICAgIC5zZXRXYXJuaW5nKClcclxuICAgICAgICAgICAgICAgIC5vbkNsaWNrKGFzeW5jICgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBjb25maXJtZWQgPSBjb25maXJtKCdBcmUgeW91IHN1cmUgeW91IHdhbnQgdG8gY2xlYXIgYWxsIEtub3dsZWRnZSBTeW50aGVzaXMgZGF0YT8gVGhpcyBjYW5ub3QgYmUgdW5kb25lLicpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChjb25maXJtZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uZGF0YU1hbmFnZXIuY2xlYXJEYXRhKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBOb3RpY2UoJ0tub3dsZWRnZSBTeW50aGVzaXMgZGF0YSBjbGVhcmVkJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSkpO1xyXG4gICAgfVxyXG59Il0sCiAgIm1hcHBpbmdzIjogIjs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLElBQUFBLG1CQU9POzs7QUNIQSxJQUFNLHNCQUFOLE1BQW1EO0FBQUEsRUFBbkQ7QUFFSDtBQUFBLFNBQVEsWUFBeUIsb0JBQUksSUFBSTtBQUFBLE1BQ3JDO0FBQUEsTUFBSztBQUFBLE1BQU07QUFBQSxNQUFPO0FBQUEsTUFBTztBQUFBLE1BQU07QUFBQSxNQUFPO0FBQUEsTUFBTTtBQUFBLE1BQU87QUFBQSxNQUFPO0FBQUEsTUFDMUQ7QUFBQSxNQUFNO0FBQUEsTUFBUTtBQUFBLE1BQVM7QUFBQSxNQUFRO0FBQUEsTUFBTztBQUFBLE1BQU87QUFBQSxNQUFNO0FBQUEsTUFBUTtBQUFBLE1BQzNEO0FBQUEsTUFBTTtBQUFBLE1BQVE7QUFBQSxNQUFNO0FBQUEsTUFBTztBQUFBLE1BQU07QUFBQSxNQUFPO0FBQUEsTUFBUTtBQUFBLE1BQVM7QUFBQSxNQUN6RDtBQUFBLE1BQVc7QUFBQSxNQUFRO0FBQUEsTUFBUTtBQUFBLE1B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
