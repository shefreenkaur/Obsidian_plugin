/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// main.ts
var main_exports = {};
__export(main_exports, {
  default: () => KnowledgeSynthesisPlugin
});
module.exports = __toCommonJS(main_exports);
var import_obsidian6 = require("obsidian");

// src/utils/text-processing.ts
var TextProcessingUtils = class {
  constructor() {
    //Common English stop words to filter out
    this.stopWords = /* @__PURE__ */ new Set([
      "a",
      "an",
      "the",
      "and",
      "or",
      "but",
      "is",
      "are",
      "was",
      "were",
      "be",
      "been",
      "being",
      "have",
      "has",
      "had",
      "do",
      "does",
      "did",
      "of",
      "as",
      "like",
      "if",
      "that",
      "you",
      "with",
      "your",
      "through",
      "to",
      "from",
      "in",
      "out",
      "on",
      "off",
      "over",
      "under",
      "again",
      "further",
      "then",
      "once",
      "here",
      "there",
      "when",
      "where",
      "why",
      "how",
      "all",
      "any",
      "both",
      "each",
      "few",
      "more",
      "most",
      "other",
      "some",
      "such",
      "no",
      "nor",
      "not",
      "only",
      "own",
      "same",
      "so",
      "than",
      "too",
      "very",
      "can",
      "will",
      "just",
      "should",
      "now"
    ]);
  }
  /**
   * Tokenize text into words
   * @param text Input text to tokenize
   * @returns Array of tokens
   */
  tokenize(text) {
    const normalized = text.toLowerCase().replace(/[^\w\s]/g, " ").replace(/\s+/g, " ").trim();
    return normalized.split(" ");
  }
  /**
   * Calculate term frequency for tokens
   * @param tokens Array of tokens
   * @returns Map of terms to their frequency
   */
  calculateTermFrequency(tokens) {
    const termFrequency = /* @__PURE__ */ new Map();
    for (const token of tokens) {
      const count = termFrequency.get(token) || 0;
      termFrequency.set(token, count + 1);
    }
    return termFrequency;
  }
  /**
   * Remove common stop words from tokens
   * @param tokens Array of tokens
   * @returns Filtered array with stop words removed
   */
  removeStopWords(tokens) {
    return tokens.filter((token) => !this.stopWords.has(token) && token.length > 1);
  }
  /**
   * Basic stemming algorithm for English
   * Implements a simple version of Porter stemming
   * @param tokens Array of tokens
   * @returns Array of stemmed tokens
   */
  stemWords(tokens) {
    return tokens.map((token) => {
      if (token.endsWith("ing")) {
        return token.slice(0, -3);
      } else if (token.endsWith("ly")) {
        return token.slice(0, -2);
      } else if (token.endsWith("s") && !token.endsWith("ss")) {
        return token.slice(0, -1);
      } else if (token.endsWith("ed") && token.length > 4) {
        return token.slice(0, -2);
      } else {
        return token;
      }
    });
  }
  /**
   * Extract potential named entities from text
   * Very simplified implementation for proof of concept
   * @param text Input text
   * @returns Array of potential named entities
   */
  extractNamedEntities(text) {
    const sentences = text.split(/[.!?]+/);
    const entities = [];
    for (const sentence of sentences) {
      const words = sentence.trim().split(" ");
      for (let i = 0; i < words.length; i++) {
        const word = words[i];
        if (i > 0 && word.length > 1 && /^[A-Z][a-z]+$/.test(word)) {
          entities.push(word);
        }
        if (i < words.length - 1 && word.length > 1 && /^[A-Z][a-z]+$/.test(word) && /^[A-Z][a-z]+$/.test(words[i + 1])) {
          entities.push(`${word} ${words[i + 1]}`);
        }
      }
    }
    return [...new Set(entities)];
  }
};

// src/core/concept-extractor.ts
var ConceptExtractorImpl = class {
  //Store user feedback on concepts
  constructor() {
    this.sensitivity = 5;
    this.userFeedback = /* @__PURE__ */ new Map();
    this.textProcessor = new TextProcessingUtils();
  }
  /**
   * Extract concepts from text content
   * @param content Text content to analyze
   * @returns Array of extracted concepts
   */
  extractConcepts(content) {
    if (!content || content.trim() === "") {
      return [];
    }
    const concepts = [
      ...this.extractFromTfIdf(content),
      ...this.extractFromHeadings(content),
      ...this.extractFromEmphasis(content),
      ...this.extractFromNamedEntities(content)
    ];
    const filteredConcepts = concepts.filter((concept) => {
      const feedback = this.userFeedback.get(concept);
      if (feedback === false) {
        return false;
      }
      return true;
    });
    return [...new Set(filteredConcepts)];
  }
  /**
   * Set sensitivity for extraction (1-10)
   * @param sensitivity Sensitivity level (1-10)
   */
  setSensitivity(sensitivity) {
    this.sensitivity = Math.max(1, Math.min(10, sensitivity));
  }
  /**
   * Learn from user feedback on concept relevance
   * @param concept The concept receiving feedback
   * @param isRelevant Whether the user marked it as relevant
   */
  learnFromUserFeedback(concept, isRelevant) {
    this.userFeedback.set(concept, isRelevant);
  }
  /**
   * Extract concepts using TF-IDF like approach
   * @param content Text content to analyze
   * @returns Array of concepts
   */
  extractFromTfIdf(content) {
    const tokens = this.textProcessor.tokenize(content);
    const filteredTokens = this.textProcessor.removeStopWords(tokens);
    const termFrequency = this.textProcessor.calculateTermFrequency(filteredTokens);
    const threshold = Math.max(2, Math.floor(20 / (11 - this.sensitivity)));
    const sortedTerms = Array.from(termFrequency.entries()).filter(([_, freq]) => freq >= threshold).sort((a, b) => b[1] - a[1]).slice(0, this.sensitivity * 3).map(([term, _]) => term);
    return sortedTerms;
  }
  /**
   * Extract concepts from markdown headings
   * @param content Markdown content
   * @returns Array of concepts from headings
   */
  extractFromHeadings(content) {
    const headingRegex = /^#+\s+(.+)$/gm;
    const headings = [];
    let match;
    while ((match = headingRegex.exec(content)) !== null) {
      headings.push(match[1].trim());
    }
    return headings;
  }
  /**
   * Extract concepts from emphasized text (bold/italic)
   * @param content Markdown content
   * @returns Array of concepts from emphasized text
   */
  extractFromEmphasis(content) {
    const emphasisRegex = /(\*\*|__)(.*?)\1|(\*|_)(.*?)\3/g;
    const emphasized = [];
    let match;
    while ((match = emphasisRegex.exec(content)) !== null) {
      const text = match[2] || match[4];
      if (text && text.trim().length > 0) {
        emphasized.push(text.trim());
      }
    }
    return emphasized;
  }
  /**
   * Extract named entities as concepts
   * @param content Text content
   * @returns Array of named entities
   */
  extractFromNamedEntities(content) {
    return this.textProcessor.extractNamedEntities(content);
  }
};

// src/core/concept-graph.ts
var import_obsidian = require("obsidian");
var ConceptGraphImpl = class {
  constructor(vault) {
    this.notes = /* @__PURE__ */ new Map();
    this.concepts = /* @__PURE__ */ new Map();
    this.vault = vault;
  }
  /**
   * Add a note to the graph with its concepts
   * @param path Path to the note
   * @param concepts Array of concepts in the note
   */
  addNote(path, concepts) {
    this.notes.set(path, {
      path,
      concepts,
      lastUpdated: Date.now()
    });
    for (const concept of concepts) {
      const conceptNode = this.concepts.get(concept) || {
        name: concept,
        notePaths: [],
        weight: 1
      };
      if (!conceptNode.notePaths.includes(path)) {
        conceptNode.notePaths.push(path);
      }
      conceptNode.weight = conceptNode.notePaths.length;
      this.concepts.set(concept, conceptNode);
    }
  }
  /**
   * Remove a note from the graph
   * @param path Path to the note to remove
   */
  removeNote(path) {
    const note = this.notes.get(path);
    if (!note) {
      return;
    }
    for (const concept of note.concepts) {
      const conceptNode = this.concepts.get(concept);
      if (conceptNode) {
        conceptNode.notePaths = conceptNode.notePaths.filter((p) => p !== path);
        conceptNode.weight = conceptNode.notePaths.length;
        if (conceptNode.notePaths.length === 0) {
          this.concepts.delete(concept);
        } else {
          this.concepts.set(concept, conceptNode);
        }
      }
    }
    this.notes.delete(path);
  }
  /**
   * Find notes related to a given note
   * @param notePath Path to the note
   * @param maxResults Maximum number of results to return
   * @returns Array of related notes sorted by relevance
   */
  findRelatedNotes(notePath, maxResults = 10) {
    const note = this.notes.get(notePath);
    if (!note) {
      return [];
    }
    const scores = /* @__PURE__ */ new Map();
    for (const concept of note.concepts) {
      const conceptNode = this.concepts.get(concept);
      if (!conceptNode)
        continue;
      for (const relatedPath of conceptNode.notePaths) {
        if (relatedPath === notePath)
          continue;
        const scoreData = scores.get(relatedPath) || {
          relevance: 0,
          sharedConcepts: []
        };
        scoreData.relevance += conceptNode.weight;
        if (!scoreData.sharedConcepts.includes(concept)) {
          scoreData.sharedConcepts.push(concept);
        }
        scores.set(relatedPath, scoreData);
      }
    }
    const relatedNotes = [];
    const maxScore = Math.max(...Array.from(scores.values()).map((data) => data.relevance), 1);
    for (const [path, data] of scores.entries()) {
      const file = this.vault.getAbstractFileByPath(path);
      if (!file || !(file instanceof import_obsidian.TFile))
        continue;
      relatedNotes.push({
        file,
        relevance: data.relevance / maxScore,
        // Normalize to 0-1
        sharedConcepts: data.sharedConcepts
      });
    }
    return relatedNotes.sort((a, b) => b.relevance - a.relevance).slice(0, maxResults);
  }
  /**
   * Get all concepts for a note
   * @param notePath Path to the note
   * @returns Array of concepts
   */
  getNoteConcepts(notePath) {
    const note = this.notes.get(notePath);
    return note ? note.concepts : [];
  }
  /**
   * Get graph data for visualization
   * @returns Object with nodes and edges arrays for visualization
   */
  getConceptNetwork() {
    const nodes = [];
    const edges = [];
    for (const [path, note] of this.notes.entries()) {
      nodes.push({
        id: path,
        label: path.split("/").pop() || path,
        // Use filename as label
        type: "note"
      });
    }
    for (const [name, concept] of this.concepts.entries()) {
      if (concept.notePaths.length > 1) {
        nodes.push({
          id: `concept-${name}`,
          label: name,
          type: "concept",
          weight: concept.weight
        });
        for (const path of concept.notePaths) {
          edges.push({
            source: `concept-${name}`,
            target: path,
            value: 1
          });
        }
      }
    }
    return { nodes, edges };
  }
  updateNoteConcepts(path, newConcepts) {
    this.notes.set(path, {
      path,
      concepts: newConcepts,
      lastUpdated: Date.now()
    });
  }
};

// src/core/data-manager.ts
var DataManagerImpl = class {
  constructor(plugin) {
    // Current data version for migration support
    this.CURRENT_VERSION = 1;
    this.plugin = plugin;
    this.data = {
      version: this.CURRENT_VERSION,
      notes: {},
      concepts: {},
      userFeedback: {}
    };
  }
  /**
   * Save concept data to disk
   */
  async saveConceptData() {
    await this.plugin.saveData(this.data);
  }
  /**
   * Load concept data from disk
   */
  async loadConceptData() {
    try {
      const savedData = await this.plugin.loadData();
      if (!savedData) {
        return;
      }
      if (savedData.version !== this.CURRENT_VERSION) {
        this.data = this.migrateData(savedData);
      } else {
        this.data = savedData;
      }
    } catch (error) {
      console.error("Failed to load concept data:", error);
    }
  }
  /**
   * Clear all stored data
   */
  async clearData() {
    this.data = {
      version: this.CURRENT_VERSION,
      notes: {},
      concepts: {},
      userFeedback: {}
    };
    await this.saveConceptData();
  }
  /**
   * Get the loaded data
   */
  getData() {
    return this.data;
  }
  /**
   * Set the data (used when updating from the concept graph)
   */
  setData(notes, concepts, userFeedback) {
    this.data = {
      version: this.CURRENT_VERSION,
      notes,
      concepts,
      userFeedback
    };
  }
  /**
   * Migrate data from an older version to the current version
   */
  migrateData(oldData) {
    return {
      version: this.CURRENT_VERSION,
      notes: oldData.notes || {},
      concepts: oldData.concepts || {},
      userFeedback: oldData.userFeedback || {}
    };
  }
};

// src/services/note-processor.ts
var import_obsidian2 = require("obsidian");
var NoteProcessor = class {
  // path -> lastModified
  constructor(vault, conceptExtractor, conceptGraph, saveCallback) {
    this.vault = vault;
    this.conceptExtractor = conceptExtractor;
    this.conceptGraph = conceptGraph;
    this.saveCallback = saveCallback;
    // Keep track of processed files to avoid redundant processing
    this.processedFiles = /* @__PURE__ */ new Map();
  }
  /**
   * Process a single note file
   * @param file Note file to process
   */
  async processNote(file) {
    if (!this.shouldProcessNote(file)) {
      return;
    }
    try {
      const content = await this.vault.read(file);
      const concepts = this.conceptExtractor.extractConcepts(content);
      this.conceptGraph.addNote(file.path, concepts);
      this.processedFiles.set(file.path, file.stat.mtime);
      await this.saveCallback();
    } catch (error) {
      console.error(`Error processing file ${file.path}:`, error);
    }
  }
  /**
   * Check if a file needs processing
   * @param file File to check
   * @returns true if file needs processing, false otherwise
   */
  shouldProcessNote(file) {
    if (file.extension !== "md") {
      return false;
    }
    const lastModified = file.stat.mtime;
    const lastProcessed = this.processedFiles.get(file.path);
    return !lastProcessed || lastProcessed < lastModified;
  }
  /**
   * Process all notes in the vault
   */
  async processAllNotes() {
    const files = this.vault.getMarkdownFiles();
    let processedCount = 0;
    const notice = new import_obsidian2.Notice(`Processing ${files.length} notes...`, 0);
    for (const file of files) {
      await this.processNote(file);
      processedCount++;
      if (processedCount % 10 === 0) {
        notice.setMessage(`Processed ${processedCount}/${files.length} notes...`);
      }
    }
    await this.saveCallback();
    notice.hide();
    new import_obsidian2.Notice(`Completed processing ${processedCount} notes.`);
  }
};

// src/services/summary-generator.ts
var import_obsidian3 = require("obsidian");
var SummaryGenerator = class {
  constructor(app, conceptGraph, getRelatedNotes) {
    this.app = app;
    this.conceptGraph = conceptGraph;
    this.getRelatedNotes = getRelatedNotes;
  }
  /**
   * Generate a summary from related notes
   * @param file File to generate summary for
   * @returns The content of the generated summary
   */
  async generateSummary(file) {
    var _a;
    const relatedNotes = await this.getRelatedNotes(file);
    if (relatedNotes.length === 0) {
      new import_obsidian3.Notice("No related notes found to generate summary");
      return "";
    }
    const summaryTitle = `Summary of ${file.basename}`;
    let summaryContent = `# ${summaryTitle}

`;
    summaryContent += `> [!info] Summary generated from ${file.basename} and ${relatedNotes.length} related notes
`;
    summaryContent += `> Generated on ${new Date().toLocaleString()}

`;
    const originalContent = await this.app.vault.read(file);
    const concepts = this.conceptGraph.getNoteConcepts(file.path);
    const conceptInfo = {};
    for (const concept of concepts) {
      conceptInfo[concept] = {
        originalSentences: this.extractSentencesWithConcept(originalContent, concept),
        relatedSentences: {}
      };
      for (const related of relatedNotes) {
        if (related.sharedConcepts.includes(concept)) {
          const relatedContent = await this.app.vault.read(related.file);
          conceptInfo[concept].relatedSentences[related.file.basename] = this.extractSentencesWithConcept(relatedContent, concept);
        }
      }
    }
    summaryContent += `## Original Note: ${file.basename}

`;
    const firstParagraph = originalContent.split("\n\n")[0];
    summaryContent += `${firstParagraph}

`;
    summaryContent += `## Key Concepts and Relationships

`;
    for (const concept of concepts) {
      if (Object.keys(conceptInfo[concept].relatedSentences).length === 0)
        continue;
      summaryContent += `### Concept: ${concept}

`;
      if (conceptInfo[concept].originalSentences.length > 0) {
        summaryContent += `In ${file.basename}:
`;
        for (const sentence of conceptInfo[concept].originalSentences.slice(0, 3)) {
          summaryContent += `- ${this.highlightConcept(sentence.trim(), concept)}
`;
        }
        summaryContent += `
`;
      }
      for (const [noteName, sentences] of Object.entries(conceptInfo[concept].relatedSentences)) {
        if (sentences.length > 0) {
          summaryContent += `In ${noteName}:
`;
          for (const sentence of sentences.slice(0, 3)) {
            summaryContent += `- ${this.highlightConcept(sentence.trim(), concept)}
`;
          }
          summaryContent += `
`;
        }
      }
    }
    summaryContent += `## Related Notes

`;
    for (const related of relatedNotes) {
      summaryContent += `- [[${related.file.path}|${related.file.basename}]] (Relevance: ${Math.round(related.relevance * 100)}%)
`;
    }
    try {
      const summaryPath = `${((_a = file.parent) == null ? void 0 : _a.path) || ""}/${summaryTitle}.md`;
      let summaryFile = this.app.vault.getAbstractFileByPath(summaryPath);
      if (summaryFile) {
        await this.app.vault.modify(summaryFile, summaryContent);
      } else {
        summaryFile = await this.app.vault.create(summaryPath, summaryContent);
      }
      this.app.workspace.getLeaf().openFile(summaryFile);
      return summaryContent;
    } catch (error) {
      console.error("Error creating summary:", error);
      new import_obsidian3.Notice("Error creating summary note");
      return "";
    }
  }
  /**
   * Extract sentences containing a concept
   * @param content Text content to search
   * @param concept Concept to find in sentences
   * @returns Array of sentences containing the concept
   */
  extractSentencesWithConcept(content, concept) {
    const sentences = content.split(/[.!?]+/).filter((s) => s.trim().length > 0);
    const regex = new RegExp(`\\b${concept}\\b`, "i");
    return sentences.filter((sentence) => regex.test(sentence));
  }
  /**
   * Highlight concept in text using markdown formatting
   * @param text Text containing the concept
   * @param concept Concept to highlight
   * @returns Text with highlighted concept
   */
  highlightConcept(text, concept) {
    const regex = new RegExp(`\\b(${concept})\\b`, "gi");
    return text.replace(regex, "**$1**");
  }
};

// src/ui/related-notes-view.ts
var import_obsidian4 = require("obsidian");
var RELATED_NOTES_VIEW_TYPE = "knowledge-synthesis-related-notes";
var RelatedNotesView = class extends import_obsidian4.ItemView {
  constructor(leaf, pluginApi) {
    super(leaf);
    // Changed from contentEl to avoid conflicts
    this.currentFile = null;
    this.pluginApi = pluginApi;
  }
  getViewType() {
    return RELATED_NOTES_VIEW_TYPE;
  }
  getDisplayText() {
    return "Related Notes";
  }
  async onOpen() {
    const { containerEl } = this;
    containerEl.empty();
    this.relatedContentEl = containerEl.createDiv({ cls: "knowledge-synthesis-related-notes" });
    this.relatedContentEl.createEl("h3", { text: "Related Notes" });
    this.relatedContentEl.createEl("p", {
      text: "Open a note to see related content.",
      cls: "knowledge-synthesis-placeholder"
    });
  }
  /**
   * Update the view with related notes for a file
   * @param file Current active file
   * @param relatedNotes Array of related notes
   */
  updateRelatedNotes(file, relatedNotes) {
    this.currentFile = file;
    this.relatedContentEl.empty();
    this.relatedContentEl.createEl("h3", { text: "Related to: " + file.basename });
    const concepts = this.pluginApi.extractConcepts(file.path);
    if (concepts.length > 0) {
      const conceptsEl = this.relatedContentEl.createDiv({ cls: "knowledge-synthesis-concepts" });
      conceptsEl.createEl("h4", { text: "Key Concepts" });
      const conceptsList = conceptsEl.createDiv({ cls: "knowledge-synthesis-concepts-list" });
      for (const concept of concepts) {
        const tagEl = conceptsList.createSpan({
          cls: "knowledge-synthesis-concept-tag",
          text: concept
        });
      }
    }
    if (relatedNotes.length > 0) {
      const relatedEl = this.relatedContentEl.createDiv({ cls: "knowledge-synthesis-related" });
      relatedEl.createEl("h4", { text: "Related Notes" });
      const relatedList = relatedEl.createDiv({ cls: "knowledge-synthesis-related-list" });
      for (const related of relatedNotes) {
        const noteEl = relatedList.createDiv({ cls: "knowledge-synthesis-related-note" });
        const linkEl = noteEl.createEl("a", {
          cls: "knowledge-synthesis-note-link",
          text: related.file.basename
        });
        linkEl.addEventListener("click", async (e) => {
          e.preventDefault();
          const leaf = this.app.workspace.getLeaf();
          if (leaf) {
            await leaf.openFile(related.file);
          }
        });
        const relevanceEl = noteEl.createDiv({
          cls: "knowledge-synthesis-relevance-bar"
        });
        const indicatorEl = relevanceEl.createDiv({
          cls: "knowledge-synthesis-relevance-indicator"
        });
        indicatorEl.style.width = `${Math.round(related.relevance * 100)}%`;
        const sharedEl = noteEl.createDiv({
          cls: "knowledge-synthesis-shared-concepts"
        });
        sharedEl.createSpan({
          cls: "knowledge-synthesis-shared-label",
          text: "Shared concepts: "
        });
        const sharedList = sharedEl.createDiv({ cls: "knowledge-synthesis-shared-list" });
        for (const concept of related.sharedConcepts) {
          const tag = sharedList.createSpan({
            cls: "knowledge-synthesis-concept-tag knowledge-synthesis-shared",
            text: concept
          });
          const removeBtn = tag.createEl("button", { text: "\xD7" });
          removeBtn.style.marginLeft = "6px";
          removeBtn.onclick = () => {
            related.sharedConcepts = related.sharedConcepts.filter((c) => c !== concept);
            tag.remove();
            this.pluginApi.updateNoteConcepts(related.file.path, related.sharedConcepts);
          };
        }
        const inputWrapper = sharedEl.createDiv({ cls: "knowledge-synthesis-add-concept" });
        const input = inputWrapper.createEl("input");
        input.placeholder = "Add new concept...";
        input.style.marginRight = "6px";
        const addBtn = inputWrapper.createEl("button", { text: "Add" });
        addBtn.onclick = () => {
          const newConcept = input.value.trim();
          if (newConcept && !related.sharedConcepts.includes(newConcept)) {
            related.sharedConcepts.push(newConcept);
            this.pluginApi.updateNoteConcepts(related.file.path, related.sharedConcepts);
            const newTag = sharedList.createSpan({
              cls: "knowledge-synthesis-concept-tag knowledge-synthesis-shared",
              text: newConcept
            });
            const removeBtn = newTag.createEl("button", { text: "\xD7" });
            removeBtn.style.marginLeft = "6px";
            removeBtn.onclick = () => {
              newTag.remove();
              related.sharedConcepts = related.sharedConcepts.filter((c) => c !== newConcept);
              this.pluginApi.updateNoteConcepts(related.file.path, related.sharedConcepts);
            };
            input.value = "";
          }
        };
      }
    } else {
      this.relatedContentEl.createEl("p", {
        text: "No related notes found. Try adding more content or concepts.",
        cls: "knowledge-synthesis-no-results"
      });
    }
    const actionsEl = this.relatedContentEl.createDiv({ cls: "knowledge-synthesis-actions" });
    const summaryBtn = actionsEl.createEl("button", {
      cls: "knowledge-synthesis-summary-btn",
      text: "Generate Summary"
    });
    summaryBtn.addEventListener("click", async () => {
      if (this.currentFile) {
        await this.pluginApi.generateSummary(this.currentFile);
      }
    });
  }
  /**
   * Clear the view
   */
  clear() {
    this.relatedContentEl.empty();
    this.currentFile = null;
    this.relatedContentEl.createEl("h3", { text: "Related Notes" });
    this.relatedContentEl.createEl("p", {
      text: "Open a note to see related content.",
      cls: "knowledge-synthesis-placeholder"
    });
  }
};

// src/ui/settings-tab.ts
var import_obsidian5 = require("obsidian");
var KnowledgeSynthesisSettingTab = class extends import_obsidian5.PluginSettingTab {
  // Use the specific plugin class type
  constructor(app, plugin) {
    super(app, plugin);
    this.plugin = plugin;
  }
  display() {
    const { containerEl } = this;
    containerEl.empty();
    containerEl.createEl("h2", { text: "Knowledge Synthesis Settings" });
    new import_obsidian5.Setting(containerEl).setName("Concept Extraction Sensitivity").setDesc("Higher values extract more concepts (1-10)").addSlider((slider) => slider.setLimits(1, 10, 1).setValue(this.plugin.settings.extractionSensitivity).setDynamicTooltip().onChange(async (value) => {
      this.plugin.settings.extractionSensitivity = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian5.Setting(containerEl).setName("Reprocess All Notes").setDesc("Update the concept graph with all notes in the vault").addButton((button) => button.setButtonText("Reprocess").onClick(async () => {
      await this.plugin.processAllNotes();
    }));
    new import_obsidian5.Setting(containerEl).setName("Clear All Data").setDesc("Reset all concept and relationship data").addButton((button) => button.setButtonText("Clear Data").setWarning().onClick(async () => {
      const confirmed = confirm("Are you sure you want to clear all Knowledge Synthesis data? This cannot be undone.");
      if (confirmed) {
        await this.plugin.dataManager.clearData();
        new import_obsidian5.Notice("Knowledge Synthesis data cleared");
      }
    }));
  }
};

// main.ts
var DEFAULT_SETTINGS = {
  extractionSensitivity: 5,
  maxRelatedNotes: 10,
  realTimeSuggestions: true,
  includeTags: true,
  includeLinks: true
};
var KnowledgeSynthesisPlugin = class extends import_obsidian6.Plugin {
  /**
   * Plugin initialization
   */
  async onload() {
    console.log("Loading Knowledge Synthesis plugin");
    await this.loadSettings();
    this.conceptExtractor = new ConceptExtractorImpl();
    this.conceptExtractor.setSensitivity(this.settings.extractionSensitivity);
    this.conceptGraph = new ConceptGraphImpl(this.app.vault);
    this.dataManager = new DataManagerImpl(this);
    this.noteProcessor = new NoteProcessor(
      this.app.vault,
      this.conceptExtractor,
      this.conceptGraph,
      () => this.dataManager.saveConceptData()
    );
    this.summaryGenerator = new SummaryGenerator(
      this.app,
      this.conceptGraph,
      (file) => this.getRelatedNotes(file)
    );
    await this.dataManager.loadConceptData();
    this.registerView(
      RELATED_NOTES_VIEW_TYPE,
      (leaf) => new RelatedNotesView(leaf, this)
    );
    this.addRibbonIcon("network", "Knowledge Synthesis", () => {
      this.activateView();
    });
    this.addCommands();
    this.registerEvents();
    this.addSettingTab(new KnowledgeSynthesisSettingTab(this.app, this));
    this.processAllNotes();
    console.log("Knowledge Synthesis plugin loaded");
  }
  /**
   * Clean up when plugin is disabled
   */
  onunload() {
    console.log("Knowledge Synthesis plugin unloaded");
  }
  /**
   * Load plugin settings
   */
  async loadSettings() {
    this.settings = Object.assign({}, DEFAULT_SETTINGS, await this.loadData());
  }
  /**
   * Save plugin settings
   */
  async saveSettings() {
    await this.saveData(this.settings);
    this.conceptExtractor.setSensitivity(this.settings.extractionSensitivity);
  }
  /**
   * Add plugin commands to Obsidian command palette
   */
  addCommands() {
    this.addCommand({
      id: "extract-concepts",
      name: "Extract Concepts from Current Note",
      checkCallback: (checking) => {
        const activeView = this.app.workspace.getActiveViewOfType(import_obsidian6.MarkdownView);
        if (activeView) {
          if (!checking) {
            this.processCurrentNote();
          }
          return true;
        }
        return false;
      }
    });
    this.addCommand({
      id: "show-related-notes",
      name: "Show Related Notes",
      checkCallback: (checking) => {
        const activeView = this.app.workspace.getActiveViewOfType(import_obsidian6.MarkdownView);
        if (activeView) {
          if (!checking) {
            this.activateView();
          }
          return true;
        }
        return false;
      }
    });
    this.addCommand({
      id: "generate-summary",
      name: "Generate Summary from Related Notes",
      checkCallback: (checking) => {
        const activeView = this.app.workspace.getActiveViewOfType(import_obsidian6.MarkdownView);
        if (activeView && activeView.file) {
          if (!checking) {
            this.generateSummary(activeView.file);
          }
          return true;
        }
        return false;
      }
    });
  }
  /**
   * Register event handlers
   */
  registerEvents() {
    this.registerEvent(
      this.app.vault.on("modify", (file) => {
        if (file instanceof import_obsidian6.TFile && file.extension === "md") {
          if (this.settings.realTimeSuggestions) {
            this.noteProcessor.processNote(file);
          }
        }
      })
    );
    this.registerEvent(
      this.app.vault.on("delete", (file) => {
        if (file instanceof import_obsidian6.TFile && file.extension === "md") {
          this.conceptGraph.removeNote(file.path);
          this.dataManager.saveConceptData();
        }
      })
    );
    this.registerEvent(
      this.app.vault.on("rename", (file, oldPath) => {
        if (file instanceof import_obsidian6.TFile && file.extension === "md") {
          this.conceptGraph.removeNote(oldPath);
          this.noteProcessor.processNote(file);
        }
      })
    );
    this.registerEvent(
      this.app.workspace.on("active-leaf-change", (leaf) => {
        if ((leaf == null ? void 0 : leaf.view) instanceof import_obsidian6.MarkdownView && this.settings.realTimeSuggestions) {
          this.processCurrentNote();
        }
      })
    );
  }
  /**
   * Process the current active note
   */
  async processCurrentNote() {
    const activeView = this.app.workspace.getActiveViewOfType(import_obsidian6.MarkdownView);
    if (activeView && activeView.file) {
      await this.noteProcessor.processNote(activeView.file);
      this.updateRelatedNotesView(activeView.file);
    }
  }
  /**
   * Activate the related notes view
   */
  async activateView() {
    const leaves = this.app.workspace.getLeavesOfType(RELATED_NOTES_VIEW_TYPE);
    if (leaves.length === 0) {
      const leaf = this.app.workspace.getRightLeaf(false);
      if (leaf) {
        await leaf.setViewState({
          type: RELATED_NOTES_VIEW_TYPE,
          active: true
        });
      }
    }
    const existingLeaves = this.app.workspace.getLeavesOfType(RELATED_NOTES_VIEW_TYPE);
    if (existingLeaves.length > 0) {
      this.app.workspace.revealLeaf(existingLeaves[0]);
      const activeView = this.app.workspace.getActiveViewOfType(import_obsidian6.MarkdownView);
      if (activeView && activeView.file) {
        this.updateRelatedNotesView(activeView.file);
      }
    }
  }
  /**
   * Update the related notes view with data for a file
   * @param file File to show related notes for
   */
  updateRelatedNotesView(file) {
    const leaves = this.app.workspace.getLeavesOfType(RELATED_NOTES_VIEW_TYPE);
    if (leaves.length > 0) {
      const view = leaves[0].view;
      const relatedNotes = this.conceptGraph.findRelatedNotes(
        file.path,
        this.settings.maxRelatedNotes
      );
      view.updateRelatedNotes(file, relatedNotes);
    }
  }
  /**
   * Process all existing notes in the vault
   * Public for settings tab access
   */
  async processAllNotes() {
    await this.noteProcessor.processAllNotes();
  }
  /**
   * Clear all stored data
   * Public for settings tab access
   */
  async clearData() {
    await this.dataManager.clearData();
  }
  /**
   * API method: Get related notes for a file
   * @param file File to find related notes for
   * @returns Array of related notes
   */
  async getRelatedNotes(file) {
    return this.conceptGraph.findRelatedNotes(
      file.path,
      this.settings.maxRelatedNotes
    );
  }
  /**
   * API method: Extract concepts from content
   * @param content Text content to analyze
   * @returns Array of extracted concepts
   */
  extractConcepts(content) {
    return this.conceptExtractor.extractConcepts(content);
  }
  /**
   * API method: Add a concept to a note (used by UI when user adds a concept)
   * @param filePath Path to the file
   * @param concept Concept to add
   */
  async addConceptToNote(filePath, concept) {
    const concepts = this.conceptGraph.getNoteConcepts(filePath);
    if (!concepts.includes(concept)) {
      concepts.push(concept);
      this.conceptGraph.addNote(filePath, concepts);
      await this.dataManager.saveConceptData();
      new import_obsidian6.Notice(`Added concept "${concept}" to note`);
    }
  }
  /**
   * API method: Generate a summary from related notes
   * @param file File to generate summary for
   */
  generateSummary(file) {
    return this.summaryGenerator.generateSummary(file);
  }
  /**
   * API method: Get plugin settings
   * @returns Current plugin settings
   */
  getSettings() {
    return this.settings;
  }
  updateNoteConcepts(path, concepts) {
    this.conceptGraph.updateNoteConcepts(path, concepts);
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsibWFpbi50cyIsICJzcmMvdXRpbHMvdGV4dC1wcm9jZXNzaW5nLnRzIiwgInNyYy9jb3JlL2NvbmNlcHQtZXh0cmFjdG9yLnRzIiwgInNyYy9jb3JlL2NvbmNlcHQtZ3JhcGgudHMiLCAic3JjL2NvcmUvZGF0YS1tYW5hZ2VyLnRzIiwgInNyYy9zZXJ2aWNlcy9ub3RlLXByb2Nlc3Nvci50cyIsICJzcmMvc2VydmljZXMvc3VtbWFyeS1nZW5lcmF0b3IudHMiLCAic3JjL3VpL3JlbGF0ZWQtbm90ZXMtdmlldy50cyIsICJzcmMvdWkvc2V0dGluZ3MtdGFiLnRzIl0sCiAgInNvdXJjZXNDb250ZW50IjogWyJpbXBvcnQgeyBcclxuICAgIEFwcCwgXHJcbiAgICBNYXJrZG93blZpZXcsIFxyXG4gICAgTm90aWNlLCBcclxuICAgIFBsdWdpbiwgXHJcbiAgICBURmlsZSxcclxuICAgIFdvcmtzcGFjZUxlYWZcclxufSBmcm9tICdvYnNpZGlhbic7XHJcblxyXG4vLyBJbXBvcnQgdHlwZXNcclxuaW1wb3J0IHsgXHJcbiAgICBLbm93bGVkZ2VTeW50aGVzaXNTZXR0aW5ncywgXHJcbiAgICBDb25jZXB0RXh0cmFjdG9yLCBcclxuICAgIENvbmNlcHRHcmFwaCwgXHJcbiAgICBSZWxhdGVkTm90ZSxcclxuICAgIFBsdWdpbkFQSVxyXG59IGZyb20gJy4vc3JjL3V0aWxzL3R5cGVzJztcclxuXHJcbi8vIEltcG9ydCBpbXBsZW1lbnRhdGlvbnNcclxuaW1wb3J0IHsgQ29uY2VwdEV4dHJhY3RvckltcGwgfSBmcm9tICcuL3NyYy9jb3JlL2NvbmNlcHQtZXh0cmFjdG9yJztcclxuaW1wb3J0IHsgQ29uY2VwdEdyYXBoSW1wbCB9IGZyb20gJy4vc3JjL2NvcmUvY29uY2VwdC1ncmFwaCc7XHJcbmltcG9ydCB7IERhdGFNYW5hZ2VySW1wbCB9IGZyb20gJy4vc3JjL2NvcmUvZGF0YS1tYW5hZ2VyJztcclxuaW1wb3J0IHsgTm90ZVByb2Nlc3NvciB9IGZyb20gJy4vc3JjL3NlcnZpY2VzL25vdGUtcHJvY2Vzc29yJztcclxuaW1wb3J0IHsgU3VtbWFyeUdlbmVyYXRvciB9IGZyb20gJy4vc3JjL3NlcnZpY2VzL3N1bW1hcnktZ2VuZXJhdG9yJztcclxuaW1wb3J0IHsgUmVsYXRlZE5vdGVzVmlldywgUkVMQVRFRF9OT1RFU19WSUVXX1RZUEUgfSBmcm9tICcuL3NyYy91aS9yZWxhdGVkLW5vdGVzLXZpZXcnO1xyXG5pbXBvcnQgeyBLbm93bGVkZ2VTeW50aGVzaXNTZXR0aW5nVGFiIH0gZnJvbSAnLi9zcmMvdWkvc2V0dGluZ3MtdGFiJztcclxuXHJcbi8vIERlZmF1bHQgc2V0dGluZ3NcclxuY29uc3QgREVGQVVMVF9TRVRUSU5HUzogS25vd2xlZGdlU3ludGhlc2lzU2V0dGluZ3MgPSB7XHJcbiAgICBleHRyYWN0aW9uU2Vuc2l0aXZpdHk6IDUsXHJcbiAgICBtYXhSZWxhdGVkTm90ZXM6IDEwLFxyXG4gICAgcmVhbFRpbWVTdWdnZXN0aW9uczogdHJ1ZSxcclxuICAgIGluY2x1ZGVUYWdzOiB0cnVlLFxyXG4gICAgaW5jbHVkZUxpbmtzOiB0cnVlXHJcbn1cclxuXHJcbi8qKlxyXG4gKiBNYWluIHBsdWdpbiBjbGFzcyBmb3IgS25vd2xlZGdlIFN5bnRoZXNpc1xyXG4gKiBDb29yZGluYXRlcyBhbGwgY29tcG9uZW50cyBhbmQgaW50ZWdyYXRlcyB3aXRoIE9ic2lkaWFuXHJcbiAqL1xyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBLbm93bGVkZ2VTeW50aGVzaXNQbHVnaW4gZXh0ZW5kcyBQbHVnaW4gaW1wbGVtZW50cyBQbHVnaW5BUEkgIHtcclxuICAgIC8vIFBsdWdpbiBzZXR0aW5nc1xyXG4gICAgc2V0dGluZ3M6IEtub3dsZWRnZVN5bnRoZXNpc1NldHRpbmdzO1xyXG4gICAgXHJcbiAgICAvLyBDb3JlIGNvbXBvbmVudHNcclxuICAgIHByaXZhdGUgY29uY2VwdEV4dHJhY3RvcjogQ29uY2VwdEV4dHJhY3RvcjtcclxuICAgIHByaXZhdGUgY29uY2VwdEdyYXBoOiBDb25jZXB0R3JhcGg7XHJcbiAgICBwdWJsaWMgZGF0YU1hbmFnZXI6IERhdGFNYW5hZ2VySW1wbDsgLy8gUHVibGljIHNvIGl0IGNhbiBiZSBhY2Nlc3NlZCBieSBTZXR0aW5nc1RhYlxyXG4gICAgXHJcbiAgICAvLyBTZXJ2aWNlc1xyXG4gICAgcHJpdmF0ZSBub3RlUHJvY2Vzc29yOiBOb3RlUHJvY2Vzc29yO1xyXG4gICAgcHJpdmF0ZSBzdW1tYXJ5R2VuZXJhdG9yOiBTdW1tYXJ5R2VuZXJhdG9yO1xyXG4gICAgXHJcbiAgICAvKipcclxuICAgICAqIFBsdWdpbiBpbml0aWFsaXphdGlvblxyXG4gICAgICovXHJcbiAgICBhc3luYyBvbmxvYWQoKSB7XHJcbiAgICAgICAgY29uc29sZS5sb2coJ0xvYWRpbmcgS25vd2xlZGdlIFN5bnRoZXNpcyBwbHVnaW4nKTtcclxuICAgICAgICBcclxuICAgICAgICAvLyBMb2FkIHNldHRpbmdzXHJcbiAgICAgICAgYXdhaXQgdGhpcy5sb2FkU2V0dGluZ3MoKTtcclxuICAgICAgICBcclxuICAgICAgICAvLyBJbml0aWFsaXplIGNvcmUgY29tcG9uZW50c1xyXG4gICAgICAgIHRoaXMuY29uY2VwdEV4dHJhY3RvciA9IG5ldyBDb25jZXB0RXh0cmFjdG9ySW1wbCgpO1xyXG4gICAgICAgIHRoaXMuY29uY2VwdEV4dHJhY3Rvci5zZXRTZW5zaXRpdml0eSh0aGlzLnNldHRpbmdzLmV4dHJhY3Rpb25TZW5zaXRpdml0eSk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgdGhpcy5jb25jZXB0R3JhcGggPSBuZXcgQ29uY2VwdEdyYXBoSW1wbCh0aGlzLmFwcC52YXVsdCk7XHJcbiAgICAgICAgdGhpcy5kYXRhTWFuYWdlciA9IG5ldyBEYXRhTWFuYWdlckltcGwodGhpcyk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gSW5pdGlhbGl6ZSBzZXJ2aWNlc1xyXG4gICAgICAgIHRoaXMubm90ZVByb2Nlc3NvciA9IG5ldyBOb3RlUHJvY2Vzc29yKFxyXG4gICAgICAgICAgICB0aGlzLmFwcC52YXVsdCxcclxuICAgICAgICAgICAgdGhpcy5jb25jZXB0RXh0cmFjdG9yLFxyXG4gICAgICAgICAgICB0aGlzLmNvbmNlcHRHcmFwaCxcclxuICAgICAgICAgICAgKCkgPT4gdGhpcy5kYXRhTWFuYWdlci5zYXZlQ29uY2VwdERhdGEoKVxyXG4gICAgICAgICk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgdGhpcy5zdW1tYXJ5R2VuZXJhdG9yID0gbmV3IFN1bW1hcnlHZW5lcmF0b3IoXHJcbiAgICAgICAgICAgIHRoaXMuYXBwLFxyXG4gICAgICAgICAgICB0aGlzLmNvbmNlcHRHcmFwaCxcclxuICAgICAgICAgICAgKGZpbGUpID0+IHRoaXMuZ2V0UmVsYXRlZE5vdGVzKGZpbGUpXHJcbiAgICAgICAgKTtcclxuICAgICAgICBcclxuICAgICAgICAvLyBMb2FkIHNhdmVkIGRhdGFcclxuICAgICAgICBhd2FpdCB0aGlzLmRhdGFNYW5hZ2VyLmxvYWRDb25jZXB0RGF0YSgpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIFJlZ2lzdGVyIHZpZXcgZm9yIHJlbGF0ZWQgbm90ZXNcclxuICAgICAgICB0aGlzLnJlZ2lzdGVyVmlldyhcclxuICAgICAgICAgICAgUkVMQVRFRF9OT1RFU19WSUVXX1RZUEUsXHJcbiAgICAgICAgICAgIChsZWFmKSA9PiBuZXcgUmVsYXRlZE5vdGVzVmlldyhsZWFmLCB0aGlzKVxyXG4gICAgICAgICk7XHJcblxyXG4gICAgICAgIC8vIEFkZCByaWJib24gaWNvbiBmb3IgcXVpY2sgYWNjZXNzXHJcbiAgICAgICAgdGhpcy5hZGRSaWJib25JY29uKCduZXR3b3JrJywgJ0tub3dsZWRnZSBTeW50aGVzaXMnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuYWN0aXZhdGVWaWV3KCk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIC8vIFJlZ2lzdGVyIGNvbW1hbmRzXHJcbiAgICAgICAgdGhpcy5hZGRDb21tYW5kcygpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIFJlZ2lzdGVyIGV2ZW50IGhhbmRsZXJzXHJcbiAgICAgICAgdGhpcy5yZWdpc3RlckV2ZW50cygpO1xyXG5cclxuICAgICAgICAvLyBBZGQgc2V0dGluZ3MgdGFiXHJcbiAgICAgICAgdGhpcy5hZGRTZXR0aW5nVGFiKG5ldyBLbm93bGVkZ2VTeW50aGVzaXNTZXR0aW5nVGFiKHRoaXMuYXBwLCB0aGlzKSk7XHJcblxyXG4gICAgICAgIC8vIFByb2Nlc3MgZXhpc3Rpbmcgbm90ZXMgaW4gdGhlIHZhdWx0XHJcbiAgICAgICAgdGhpcy5wcm9jZXNzQWxsTm90ZXMoKTtcclxuICAgICAgICBcclxuICAgICAgICBjb25zb2xlLmxvZygnS25vd2xlZGdlIFN5bnRoZXNpcyBwbHVnaW4gbG9hZGVkJyk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBDbGVhbiB1cCB3aGVuIHBsdWdpbiBpcyBkaXNhYmxlZFxyXG4gICAgICovXHJcbiAgICBvbnVubG9hZCgpIHtcclxuICAgICAgICBjb25zb2xlLmxvZygnS25vd2xlZGdlIFN5bnRoZXNpcyBwbHVnaW4gdW5sb2FkZWQnKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIExvYWQgcGx1Z2luIHNldHRpbmdzXHJcbiAgICAgKi9cclxuICAgIGFzeW5jIGxvYWRTZXR0aW5ncygpIHtcclxuICAgICAgICB0aGlzLnNldHRpbmdzID0gT2JqZWN0LmFzc2lnbih7fSwgREVGQVVMVF9TRVRUSU5HUywgYXdhaXQgdGhpcy5sb2FkRGF0YSgpKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFNhdmUgcGx1Z2luIHNldHRpbmdzXHJcbiAgICAgKi9cclxuICAgIGFzeW5jIHNhdmVTZXR0aW5ncygpIHtcclxuICAgICAgICBhd2FpdCB0aGlzLnNhdmVEYXRhKHRoaXMuc2V0dGluZ3MpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIFVwZGF0ZSBleHRyYWN0b3Igc2Vuc2l0aXZpdHkgd2hlbiBzZXR0aW5ncyBjaGFuZ2VcclxuICAgICAgICB0aGlzLmNvbmNlcHRFeHRyYWN0b3Iuc2V0U2Vuc2l0aXZpdHkodGhpcy5zZXR0aW5ncy5leHRyYWN0aW9uU2Vuc2l0aXZpdHkpO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvKipcclxuICAgICAqIEFkZCBwbHVnaW4gY29tbWFuZHMgdG8gT2JzaWRpYW4gY29tbWFuZCBwYWxldHRlXHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgYWRkQ29tbWFuZHMoKSB7XHJcbiAgICAgICAgLy8gQ29tbWFuZCB0byBleHRyYWN0IGNvbmNlcHRzIGZyb20gY3VycmVudCBub3RlXHJcbiAgICAgICAgdGhpcy5hZGRDb21tYW5kKHtcclxuICAgICAgICAgICAgaWQ6ICdleHRyYWN0LWNvbmNlcHRzJyxcclxuICAgICAgICAgICAgbmFtZTogJ0V4dHJhY3QgQ29uY2VwdHMgZnJvbSBDdXJyZW50IE5vdGUnLFxyXG4gICAgICAgICAgICBjaGVja0NhbGxiYWNrOiAoY2hlY2tpbmc6IGJvb2xlYW4pID0+IHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGFjdGl2ZVZpZXcgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlVmlld09mVHlwZShNYXJrZG93blZpZXcpO1xyXG4gICAgICAgICAgICAgICAgaWYgKGFjdGl2ZVZpZXcpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoIWNoZWNraW5nKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucHJvY2Vzc0N1cnJlbnROb3RlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gQ29tbWFuZCB0byBzaG93IHJlbGF0ZWQgbm90ZXNcclxuICAgICAgICB0aGlzLmFkZENvbW1hbmQoe1xyXG4gICAgICAgICAgICBpZDogJ3Nob3ctcmVsYXRlZC1ub3RlcycsXHJcbiAgICAgICAgICAgIG5hbWU6ICdTaG93IFJlbGF0ZWQgTm90ZXMnLFxyXG4gICAgICAgICAgICBjaGVja0NhbGxiYWNrOiAoY2hlY2tpbmc6IGJvb2xlYW4pID0+IHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGFjdGl2ZVZpZXcgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlVmlld09mVHlwZShNYXJrZG93blZpZXcpO1xyXG4gICAgICAgICAgICAgICAgaWYgKGFjdGl2ZVZpZXcpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoIWNoZWNraW5nKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYWN0aXZhdGVWaWV3KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gQ29tbWFuZCB0byBnZW5lcmF0ZSBzdW1tYXJ5IGZyb20gcmVsYXRlZCBub3Rlc1xyXG4gICAgICAgIHRoaXMuYWRkQ29tbWFuZCh7XHJcbiAgICAgICAgICAgIGlkOiAnZ2VuZXJhdGUtc3VtbWFyeScsXHJcbiAgICAgICAgICAgIG5hbWU6ICdHZW5lcmF0ZSBTdW1tYXJ5IGZyb20gUmVsYXRlZCBOb3RlcycsXHJcbiAgICAgICAgICAgIGNoZWNrQ2FsbGJhY2s6IChjaGVja2luZzogYm9vbGVhbikgPT4ge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgYWN0aXZlVmlldyA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVWaWV3T2ZUeXBlKE1hcmtkb3duVmlldyk7XHJcbiAgICAgICAgICAgICAgICBpZiAoYWN0aXZlVmlldyAmJiBhY3RpdmVWaWV3LmZpbGUpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoIWNoZWNraW5nKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZ2VuZXJhdGVTdW1tYXJ5KGFjdGl2ZVZpZXcuZmlsZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8qKlxyXG4gICAgICogUmVnaXN0ZXIgZXZlbnQgaGFuZGxlcnNcclxuICAgICAqL1xyXG4gICAgcHJpdmF0ZSByZWdpc3RlckV2ZW50cygpIHtcclxuICAgICAgICAvLyBQcm9jZXNzIG5vdGUgd2hlbiBpdCdzIHNhdmVkXHJcbiAgICAgICAgdGhpcy5yZWdpc3RlckV2ZW50KFxyXG4gICAgICAgICAgICB0aGlzLmFwcC52YXVsdC5vbignbW9kaWZ5JywgKGZpbGUpID0+IHtcclxuICAgICAgICAgICAgICAgIGlmIChmaWxlIGluc3RhbmNlb2YgVEZpbGUgJiYgZmlsZS5leHRlbnNpb24gPT09ICdtZCcpIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyBPbmx5IHByb2Nlc3MgaWYgcmVhbFRpbWVTdWdnZXN0aW9ucyBpcyBlbmFibGVkXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuc2V0dGluZ3MucmVhbFRpbWVTdWdnZXN0aW9ucykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm5vdGVQcm9jZXNzb3IucHJvY2Vzc05vdGUoZmlsZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gUmVtb3ZlIG5vdGUgZnJvbSBncmFwaCB3aGVuIGRlbGV0ZWRcclxuICAgICAgICB0aGlzLnJlZ2lzdGVyRXZlbnQoXHJcbiAgICAgICAgICAgIHRoaXMuYXBwLnZhdWx0Lm9uKCdkZWxldGUnLCAoZmlsZSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYgKGZpbGUgaW5zdGFuY2VvZiBURmlsZSAmJiBmaWxlLmV4dGVuc2lvbiA9PT0gJ21kJykge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY29uY2VwdEdyYXBoLnJlbW92ZU5vdGUoZmlsZS5wYXRoKTtcclxuICAgICAgICAgICAgICAgICAgICAvLyBTYXZlIGNoYW5nZXNcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmRhdGFNYW5hZ2VyLnNhdmVDb25jZXB0RGF0YSgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gVXBkYXRlIHdoZW4gYSBmaWxlIGlzIHJlbmFtZWRcclxuICAgICAgICB0aGlzLnJlZ2lzdGVyRXZlbnQoXHJcbiAgICAgICAgICAgIHRoaXMuYXBwLnZhdWx0Lm9uKCdyZW5hbWUnLCAoZmlsZSwgb2xkUGF0aCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYgKGZpbGUgaW5zdGFuY2VvZiBURmlsZSAmJiBmaWxlLmV4dGVuc2lvbiA9PT0gJ21kJykge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIFJlbW92ZSBvbGQgcGF0aCBhbmQgYWRkIHdpdGggbmV3IHBhdGhcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmNvbmNlcHRHcmFwaC5yZW1vdmVOb3RlKG9sZFBhdGgpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMubm90ZVByb2Nlc3Nvci5wcm9jZXNzTm90ZShmaWxlKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSlcclxuICAgICAgICApO1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIFByb2Nlc3MgY3VycmVudCBub3RlIHdoZW4gYWN0aXZlIGxlYWYgY2hhbmdlc1xyXG4gICAgICAgIHRoaXMucmVnaXN0ZXJFdmVudChcclxuICAgICAgICAgICAgdGhpcy5hcHAud29ya3NwYWNlLm9uKCdhY3RpdmUtbGVhZi1jaGFuZ2UnLCAobGVhZikgPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYgKGxlYWY/LnZpZXcgaW5zdGFuY2VvZiBNYXJrZG93blZpZXcgJiYgdGhpcy5zZXR0aW5ncy5yZWFsVGltZVN1Z2dlc3Rpb25zKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wcm9jZXNzQ3VycmVudE5vdGUoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSlcclxuICAgICAgICApO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvKipcclxuICAgICAqIFByb2Nlc3MgdGhlIGN1cnJlbnQgYWN0aXZlIG5vdGVcclxuICAgICAqL1xyXG4gICAgcHJpdmF0ZSBhc3luYyBwcm9jZXNzQ3VycmVudE5vdGUoKSB7XHJcbiAgICAgICAgY29uc3QgYWN0aXZlVmlldyA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVWaWV3T2ZUeXBlKE1hcmtkb3duVmlldyk7XHJcbiAgICAgICAgaWYgKGFjdGl2ZVZpZXcgJiYgYWN0aXZlVmlldy5maWxlKSB7XHJcbiAgICAgICAgICAgIGF3YWl0IHRoaXMubm90ZVByb2Nlc3Nvci5wcm9jZXNzTm90ZShhY3RpdmVWaWV3LmZpbGUpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgLy8gVXBkYXRlIHJlbGF0ZWQgbm90ZXMgdmlldyBpZiBpdCdzIG9wZW5cclxuICAgICAgICAgICAgdGhpcy51cGRhdGVSZWxhdGVkTm90ZXNWaWV3KGFjdGl2ZVZpZXcuZmlsZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvKipcclxuICAgICAqIEFjdGl2YXRlIHRoZSByZWxhdGVkIG5vdGVzIHZpZXdcclxuICAgICAqL1xyXG4gICAgcHJpdmF0ZSBhc3luYyBhY3RpdmF0ZVZpZXcoKSB7XHJcbiAgICAgICAgLy8gQ2hlY2sgaWYgdmlldyBpcyBhbHJlYWR5IG9wZW5cclxuICAgICAgICBjb25zdCBsZWF2ZXMgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0TGVhdmVzT2ZUeXBlKFJFTEFURURfTk9URVNfVklFV19UWVBFKTtcclxuICAgICAgICBcclxuICAgICAgICBpZiAobGVhdmVzLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICAgICAgICAvLyBDcmVhdGUgdGhlIHZpZXcgaWYgaXQgZG9lc24ndCBleGlzdFxyXG4gICAgICAgICAgICBjb25zdCBsZWFmID0gdGhpcy5hcHAud29ya3NwYWNlLmdldFJpZ2h0TGVhZihmYWxzZSk7XHJcbiAgICAgICAgICAgIGlmIChsZWFmKSB7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCBsZWFmLnNldFZpZXdTdGF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogUkVMQVRFRF9OT1RFU19WSUVXX1RZUEUsXHJcbiAgICAgICAgICAgICAgICAgICAgYWN0aXZlOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gRm9jdXMgdGhlIHZpZXdcclxuICAgICAgICBjb25zdCBleGlzdGluZ0xlYXZlcyA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRMZWF2ZXNPZlR5cGUoUkVMQVRFRF9OT1RFU19WSUVXX1RZUEUpO1xyXG4gICAgICAgIGlmIChleGlzdGluZ0xlYXZlcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgIHRoaXMuYXBwLndvcmtzcGFjZS5yZXZlYWxMZWFmKGV4aXN0aW5nTGVhdmVzWzBdKTtcclxuICAgICAgICBcclxuICAgICAgICAgICAgLy8gVXBkYXRlIHdpdGggY3VycmVudCBmaWxlXHJcbiAgICAgICAgICAgIGNvbnN0IGFjdGl2ZVZpZXcgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlVmlld09mVHlwZShNYXJrZG93blZpZXcpO1xyXG4gICAgICAgICAgICBpZiAoYWN0aXZlVmlldyAmJiBhY3RpdmVWaWV3LmZpbGUpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlUmVsYXRlZE5vdGVzVmlldyhhY3RpdmVWaWV3LmZpbGUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvKipcclxuICAgICAqIFVwZGF0ZSB0aGUgcmVsYXRlZCBub3RlcyB2aWV3IHdpdGggZGF0YSBmb3IgYSBmaWxlXHJcbiAgICAgKiBAcGFyYW0gZmlsZSBGaWxlIHRvIHNob3cgcmVsYXRlZCBub3RlcyBmb3JcclxuICAgICAqL1xyXG4gICAgcHJpdmF0ZSB1cGRhdGVSZWxhdGVkTm90ZXNWaWV3KGZpbGU6IFRGaWxlKSB7XHJcbiAgICAgICAgY29uc3QgbGVhdmVzID0gdGhpcy5hcHAud29ya3NwYWNlLmdldExlYXZlc09mVHlwZShSRUxBVEVEX05PVEVTX1ZJRVdfVFlQRSk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgaWYgKGxlYXZlcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHZpZXcgPSBsZWF2ZXNbMF0udmlldyBhcyBSZWxhdGVkTm90ZXNWaWV3O1xyXG4gICAgICAgICAgICBjb25zdCByZWxhdGVkTm90ZXMgPSB0aGlzLmNvbmNlcHRHcmFwaC5maW5kUmVsYXRlZE5vdGVzKFxyXG4gICAgICAgICAgICAgICAgZmlsZS5wYXRoLCBcclxuICAgICAgICAgICAgICAgIHRoaXMuc2V0dGluZ3MubWF4UmVsYXRlZE5vdGVzXHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICB2aWV3LnVwZGF0ZVJlbGF0ZWROb3RlcyhmaWxlLCByZWxhdGVkTm90ZXMpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIFxyXG4gICAgLyoqXHJcbiAgICAgKiBQcm9jZXNzIGFsbCBleGlzdGluZyBub3RlcyBpbiB0aGUgdmF1bHRcclxuICAgICAqIFB1YmxpYyBmb3Igc2V0dGluZ3MgdGFiIGFjY2Vzc1xyXG4gICAgICovXHJcbiAgICBwdWJsaWMgYXN5bmMgcHJvY2Vzc0FsbE5vdGVzKCk6IFByb21pc2U8dm9pZD4ge1xyXG4gICAgICAgIGF3YWl0IHRoaXMubm90ZVByb2Nlc3Nvci5wcm9jZXNzQWxsTm90ZXMoKTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgLyoqXHJcbiAgICAgKiBDbGVhciBhbGwgc3RvcmVkIGRhdGFcclxuICAgICAqIFB1YmxpYyBmb3Igc2V0dGluZ3MgdGFiIGFjY2Vzc1xyXG4gICAgICovXHJcbiAgICBwdWJsaWMgYXN5bmMgY2xlYXJEYXRhKCk6IFByb21pc2U8dm9pZD4ge1xyXG4gICAgICAgIGF3YWl0IHRoaXMuZGF0YU1hbmFnZXIuY2xlYXJEYXRhKCk7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8qKlxyXG4gICAgICogQVBJIG1ldGhvZDogR2V0IHJlbGF0ZWQgbm90ZXMgZm9yIGEgZmlsZVxyXG4gICAgICogQHBhcmFtIGZpbGUgRmlsZSB0byBmaW5kIHJlbGF0ZWQgbm90ZXMgZm9yXHJcbiAgICAgKiBAcmV0dXJucyBBcnJheSBvZiByZWxhdGVkIG5vdGVzXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBhc3luYyBnZXRSZWxhdGVkTm90ZXMoZmlsZTogVEZpbGUpOiBQcm9taXNlPFJlbGF0ZWROb3RlW10+IHtcclxuICAgICAgICByZXR1cm4gdGhpcy5jb25jZXB0R3JhcGguZmluZFJlbGF0ZWROb3RlcyhcclxuICAgICAgICAgICAgZmlsZS5wYXRoLCBcclxuICAgICAgICAgICAgdGhpcy5zZXR0aW5ncy5tYXhSZWxhdGVkTm90ZXNcclxuICAgICAgICApO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvKipcclxuICAgICAqIEFQSSBtZXRob2Q6IEV4dHJhY3QgY29uY2VwdHMgZnJvbSBjb250ZW50XHJcbiAgICAgKiBAcGFyYW0gY29udGVudCBUZXh0IGNvbnRlbnQgdG8gYW5hbHl6ZVxyXG4gICAgICogQHJldHVybnMgQXJyYXkgb2YgZXh0cmFjdGVkIGNvbmNlcHRzXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBleHRyYWN0Q29uY2VwdHMoY29udGVudDogc3RyaW5nKTogc3RyaW5nW10ge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmNvbmNlcHRFeHRyYWN0b3IuZXh0cmFjdENvbmNlcHRzKGNvbnRlbnQpO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvKipcclxuICAgICAqIEFQSSBtZXRob2Q6IEFkZCBhIGNvbmNlcHQgdG8gYSBub3RlICh1c2VkIGJ5IFVJIHdoZW4gdXNlciBhZGRzIGEgY29uY2VwdClcclxuICAgICAqIEBwYXJhbSBmaWxlUGF0aCBQYXRoIHRvIHRoZSBmaWxlXHJcbiAgICAgKiBAcGFyYW0gY29uY2VwdCBDb25jZXB0IHRvIGFkZFxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgYXN5bmMgYWRkQ29uY2VwdFRvTm90ZShmaWxlUGF0aDogc3RyaW5nLCBjb25jZXB0OiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcclxuICAgICAgICAvLyBHZXQgY3VycmVudCBjb25jZXB0c1xyXG4gICAgICAgIGNvbnN0IGNvbmNlcHRzID0gdGhpcy5jb25jZXB0R3JhcGguZ2V0Tm90ZUNvbmNlcHRzKGZpbGVQYXRoKTtcclxuICAgICAgICBcclxuICAgICAgICAvLyBBZGQgbmV3IGNvbmNlcHQgaWYgbm90IGFscmVhZHkgcHJlc2VudFxyXG4gICAgICAgIGlmICghY29uY2VwdHMuaW5jbHVkZXMoY29uY2VwdCkpIHtcclxuICAgICAgICAgICAgY29uY2VwdHMucHVzaChjb25jZXB0KTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIFVwZGF0ZSB0aGUgZ3JhcGhcclxuICAgICAgICAgICAgdGhpcy5jb25jZXB0R3JhcGguYWRkTm90ZShmaWxlUGF0aCwgY29uY2VwdHMpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgLy8gU2F2ZSBjaGFuZ2VzXHJcbiAgICAgICAgICAgIGF3YWl0IHRoaXMuZGF0YU1hbmFnZXIuc2F2ZUNvbmNlcHREYXRhKCk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyBOb3RpZnkgc3VjY2Vzc1xyXG4gICAgICAgICAgICBuZXcgTm90aWNlKGBBZGRlZCBjb25jZXB0IFwiJHtjb25jZXB0fVwiIHRvIG5vdGVgKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8qKlxyXG4gICAgICogQVBJIG1ldGhvZDogR2VuZXJhdGUgYSBzdW1tYXJ5IGZyb20gcmVsYXRlZCBub3Rlc1xyXG4gICAgICogQHBhcmFtIGZpbGUgRmlsZSB0byBnZW5lcmF0ZSBzdW1tYXJ5IGZvclxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgZ2VuZXJhdGVTdW1tYXJ5KGZpbGU6IFRGaWxlKTogUHJvbWlzZTxzdHJpbmc+IHtcclxuICAgICAgICByZXR1cm4gdGhpcy5zdW1tYXJ5R2VuZXJhdG9yLmdlbmVyYXRlU3VtbWFyeShmaWxlKTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgLyoqXHJcbiAgICAgKiBBUEkgbWV0aG9kOiBHZXQgcGx1Z2luIHNldHRpbmdzXHJcbiAgICAgKiBAcmV0dXJucyBDdXJyZW50IHBsdWdpbiBzZXR0aW5nc1xyXG4gICAgICovXHJcbiAgICBwdWJsaWMgZ2V0U2V0dGluZ3MoKTogS25vd2xlZGdlU3ludGhlc2lzU2V0dGluZ3Mge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnNldHRpbmdzO1xyXG4gICAgfVxyXG4gICAgdXBkYXRlTm90ZUNvbmNlcHRzKHBhdGg6IHN0cmluZywgY29uY2VwdHM6IHN0cmluZ1tdKTogdm9pZCB7XHJcbiAgICAodGhpcy5jb25jZXB0R3JhcGggYXMgQ29uY2VwdEdyYXBoSW1wbCkudXBkYXRlTm90ZUNvbmNlcHRzKHBhdGgsIGNvbmNlcHRzKTtcclxuXHJcbn1cclxuXHJcbn0iLCAiaW1wb3J0IHsgVGV4dFByb2Nlc3NvciB9IGZyb20gJy4vdHlwZXMnO1xyXG5cclxuLy9JbXBsZW1lbnRhdGlvbiBvZiB0ZXh0IHByb2Nlc3NpbmcgdXRpbGl0aWVzIGZvciBOTFBcclxuXHJcbmV4cG9ydCBjbGFzcyBUZXh0UHJvY2Vzc2luZ1V0aWxzIGltcGxlbWVudHMgVGV4dFByb2Nlc3NvciB7XHJcbiAgICAvL0NvbW1vbiBFbmdsaXNoIHN0b3Agd29yZHMgdG8gZmlsdGVyIG91dFxyXG4gICAgcHJpdmF0ZSBzdG9wV29yZHM6IFNldDxzdHJpbmc+ID0gbmV3IFNldChbXHJcbiAgICAgICAgJ2EnLCAnYW4nLCAndGhlJywgJ2FuZCcsICdvcicsICdidXQnLCAnaXMnLCAnYXJlJywgJ3dhcycsICd3ZXJlJywgXHJcbiAgICAgICAgJ2JlJywgJ2JlZW4nLCAnYmVpbmcnLCAnaGF2ZScsICdoYXMnLCAnaGFkJywgJ2RvJywgJ2RvZXMnLCAnZGlkJyxcclxuICAgICAgICAnb2YnLCAnYXMnLCAnbGlrZScsICdpZicsICd0aGF0JywgJ3lvdScsICd3aXRoJywgJ3lvdXInLCAndGhyb3VnaCcsXHJcbiAgICAgICAgJ3RvJywgJ2Zyb20nLCAnaW4nLCAnb3V0JywgJ29uJywgJ29mZicsICdvdmVyJywgJ3VuZGVyJywgJ2FnYWluJyxcclxuICAgICAgICAnZnVydGhlcicsICd0aGVuJywgJ29uY2UnLCAnaGVyZScsICd0aGVyZScsICd3aGVuJywgJ3doZXJlJywgJ3doeScsXHJcbiAgICAgICAgJ2hvdycsICdhbGwnLCAnYW55JywgJ2JvdGgnLCAnZWFjaCcsICdmZXcnLCAnbW9yZScsICdtb3N0JywgJ290aGVyJyxcclxuICAgICAgICAnc29tZScsICdzdWNoJywgJ25vJywgJ25vcicsICdub3QnLCAnb25seScsICdvd24nLCAnc2FtZScsICdzbycsIFxyXG4gICAgICAgICd0aGFuJywgJ3RvbycsICd2ZXJ5JywgJ2NhbicsICd3aWxsJywgJ2p1c3QnLCAnc2hvdWxkJywgJ25vdydcclxuICAgIF0pO1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogVG9rZW5pemUgdGV4dCBpbnRvIHdvcmRzXHJcbiAgICAgKiBAcGFyYW0gdGV4dCBJbnB1dCB0ZXh0IHRvIHRva2VuaXplXHJcbiAgICAgKiBAcmV0dXJucyBBcnJheSBvZiB0b2tlbnNcclxuICAgICAqL1xyXG4gICAgcHVibGljIHRva2VuaXplKHRleHQ6IHN0cmluZyk6IHN0cmluZ1tdIHtcclxuICAgICAgICAvL1JlbW92ZSBzcGVjaWFsIGNoYXJhY3RlcnMgYW5kIHRva2VuaXplXHJcbiAgICAgICAgY29uc3Qgbm9ybWFsaXplZCA9IHRleHQudG9Mb3dlckNhc2UoKVxyXG4gICAgICAgICAgICAucmVwbGFjZSgvW15cXHdcXHNdL2csICcgJykgIC8vUmVwbGFjZSBzcGVjaWFsIGNoYXJzIHdpdGggc3BhY2VcclxuICAgICAgICAgICAgLnJlcGxhY2UoL1xccysvZywgJyAnKSAgICAgIC8vUmVwbGFjZSBtdWx0aXBsZSBzcGFjZXMgd2l0aCBzaW5nbGUgc3BhY2VcclxuICAgICAgICAgICAgLnRyaW0oKTsgICAgICAgICAgICAgICAgICAgLy9UcmltIGxlYWRpbmcvdHJhaWxpbmcgc3BhY2VzXHJcbiAgICAgICAgXHJcbiAgICAgICAgcmV0dXJuIG5vcm1hbGl6ZWQuc3BsaXQoJyAnKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIENhbGN1bGF0ZSB0ZXJtIGZyZXF1ZW5jeSBmb3IgdG9rZW5zXHJcbiAgICAgKiBAcGFyYW0gdG9rZW5zIEFycmF5IG9mIHRva2Vuc1xyXG4gICAgICogQHJldHVybnMgTWFwIG9mIHRlcm1zIHRvIHRoZWlyIGZyZXF1ZW5jeVxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgY2FsY3VsYXRlVGVybUZyZXF1ZW5jeSh0b2tlbnM6IHN0cmluZ1tdKTogTWFwPHN0cmluZywgbnVtYmVyPiB7XHJcbiAgICAgICAgY29uc3QgdGVybUZyZXF1ZW5jeSA9IG5ldyBNYXA8c3RyaW5nLCBudW1iZXI+KCk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgZm9yIChjb25zdCB0b2tlbiBvZiB0b2tlbnMpIHtcclxuICAgICAgICAgICAgY29uc3QgY291bnQgPSB0ZXJtRnJlcXVlbmN5LmdldCh0b2tlbikgfHwgMDtcclxuICAgICAgICAgICAgdGVybUZyZXF1ZW5jeS5zZXQodG9rZW4sIGNvdW50ICsgMSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgIHJldHVybiB0ZXJtRnJlcXVlbmN5O1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogUmVtb3ZlIGNvbW1vbiBzdG9wIHdvcmRzIGZyb20gdG9rZW5zXHJcbiAgICAgKiBAcGFyYW0gdG9rZW5zIEFycmF5IG9mIHRva2Vuc1xyXG4gICAgICogQHJldHVybnMgRmlsdGVyZWQgYXJyYXkgd2l0aCBzdG9wIHdvcmRzIHJlbW92ZWRcclxuICAgICAqL1xyXG4gICAgcHVibGljIHJlbW92ZVN0b3BXb3Jkcyh0b2tlbnM6IHN0cmluZ1tdKTogc3RyaW5nW10ge1xyXG4gICAgICAgIHJldHVybiB0b2tlbnMuZmlsdGVyKHRva2VuID0+ICF0aGlzLnN0b3BXb3Jkcy5oYXModG9rZW4pICYmIHRva2VuLmxlbmd0aCA+IDEpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQmFzaWMgc3RlbW1pbmcgYWxnb3JpdGhtIGZvciBFbmdsaXNoXHJcbiAgICAgKiBJbXBsZW1lbnRzIGEgc2ltcGxlIHZlcnNpb24gb2YgUG9ydGVyIHN0ZW1taW5nXHJcbiAgICAgKiBAcGFyYW0gdG9rZW5zIEFycmF5IG9mIHRva2Vuc1xyXG4gICAgICogQHJldHVybnMgQXJyYXkgb2Ygc3RlbW1lZCB0b2tlbnNcclxuICAgICAqL1xyXG4gICAgcHVibGljIHN0ZW1Xb3Jkcyh0b2tlbnM6IHN0cmluZ1tdKTogc3RyaW5nW10ge1xyXG4gICAgICAgIHJldHVybiB0b2tlbnMubWFwKHRva2VuID0+IHtcclxuICAgICAgICAgICAgLy8gQmFzaWMgc3RlbW1pbmcgcnVsZXMgKHNpbXBsaWZpZWQpXHJcbiAgICAgICAgICAgIGlmICh0b2tlbi5lbmRzV2l0aCgnaW5nJykpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0b2tlbi5zbGljZSgwLCAtMyk7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAodG9rZW4uZW5kc1dpdGgoJ2x5JykpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0b2tlbi5zbGljZSgwLCAtMik7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAodG9rZW4uZW5kc1dpdGgoJ3MnKSAmJiAhdG9rZW4uZW5kc1dpdGgoJ3NzJykpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0b2tlbi5zbGljZSgwLCAtMSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAodG9rZW4uZW5kc1dpdGgoJ2VkJykgJiYgdG9rZW4ubGVuZ3RoID4gNCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRva2VuLnNsaWNlKDAsIC0yKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0b2tlbjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogRXh0cmFjdCBwb3RlbnRpYWwgbmFtZWQgZW50aXRpZXMgZnJvbSB0ZXh0XHJcbiAgICAgKiBWZXJ5IHNpbXBsaWZpZWQgaW1wbGVtZW50YXRpb24gZm9yIHByb29mIG9mIGNvbmNlcHRcclxuICAgICAqIEBwYXJhbSB0ZXh0IElucHV0IHRleHRcclxuICAgICAqIEByZXR1cm5zIEFycmF5IG9mIHBvdGVudGlhbCBuYW1lZCBlbnRpdGllc1xyXG4gICAgICovXHJcbiAgICBwdWJsaWMgZXh0cmFjdE5hbWVkRW50aXRpZXModGV4dDogc3RyaW5nKTogc3RyaW5nW10ge1xyXG4gICAgICAgIGNvbnN0IHNlbnRlbmNlcyA9IHRleHQuc3BsaXQoL1suIT9dKy8pO1xyXG4gICAgICAgIGNvbnN0IGVudGl0aWVzOiBzdHJpbmdbXSA9IFtdO1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vU2ltcGxlIG5hbWVkIGVudGl0eSBkZXRlY3Rpb24gYmFzZWQgb24gY2FwaXRhbGl6YXRpb24gaS5lLiB0aGlzIGNoZWNrcyBmb3IgbmFtZXNcclxuICAgICAgICBmb3IgKGNvbnN0IHNlbnRlbmNlIG9mIHNlbnRlbmNlcykge1xyXG4gICAgICAgICAgICBjb25zdCB3b3JkcyA9IHNlbnRlbmNlLnRyaW0oKS5zcGxpdCgnICcpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB3b3Jkcy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgY29uc3Qgd29yZCA9IHdvcmRzW2ldO1xyXG4gICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAvL1NraXAgZmlyc3Qgd29yZCBvZiBzZW50ZW5jZSBhbmQgY2hlY2sgZm9yIGNhcGl0YWxpemF0aW9uXHJcbiAgICAgICAgICAgICAgICBpZiAoaSA+IDAgJiYgd29yZC5sZW5ndGggPiAxICYmIC9eW0EtWl1bYS16XSskLy50ZXN0KHdvcmQpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZW50aXRpZXMucHVzaCh3b3JkKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgLy9DaGVjayBmb3IgY29uc2VjdXRpdmUgY2FwaXRhbGl6ZWQgd29yZHMgKGNvbXBvdW5kIGVudGl0aWVzKVxyXG4gICAgICAgICAgICAgICAgaWYgKGkgPCB3b3Jkcy5sZW5ndGggLSAxICYmIFxyXG4gICAgICAgICAgICAgICAgICAgIHdvcmQubGVuZ3RoID4gMSAmJiBcclxuICAgICAgICAgICAgICAgICAgICAvXltBLVpdW2Etel0rJC8udGVzdCh3b3JkKSAmJiBcclxuICAgICAgICAgICAgICAgICAgICAvXltBLVpdW2Etel0rJC8udGVzdCh3b3Jkc1tpKzFdKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGVudGl0aWVzLnB1c2goYCR7d29yZH0gJHt3b3Jkc1tpKzFdfWApO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgIHJldHVybiBbLi4ubmV3IFNldChlbnRpdGllcyldOy8vUmVtb3ZlIGR1cGxpY2F0ZXNcclxuICAgIH1cclxufSIsICJpbXBvcnQgeyBDb25jZXB0RXh0cmFjdG9yIH0gZnJvbSAnc3JjL3V0aWxzL3R5cGVzJztcclxuaW1wb3J0IHsgVGV4dFByb2Nlc3NpbmdVdGlscyB9IGZyb20gJ3NyYy91dGlscy90ZXh0LXByb2Nlc3NpbmcnO1xyXG5cclxuLyoqXHJcbiAqIEltcGxlbWVudGF0aW9uIG9mIENvbmNlcHQgRXh0cmFjdGlvbiB1c2luZyBOTFAgdGVjaG5pcXVlc1xyXG4gKi9cclxuZXhwb3J0IGNsYXNzIENvbmNlcHRFeHRyYWN0b3JJbXBsIGltcGxlbWVudHMgQ29uY2VwdEV4dHJhY3RvciB7XHJcbiAgICBwcml2YXRlIHNlbnNpdGl2aXR5OiBudW1iZXIgPSA1OyAvL0RlZmF1bHQgc2Vuc2l0aXZpdHkgKDEtMTApXHJcbiAgICBwcml2YXRlIHRleHRQcm9jZXNzb3I6IFRleHRQcm9jZXNzaW5nVXRpbHM7XHJcbiAgICBwcml2YXRlIHVzZXJGZWVkYmFjazogTWFwPHN0cmluZywgYm9vbGVhbj4gPSBuZXcgTWFwKCk7IC8vU3RvcmUgdXNlciBmZWVkYmFjayBvbiBjb25jZXB0c1xyXG4gICAgXHJcbiAgICBjb25zdHJ1Y3RvcigpIHtcclxuICAgICAgICB0aGlzLnRleHRQcm9jZXNzb3IgPSBuZXcgVGV4dFByb2Nlc3NpbmdVdGlscygpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogRXh0cmFjdCBjb25jZXB0cyBmcm9tIHRleHQgY29udGVudFxyXG4gICAgICogQHBhcmFtIGNvbnRlbnQgVGV4dCBjb250ZW50IHRvIGFuYWx5emVcclxuICAgICAqIEByZXR1cm5zIEFycmF5IG9mIGV4dHJhY3RlZCBjb25jZXB0c1xyXG4gICAgICovXHJcbiAgICBwdWJsaWMgZXh0cmFjdENvbmNlcHRzKGNvbnRlbnQ6IHN0cmluZyk6IHN0cmluZ1tdIHtcclxuICAgICAgICAvL1NraXAgZW1wdHkgY29udGVudFxyXG4gICAgICAgIGlmICghY29udGVudCB8fCBjb250ZW50LnRyaW0oKSA9PT0gJycpIHtcclxuICAgICAgICAgICAgcmV0dXJuIFtdO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gRXh0cmFjdCBjb25jZXB0cyB1c2luZyBtdWx0aXBsZSB0ZWNobmlxdWVzXHJcbiAgICAgICAgY29uc3QgY29uY2VwdHM6IHN0cmluZ1tdID0gW1xyXG4gICAgICAgICAgICAuLi50aGlzLmV4dHJhY3RGcm9tVGZJZGYoY29udGVudCksXHJcbiAgICAgICAgICAgIC4uLnRoaXMuZXh0cmFjdEZyb21IZWFkaW5ncyhjb250ZW50KSxcclxuICAgICAgICAgICAgLi4udGhpcy5leHRyYWN0RnJvbUVtcGhhc2lzKGNvbnRlbnQpLFxyXG4gICAgICAgICAgICAuLi50aGlzLmV4dHJhY3RGcm9tTmFtZWRFbnRpdGllcyhjb250ZW50KVxyXG4gICAgICAgIF07XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy9BcHBseSB1c2VyIGZlZWRiYWNrXHJcbiAgICAgICAgY29uc3QgZmlsdGVyZWRDb25jZXB0cyA9IGNvbmNlcHRzLmZpbHRlcihjb25jZXB0ID0+IHtcclxuICAgICAgICAgICAgY29uc3QgZmVlZGJhY2sgPSB0aGlzLnVzZXJGZWVkYmFjay5nZXQoY29uY2VwdCk7XHJcbiAgICAgICAgICAgIC8vSWYgd2UgaGF2ZSBleHBsaWNpdCBuZWdhdGl2ZSBmZWVkYmFjaywgZmlsdGVyIGl0IG91dFxyXG4gICAgICAgICAgICBpZiAoZmVlZGJhY2sgPT09IGZhbHNlKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy9SZW1vdmUgZHVwbGljYXRlcyBhbmQgcmV0dXJuIHNvcnRlZCBieSBpbXBvcnRhbmNlXHJcbiAgICAgICAgcmV0dXJuIFsuLi5uZXcgU2V0KGZpbHRlcmVkQ29uY2VwdHMpXTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFNldCBzZW5zaXRpdml0eSBmb3IgZXh0cmFjdGlvbiAoMS0xMClcclxuICAgICAqIEBwYXJhbSBzZW5zaXRpdml0eSBTZW5zaXRpdml0eSBsZXZlbCAoMS0xMClcclxuICAgICAqL1xyXG4gICAgcHVibGljIHNldFNlbnNpdGl2aXR5KHNlbnNpdGl2aXR5OiBudW1iZXIpOiB2b2lkIHtcclxuICAgICAgICAvLyBFbnN1cmUgc2Vuc2l0aXZpdHkgaXMgd2l0aGluIHZhbGlkIHJhbmdlXHJcbiAgICAgICAgdGhpcy5zZW5zaXRpdml0eSA9IE1hdGgubWF4KDEsIE1hdGgubWluKDEwLCBzZW5zaXRpdml0eSkpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogTGVhcm4gZnJvbSB1c2VyIGZlZWRiYWNrIG9uIGNvbmNlcHQgcmVsZXZhbmNlXHJcbiAgICAgKiBAcGFyYW0gY29uY2VwdCBUaGUgY29uY2VwdCByZWNlaXZpbmcgZmVlZGJhY2tcclxuICAgICAqIEBwYXJhbSBpc1JlbGV2YW50IFdoZXRoZXIgdGhlIHVzZXIgbWFya2VkIGl0IGFzIHJlbGV2YW50XHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBsZWFybkZyb21Vc2VyRmVlZGJhY2soY29uY2VwdDogc3RyaW5nLCBpc1JlbGV2YW50OiBib29sZWFuKTogdm9pZCB7XHJcbiAgICAgICAgdGhpcy51c2VyRmVlZGJhY2suc2V0KGNvbmNlcHQsIGlzUmVsZXZhbnQpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogRXh0cmFjdCBjb25jZXB0cyB1c2luZyBURi1JREYgbGlrZSBhcHByb2FjaFxyXG4gICAgICogQHBhcmFtIGNvbnRlbnQgVGV4dCBjb250ZW50IHRvIGFuYWx5emVcclxuICAgICAqIEByZXR1cm5zIEFycmF5IG9mIGNvbmNlcHRzXHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgZXh0cmFjdEZyb21UZklkZihjb250ZW50OiBzdHJpbmcpOiBzdHJpbmdbXSB7XHJcbiAgICAgICAgLy9Ub2tlbml6ZSB0aGUgY29udGVudFxyXG4gICAgICAgIGNvbnN0IHRva2VucyA9IHRoaXMudGV4dFByb2Nlc3Nvci50b2tlbml6ZShjb250ZW50KTtcclxuICAgICAgICBcclxuICAgICAgICAvL3JlbW92ZSBzdG9wIHdvcmRzXHJcbiAgICAgICAgY29uc3QgZmlsdGVyZWRUb2tlbnMgPSB0aGlzLnRleHRQcm9jZXNzb3IucmVtb3ZlU3RvcFdvcmRzKHRva2Vucyk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy9jYWxjdWxhdGUgdGVybSBmcmVxdWVuY3lcclxuICAgICAgICBjb25zdCB0ZXJtRnJlcXVlbmN5ID0gdGhpcy50ZXh0UHJvY2Vzc29yLmNhbGN1bGF0ZVRlcm1GcmVxdWVuY3koZmlsdGVyZWRUb2tlbnMpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vc29ydCBieSBmcmVxdWVuY3kgYW5kIHRha2UgdG9wIE4gYmFzZWQgb24gc2Vuc2l0aXZpdHlcclxuICAgICAgICBjb25zdCB0aHJlc2hvbGQgPSBNYXRoLm1heCgyLCBNYXRoLmZsb29yKDIwIC8gKDExIC0gdGhpcy5zZW5zaXRpdml0eSkpKTtcclxuICAgICAgICBcclxuICAgICAgICAvL2NvbnZlcnQgdG8gYXJyYXkgYW5kIHNvcnQgYnkgZnJlcXVlbmN5XHJcbiAgICAgICAgY29uc3Qgc29ydGVkVGVybXMgPSBBcnJheS5mcm9tKHRlcm1GcmVxdWVuY3kuZW50cmllcygpKVxyXG4gICAgICAgICAgICAuZmlsdGVyKChbXywgZnJlcV0pID0+IGZyZXEgPj0gdGhyZXNob2xkKVxyXG4gICAgICAgICAgICAuc29ydCgoYSwgYikgPT4gYlsxXSAtIGFbMV0pXHJcbiAgICAgICAgICAgIC5zbGljZSgwLCB0aGlzLnNlbnNpdGl2aXR5ICogMykgLy90YWtlIG1vcmUgdGVybXMgd2l0aCBoaWdoZXIgc2Vuc2l0aXZpdHlcclxuICAgICAgICAgICAgLm1hcCgoW3Rlcm0sIF9dKSA9PiB0ZXJtKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgcmV0dXJuIHNvcnRlZFRlcm1zO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogRXh0cmFjdCBjb25jZXB0cyBmcm9tIG1hcmtkb3duIGhlYWRpbmdzXHJcbiAgICAgKiBAcGFyYW0gY29udGVudCBNYXJrZG93biBjb250ZW50XHJcbiAgICAgKiBAcmV0dXJucyBBcnJheSBvZiBjb25jZXB0cyBmcm9tIGhlYWRpbmdzXHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgZXh0cmFjdEZyb21IZWFkaW5ncyhjb250ZW50OiBzdHJpbmcpOiBzdHJpbmdbXSB7XHJcbiAgICAgICAgY29uc3QgaGVhZGluZ1JlZ2V4ID0gL14jK1xccysoLispJC9nbTtcclxuICAgICAgICBjb25zdCBoZWFkaW5nczogc3RyaW5nW10gPSBbXTtcclxuICAgICAgICBsZXQgbWF0Y2g7XHJcbiAgICAgICAgXHJcbiAgICAgICAgd2hpbGUgKChtYXRjaCA9IGhlYWRpbmdSZWdleC5leGVjKGNvbnRlbnQpKSAhPT0gbnVsbCkge1xyXG4gICAgICAgICAgICBoZWFkaW5ncy5wdXNoKG1hdGNoWzFdLnRyaW0oKSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgIHJldHVybiBoZWFkaW5ncztcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIEV4dHJhY3QgY29uY2VwdHMgZnJvbSBlbXBoYXNpemVkIHRleHQgKGJvbGQvaXRhbGljKVxyXG4gICAgICogQHBhcmFtIGNvbnRlbnQgTWFya2Rvd24gY29udGVudFxyXG4gICAgICogQHJldHVybnMgQXJyYXkgb2YgY29uY2VwdHMgZnJvbSBlbXBoYXNpemVkIHRleHRcclxuICAgICAqL1xyXG4gICAgcHJpdmF0ZSBleHRyYWN0RnJvbUVtcGhhc2lzKGNvbnRlbnQ6IHN0cmluZyk6IHN0cmluZ1tdIHtcclxuICAgICAgICBjb25zdCBlbXBoYXNpc1JlZ2V4ID0gLyhcXCpcXCp8X18pKC4qPylcXDF8KFxcKnxfKSguKj8pXFwzL2c7XHJcbiAgICAgICAgY29uc3QgZW1waGFzaXplZDogc3RyaW5nW10gPSBbXTtcclxuICAgICAgICBsZXQgbWF0Y2g7XHJcbiAgICAgICAgXHJcbiAgICAgICAgd2hpbGUgKChtYXRjaCA9IGVtcGhhc2lzUmVnZXguZXhlYyhjb250ZW50KSkgIT09IG51bGwpIHtcclxuICAgICAgICAgICAgY29uc3QgdGV4dCA9IG1hdGNoWzJdIHx8IG1hdGNoWzRdO1xyXG4gICAgICAgICAgICBpZiAodGV4dCAmJiB0ZXh0LnRyaW0oKS5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICBlbXBoYXNpemVkLnB1c2godGV4dC50cmltKCkpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgIHJldHVybiBlbXBoYXNpemVkO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogRXh0cmFjdCBuYW1lZCBlbnRpdGllcyBhcyBjb25jZXB0c1xyXG4gICAgICogQHBhcmFtIGNvbnRlbnQgVGV4dCBjb250ZW50XHJcbiAgICAgKiBAcmV0dXJucyBBcnJheSBvZiBuYW1lZCBlbnRpdGllc1xyXG4gICAgICovXHJcbiAgICBwcml2YXRlIGV4dHJhY3RGcm9tTmFtZWRFbnRpdGllcyhjb250ZW50OiBzdHJpbmcpOiBzdHJpbmdbXSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMudGV4dFByb2Nlc3Nvci5leHRyYWN0TmFtZWRFbnRpdGllcyhjb250ZW50KTtcclxuICAgIH1cclxufSIsICJpbXBvcnQgeyBDb25jZXB0R3JhcGgsIFJlbGF0ZWROb3RlIH0gZnJvbSAnLi4vdXRpbHMvdHlwZXMnO1xyXG5pbXBvcnQgeyBURmlsZSwgVmF1bHQgfSBmcm9tICdvYnNpZGlhbic7XHJcblxyXG4vKipcclxuICogU3RydWN0dXJlIHRvIHN0b3JlIG5vdGUgZGF0YSBpbiB0aGUgZ3JhcGhcclxuICovXHJcbmludGVyZmFjZSBOb3RlTm9kZSB7XHJcbiAgICBwYXRoOiBzdHJpbmc7XHJcbiAgICBjb25jZXB0czogc3RyaW5nW107XHJcbiAgICBsYXN0VXBkYXRlZDogbnVtYmVyO1xyXG59XHJcblxyXG4vKipcclxuICogU3RydWN0dXJlIHRvIHN0b3JlIGNvbmNlcHQgZGF0YSBpbiB0aGUgZ3JhcGhcclxuICovXHJcbmludGVyZmFjZSBDb25jZXB0Tm9kZSB7XHJcbiAgICBuYW1lOiBzdHJpbmc7XHJcbiAgICBub3RlUGF0aHM6IHN0cmluZ1tdO1xyXG4gICAgd2VpZ2h0OiBudW1iZXI7IC8vIENvbmNlcHQgaW1wb3J0YW5jZVxyXG59XHJcblxyXG4vKipcclxuICogSW1wbGVtZW50YXRpb24gb2YgdGhlIENvbmNlcHQgR3JhcGggdGhhdCBtYW5hZ2VzIHJlbGF0aW9uc2hpcHMgYmV0d2VlbiBub3Rlc1xyXG4gKi9cclxuZXhwb3J0IGNsYXNzIENvbmNlcHRHcmFwaEltcGwgaW1wbGVtZW50cyBDb25jZXB0R3JhcGgge1xyXG4gICAgcHJpdmF0ZSBub3RlczogTWFwPHN0cmluZywgTm90ZU5vZGU+ID0gbmV3IE1hcCgpO1xyXG4gICAgcHJpdmF0ZSBjb25jZXB0czogTWFwPHN0cmluZywgQ29uY2VwdE5vZGU+ID0gbmV3IE1hcCgpO1xyXG4gICAgcHJpdmF0ZSB2YXVsdDogVmF1bHQ7XHJcbiAgICBcclxuICAgIGNvbnN0cnVjdG9yKHZhdWx0OiBWYXVsdCkge1xyXG4gICAgICAgIHRoaXMudmF1bHQgPSB2YXVsdDtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIEFkZCBhIG5vdGUgdG8gdGhlIGdyYXBoIHdpdGggaXRzIGNvbmNlcHRzXHJcbiAgICAgKiBAcGFyYW0gcGF0aCBQYXRoIHRvIHRoZSBub3RlXHJcbiAgICAgKiBAcGFyYW0gY29uY2VwdHMgQXJyYXkgb2YgY29uY2VwdHMgaW4gdGhlIG5vdGVcclxuICAgICAqL1xyXG4gICAgcHVibGljIGFkZE5vdGUocGF0aDogc3RyaW5nLCBjb25jZXB0czogc3RyaW5nW10pOiB2b2lkIHtcclxuICAgICAgICAvLyBDcmVhdGUgb3IgdXBkYXRlIHRoZSBub3RlIG5vZGVcclxuICAgICAgICB0aGlzLm5vdGVzLnNldChwYXRoLCB7XHJcbiAgICAgICAgICAgIHBhdGgsXHJcbiAgICAgICAgICAgIGNvbmNlcHRzLFxyXG4gICAgICAgICAgICBsYXN0VXBkYXRlZDogRGF0ZS5ub3coKVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIFVwZGF0ZSBjb25jZXB0IG5vZGVzXHJcbiAgICAgICAgZm9yIChjb25zdCBjb25jZXB0IG9mIGNvbmNlcHRzKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGNvbmNlcHROb2RlID0gdGhpcy5jb25jZXB0cy5nZXQoY29uY2VwdCkgfHwge1xyXG4gICAgICAgICAgICAgICAgbmFtZTogY29uY2VwdCxcclxuICAgICAgICAgICAgICAgIG5vdGVQYXRoczogW10sXHJcbiAgICAgICAgICAgICAgICB3ZWlnaHQ6IDFcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIEFkZCB0aGlzIG5vdGUgdG8gdGhlIGNvbmNlcHQgaWYgbm90IGFscmVhZHkgcHJlc2VudFxyXG4gICAgICAgICAgICBpZiAoIWNvbmNlcHROb2RlLm5vdGVQYXRocy5pbmNsdWRlcyhwYXRoKSkge1xyXG4gICAgICAgICAgICAgICAgY29uY2VwdE5vZGUubm90ZVBhdGhzLnB1c2gocGF0aCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIFVwZGF0ZSB0aGUgY29uY2VwdCdzIHdlaWdodCBiYXNlZCBvbiBmcmVxdWVuY3lcclxuICAgICAgICAgICAgY29uY2VwdE5vZGUud2VpZ2h0ID0gY29uY2VwdE5vZGUubm90ZVBhdGhzLmxlbmd0aDtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIFNhdmUgdGhlIHVwZGF0ZWQgY29uY2VwdFxyXG4gICAgICAgICAgICB0aGlzLmNvbmNlcHRzLnNldChjb25jZXB0LCBjb25jZXB0Tm9kZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogUmVtb3ZlIGEgbm90ZSBmcm9tIHRoZSBncmFwaFxyXG4gICAgICogQHBhcmFtIHBhdGggUGF0aCB0byB0aGUgbm90ZSB0byByZW1vdmVcclxuICAgICAqL1xyXG4gICAgcHVibGljIHJlbW92ZU5vdGUocGF0aDogc3RyaW5nKTogdm9pZCB7XHJcbiAgICAgICAgLy8gR2V0IHRoZSBub3RlJ3MgY29uY2VwdHMgYmVmb3JlIHJlbW92YWxcclxuICAgICAgICBjb25zdCBub3RlID0gdGhpcy5ub3Rlcy5nZXQocGF0aCk7XHJcbiAgICAgICAgaWYgKCFub3RlKSB7XHJcbiAgICAgICAgICAgIHJldHVybjsgLy8gTm90ZSBkb2Vzbid0IGV4aXN0IGluIHRoZSBncmFwaFxyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICAvLyBSZW1vdmUgbm90ZSBmcm9tIGFsbCBpdHMgY29uY2VwdHNcclxuICAgICAgICBmb3IgKGNvbnN0IGNvbmNlcHQgb2Ygbm90ZS5jb25jZXB0cykge1xyXG4gICAgICAgICAgICBjb25zdCBjb25jZXB0Tm9kZSA9IHRoaXMuY29uY2VwdHMuZ2V0KGNvbmNlcHQpO1xyXG4gICAgICAgICAgICBpZiAoY29uY2VwdE5vZGUpIHtcclxuICAgICAgICAgICAgICAgIC8vIEZpbHRlciBvdXQgdGhpcyBub3RlIHBhdGhcclxuICAgICAgICAgICAgICAgIGNvbmNlcHROb2RlLm5vdGVQYXRocyA9IGNvbmNlcHROb2RlLm5vdGVQYXRocy5maWx0ZXIocCA9PiBwICE9PSBwYXRoKTtcclxuICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgLy8gVXBkYXRlIHdlaWdodFxyXG4gICAgICAgICAgICAgICAgY29uY2VwdE5vZGUud2VpZ2h0ID0gY29uY2VwdE5vZGUubm90ZVBhdGhzLmxlbmd0aDtcclxuICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgLy8gUmVtb3ZlIGNvbmNlcHQgaWYgaXQgbm8gbG9uZ2VyIGhhcyBhbnkgbm90ZXNcclxuICAgICAgICAgICAgICAgIGlmIChjb25jZXB0Tm9kZS5ub3RlUGF0aHMubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jb25jZXB0cy5kZWxldGUoY29uY2VwdCk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY29uY2VwdHMuc2V0KGNvbmNlcHQsIGNvbmNlcHROb2RlKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICAvLyBSZW1vdmUgdGhlIG5vdGUgaXRzZWxmXHJcbiAgICAgICAgdGhpcy5ub3Rlcy5kZWxldGUocGF0aCk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBGaW5kIG5vdGVzIHJlbGF0ZWQgdG8gYSBnaXZlbiBub3RlXHJcbiAgICAgKiBAcGFyYW0gbm90ZVBhdGggUGF0aCB0byB0aGUgbm90ZVxyXG4gICAgICogQHBhcmFtIG1heFJlc3VsdHMgTWF4aW11bSBudW1iZXIgb2YgcmVzdWx0cyB0byByZXR1cm5cclxuICAgICAqIEByZXR1cm5zIEFycmF5IG9mIHJlbGF0ZWQgbm90ZXMgc29ydGVkIGJ5IHJlbGV2YW5jZVxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgZmluZFJlbGF0ZWROb3Rlcyhub3RlUGF0aDogc3RyaW5nLCBtYXhSZXN1bHRzOiBudW1iZXIgPSAxMCk6IFJlbGF0ZWROb3RlW10ge1xyXG4gICAgICAgIGNvbnN0IG5vdGUgPSB0aGlzLm5vdGVzLmdldChub3RlUGF0aCk7XHJcbiAgICAgICAgaWYgKCFub3RlKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBbXTsgLy8gTm90ZSBkb2Vzbid0IGV4aXN0IGluIHRoZSBncmFwaFxyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICAvLyBDYWxjdWxhdGUgcmVsZXZhbmNlIHNjb3JlcyBmb3IgYWxsIG5vdGVzXHJcbiAgICAgICAgY29uc3Qgc2NvcmVzOiBNYXA8c3RyaW5nLCB7IFxyXG4gICAgICAgICAgICByZWxldmFuY2U6IG51bWJlciwgXHJcbiAgICAgICAgICAgIHNoYXJlZENvbmNlcHRzOiBzdHJpbmdbXSBcclxuICAgICAgICB9PiA9IG5ldyBNYXAoKTtcclxuICAgICAgICBcclxuICAgICAgICAvLyBJdGVyYXRlIHRocm91Z2ggY29uY2VwdHMgaW4gdGhlIHRhcmdldCBub3RlXHJcbiAgICAgICAgZm9yIChjb25zdCBjb25jZXB0IG9mIG5vdGUuY29uY2VwdHMpIHtcclxuICAgICAgICAgICAgY29uc3QgY29uY2VwdE5vZGUgPSB0aGlzLmNvbmNlcHRzLmdldChjb25jZXB0KTtcclxuICAgICAgICAgICAgaWYgKCFjb25jZXB0Tm9kZSkgY29udGludWU7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyBGb3IgZWFjaCBub3RlIHRoYXQgaGFzIHRoaXMgY29uY2VwdFxyXG4gICAgICAgICAgICBmb3IgKGNvbnN0IHJlbGF0ZWRQYXRoIG9mIGNvbmNlcHROb2RlLm5vdGVQYXRocykge1xyXG4gICAgICAgICAgICAgICAgLy8gU2tpcCB0aGUgb3JpZ2luYWwgbm90ZVxyXG4gICAgICAgICAgICAgICAgaWYgKHJlbGF0ZWRQYXRoID09PSBub3RlUGF0aCkgY29udGludWU7XHJcbiAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgIC8vIEdldCBvciBpbml0aWFsaXplIHNjb3JlIGRhdGFcclxuICAgICAgICAgICAgICAgIGNvbnN0IHNjb3JlRGF0YSA9IHNjb3Jlcy5nZXQocmVsYXRlZFBhdGgpIHx8IHsgXHJcbiAgICAgICAgICAgICAgICAgICAgcmVsZXZhbmNlOiAwLCBcclxuICAgICAgICAgICAgICAgICAgICBzaGFyZWRDb25jZXB0czogW10gXHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAvLyBJbmNyZW1lbnQgcmVsZXZhbmNlIHNjb3JlIGJhc2VkIG9uIGNvbmNlcHQgd2VpZ2h0XHJcbiAgICAgICAgICAgICAgICBzY29yZURhdGEucmVsZXZhbmNlICs9IGNvbmNlcHROb2RlLndlaWdodDtcclxuICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgLy8gQWRkIHRvIHNoYXJlZCBjb25jZXB0cyBpZiBub3QgYWxyZWFkeSB0aGVyZVxyXG4gICAgICAgICAgICAgICAgaWYgKCFzY29yZURhdGEuc2hhcmVkQ29uY2VwdHMuaW5jbHVkZXMoY29uY2VwdCkpIHtcclxuICAgICAgICAgICAgICAgICAgICBzY29yZURhdGEuc2hhcmVkQ29uY2VwdHMucHVzaChjb25jZXB0KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgc2NvcmVzLnNldChyZWxhdGVkUGF0aCwgc2NvcmVEYXRhKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICAvLyBDb252ZXJ0IHRvIGFycmF5IGFuZCBub3JtYWxpemUgc2NvcmVzXHJcbiAgICAgICAgY29uc3QgcmVsYXRlZE5vdGVzOiBSZWxhdGVkTm90ZVtdID0gW107XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gRmluZCBtYXhpbXVtIHNjb3JlIGZvciBub3JtYWxpemF0aW9uXHJcbiAgICAgICAgY29uc3QgbWF4U2NvcmUgPSBNYXRoLm1heCguLi5BcnJheS5mcm9tKHNjb3Jlcy52YWx1ZXMoKSlcclxuICAgICAgICAgICAgLm1hcChkYXRhID0+IGRhdGEucmVsZXZhbmNlKSwgMSk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gQ29udmVydCBzY29yZXMgdG8gUmVsYXRlZE5vdGUgb2JqZWN0c1xyXG4gICAgICAgIGZvciAoY29uc3QgW3BhdGgsIGRhdGFdIG9mIHNjb3Jlcy5lbnRyaWVzKCkpIHtcclxuICAgICAgICAgICAgLy8gR2V0IHRoZSBmaWxlIGZyb20gdmF1bHRcclxuICAgICAgICAgICAgY29uc3QgZmlsZSA9IHRoaXMudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKHBhdGgpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgLy8gU2tpcCBpZiBmaWxlIGRvZXNuJ3QgZXhpc3Qgb3IgaXNuJ3QgYSBURmlsZVxyXG4gICAgICAgICAgICBpZiAoIWZpbGUgfHwgIShmaWxlIGluc3RhbmNlb2YgVEZpbGUpKSBjb250aW51ZTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIHJlbGF0ZWROb3Rlcy5wdXNoKHtcclxuICAgICAgICAgICAgICAgIGZpbGU6IGZpbGUgYXMgVEZpbGUsXHJcbiAgICAgICAgICAgICAgICByZWxldmFuY2U6IGRhdGEucmVsZXZhbmNlIC8gbWF4U2NvcmUsIC8vIE5vcm1hbGl6ZSB0byAwLTFcclxuICAgICAgICAgICAgICAgIHNoYXJlZENvbmNlcHRzOiBkYXRhLnNoYXJlZENvbmNlcHRzXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICAvLyBTb3J0IGJ5IHJlbGV2YW5jZSAoaGlnaGVzdCBmaXJzdCkgYW5kIGxpbWl0IHJlc3VsdHNcclxuICAgICAgICByZXR1cm4gcmVsYXRlZE5vdGVzXHJcbiAgICAgICAgICAgIC5zb3J0KChhLCBiKSA9PiBiLnJlbGV2YW5jZSAtIGEucmVsZXZhbmNlKVxyXG4gICAgICAgICAgICAuc2xpY2UoMCwgbWF4UmVzdWx0cyk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBHZXQgYWxsIGNvbmNlcHRzIGZvciBhIG5vdGVcclxuICAgICAqIEBwYXJhbSBub3RlUGF0aCBQYXRoIHRvIHRoZSBub3RlXHJcbiAgICAgKiBAcmV0dXJucyBBcnJheSBvZiBjb25jZXB0c1xyXG4gICAgICovXHJcbiAgICBwdWJsaWMgZ2V0Tm90ZUNvbmNlcHRzKG5vdGVQYXRoOiBzdHJpbmcpOiBzdHJpbmdbXSB7XHJcbiAgICAgICAgY29uc3Qgbm90ZSA9IHRoaXMubm90ZXMuZ2V0KG5vdGVQYXRoKTtcclxuICAgICAgICByZXR1cm4gbm90ZSA/IG5vdGUuY29uY2VwdHMgOiBbXTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIEdldCBncmFwaCBkYXRhIGZvciB2aXN1YWxpemF0aW9uXHJcbiAgICAgKiBAcmV0dXJucyBPYmplY3Qgd2l0aCBub2RlcyBhbmQgZWRnZXMgYXJyYXlzIGZvciB2aXN1YWxpemF0aW9uXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBnZXRDb25jZXB0TmV0d29yaygpOiB7IG5vZGVzOiBhbnlbXSwgZWRnZXM6IGFueVtdIH0ge1xyXG4gICAgICAgIGNvbnN0IG5vZGVzOiBhbnlbXSA9IFtdO1xyXG4gICAgICAgIGNvbnN0IGVkZ2VzOiBhbnlbXSA9IFtdO1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIEFkZCBub3RlIG5vZGVzXHJcbiAgICAgICAgZm9yIChjb25zdCBbcGF0aCwgbm90ZV0gb2YgdGhpcy5ub3Rlcy5lbnRyaWVzKCkpIHtcclxuICAgICAgICAgICAgbm9kZXMucHVzaCh7XHJcbiAgICAgICAgICAgICAgICBpZDogcGF0aCxcclxuICAgICAgICAgICAgICAgIGxhYmVsOiBwYXRoLnNwbGl0KCcvJykucG9wKCkgfHwgcGF0aCwgLy8gVXNlIGZpbGVuYW1lIGFzIGxhYmVsXHJcbiAgICAgICAgICAgICAgICB0eXBlOiAnbm90ZSdcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIEFkZCBjb25jZXB0IG5vZGVzIChmb3IgY29uY2VwdHMgdGhhdCBhcHBlYXIgaW4gbXVsdGlwbGUgbm90ZXMpXHJcbiAgICAgICAgZm9yIChjb25zdCBbbmFtZSwgY29uY2VwdF0gb2YgdGhpcy5jb25jZXB0cy5lbnRyaWVzKCkpIHtcclxuICAgICAgICAgICAgaWYgKGNvbmNlcHQubm90ZVBhdGhzLmxlbmd0aCA+IDEpIHtcclxuICAgICAgICAgICAgICAgIG5vZGVzLnB1c2goe1xyXG4gICAgICAgICAgICAgICAgICAgIGlkOiBgY29uY2VwdC0ke25hbWV9YCxcclxuICAgICAgICAgICAgICAgICAgICBsYWJlbDogbmFtZSxcclxuICAgICAgICAgICAgICAgICAgICB0eXBlOiAnY29uY2VwdCcsXHJcbiAgICAgICAgICAgICAgICAgICAgd2VpZ2h0OiBjb25jZXB0LndlaWdodFxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgIC8vIEFkZCBlZGdlcyBmcm9tIGNvbmNlcHQgdG8gbm90ZXNcclxuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgcGF0aCBvZiBjb25jZXB0Lm5vdGVQYXRocykge1xyXG4gICAgICAgICAgICAgICAgICAgIGVkZ2VzLnB1c2goe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzb3VyY2U6IGBjb25jZXB0LSR7bmFtZX1gLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXQ6IHBhdGgsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiAxXHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgcmV0dXJuIHsgbm9kZXMsIGVkZ2VzIH07XHJcbiAgICB9XHJcbiAgICBwdWJsaWMgdXBkYXRlTm90ZUNvbmNlcHRzKHBhdGg6IHN0cmluZywgbmV3Q29uY2VwdHM6IHN0cmluZ1tdKTogdm9pZCB7XHJcbiAgICAgICAgdGhpcy5ub3Rlcy5zZXQocGF0aCwge1xyXG4gICAgICAgICAgICBwYXRoOiBwYXRoLFxyXG4gICAgICAgICAgICBjb25jZXB0czogbmV3Q29uY2VwdHMsXHJcbiAgICAgICAgICAgIGxhc3RVcGRhdGVkOiBEYXRlLm5vdygpXHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICBcclxufSIsICJpbXBvcnQgeyBEYXRhTWFuYWdlciB9IGZyb20gJy4uL3V0aWxzL3R5cGVzJztcclxuaW1wb3J0IHsgUGx1Z2luIH0gZnJvbSAnb2JzaWRpYW4nO1xyXG5cclxuLyoqXHJcbiAqIEludGVyZmFjZSBmb3IgcGVyc2lzdGVudCBkYXRhIHN0b3JhZ2VcclxuICovXHJcbmludGVyZmFjZSBDb25jZXB0RGF0YSB7XHJcbiAgICB2ZXJzaW9uOiBudW1iZXI7XHJcbiAgICBub3RlczogUmVjb3JkPHN0cmluZywge1xyXG4gICAgICAgIGNvbmNlcHRzOiBzdHJpbmdbXTtcclxuICAgICAgICBsYXN0VXBkYXRlZDogbnVtYmVyO1xyXG4gICAgfT47XHJcbiAgICBjb25jZXB0czogUmVjb3JkPHN0cmluZywge1xyXG4gICAgICAgIG5vdGVQYXRoczogc3RyaW5nW107XHJcbiAgICAgICAgd2VpZ2h0OiBudW1iZXI7XHJcbiAgICB9PjtcclxuICAgIHVzZXJGZWVkYmFjazogUmVjb3JkPHN0cmluZywgYm9vbGVhbj47XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBJbXBsZW1lbnRhdGlvbiBvZiBkYXRhIHBlcnNpc3RlbmNlIGZvciBjb25jZXB0cyBhbmQgcmVsYXRpb25zaGlwc1xyXG4gKi9cclxuZXhwb3J0IGNsYXNzIERhdGFNYW5hZ2VySW1wbCBpbXBsZW1lbnRzIERhdGFNYW5hZ2VyIHtcclxuICAgIHByaXZhdGUgcGx1Z2luOiBQbHVnaW47XHJcbiAgICBwcml2YXRlIGRhdGE6IENvbmNlcHREYXRhO1xyXG4gICAgXHJcbiAgICAvLyBDdXJyZW50IGRhdGEgdmVyc2lvbiBmb3IgbWlncmF0aW9uIHN1cHBvcnRcclxuICAgIHByaXZhdGUgcmVhZG9ubHkgQ1VSUkVOVF9WRVJTSU9OID0gMTtcclxuICAgIFxyXG4gICAgY29uc3RydWN0b3IocGx1Z2luOiBQbHVnaW4pIHtcclxuICAgICAgICB0aGlzLnBsdWdpbiA9IHBsdWdpbjtcclxuICAgICAgICBcclxuICAgICAgICAvLyBJbml0aWFsaXplIHdpdGggZW1wdHkgZGF0YVxyXG4gICAgICAgIHRoaXMuZGF0YSA9IHtcclxuICAgICAgICAgICAgdmVyc2lvbjogdGhpcy5DVVJSRU5UX1ZFUlNJT04sXHJcbiAgICAgICAgICAgIG5vdGVzOiB7fSxcclxuICAgICAgICAgICAgY29uY2VwdHM6IHt9LFxyXG4gICAgICAgICAgICB1c2VyRmVlZGJhY2s6IHt9XHJcbiAgICAgICAgfTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFNhdmUgY29uY2VwdCBkYXRhIHRvIGRpc2tcclxuICAgICAqL1xyXG4gICAgcHVibGljIGFzeW5jIHNhdmVDb25jZXB0RGF0YSgpOiBQcm9taXNlPHZvaWQ+IHtcclxuICAgICAgICAvLyBJbiBPYnNpZGlhbiBQbHVnaW4gQVBJLCBzYXZlRGF0YSB0YWtlcyBvbmx5IG9uZSBhcmd1bWVudDogdGhlIGRhdGEgdG8gc2F2ZVxyXG4gICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVEYXRhKHRoaXMuZGF0YSk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBMb2FkIGNvbmNlcHQgZGF0YSBmcm9tIGRpc2tcclxuICAgICAqL1xyXG4gICAgcHVibGljIGFzeW5jIGxvYWRDb25jZXB0RGF0YSgpOiBQcm9taXNlPHZvaWQ+IHtcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAvLyBsb2FkRGF0YSBkb2Vzbid0IHRha2UgYXJndW1lbnRzIGluIHRoZSBPYnNpZGlhbiBQbHVnaW4gQVBJXHJcbiAgICAgICAgICAgIGNvbnN0IHNhdmVkRGF0YSA9IGF3YWl0IHRoaXMucGx1Z2luLmxvYWREYXRhKCk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyBJZiBubyBkYXRhIGV4aXN0cyB5ZXQsIGtlZXAgdGhlIGRlZmF1bHQgZW1wdHkgZGF0YVxyXG4gICAgICAgICAgICBpZiAoIXNhdmVkRGF0YSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyBDaGVjayBpZiBkYXRhIG1pZ3JhdGlvbiBpcyBuZWVkZWRcclxuICAgICAgICAgICAgaWYgKHNhdmVkRGF0YS52ZXJzaW9uICE9PSB0aGlzLkNVUlJFTlRfVkVSU0lPTikge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5kYXRhID0gdGhpcy5taWdyYXRlRGF0YShzYXZlZERhdGEpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5kYXRhID0gc2F2ZWREYXRhO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgICAgICAgY29uc29sZS5lcnJvcignRmFpbGVkIHRvIGxvYWQgY29uY2VwdCBkYXRhOicsIGVycm9yKTtcclxuICAgICAgICAgICAgLy8gS2VlcCB1c2luZyB0aGUgZGVmYXVsdCBlbXB0eSBkYXRhXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQ2xlYXIgYWxsIHN0b3JlZCBkYXRhXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBhc3luYyBjbGVhckRhdGEoKTogUHJvbWlzZTx2b2lkPiB7XHJcbiAgICAgICAgdGhpcy5kYXRhID0ge1xyXG4gICAgICAgICAgICB2ZXJzaW9uOiB0aGlzLkNVUlJFTlRfVkVSU0lPTixcclxuICAgICAgICAgICAgbm90ZXM6IHt9LFxyXG4gICAgICAgICAgICBjb25jZXB0czoge30sXHJcbiAgICAgICAgICAgIHVzZXJGZWVkYmFjazoge31cclxuICAgICAgICB9O1xyXG4gICAgICAgIFxyXG4gICAgICAgIGF3YWl0IHRoaXMuc2F2ZUNvbmNlcHREYXRhKCk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBHZXQgdGhlIGxvYWRlZCBkYXRhXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBnZXREYXRhKCk6IENvbmNlcHREYXRhIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5kYXRhO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogU2V0IHRoZSBkYXRhICh1c2VkIHdoZW4gdXBkYXRpbmcgZnJvbSB0aGUgY29uY2VwdCBncmFwaClcclxuICAgICAqL1xyXG4gICAgcHVibGljIHNldERhdGEoXHJcbiAgICAgICAgbm90ZXM6IFJlY29yZDxzdHJpbmcsIHsgY29uY2VwdHM6IHN0cmluZ1tdLCBsYXN0VXBkYXRlZDogbnVtYmVyIH0+LFxyXG4gICAgICAgIGNvbmNlcHRzOiBSZWNvcmQ8c3RyaW5nLCB7IG5vdGVQYXRoczogc3RyaW5nW10sIHdlaWdodDogbnVtYmVyIH0+LFxyXG4gICAgICAgIHVzZXJGZWVkYmFjazogUmVjb3JkPHN0cmluZywgYm9vbGVhbj5cclxuICAgICk6IHZvaWQge1xyXG4gICAgICAgIHRoaXMuZGF0YSA9IHtcclxuICAgICAgICAgICAgdmVyc2lvbjogdGhpcy5DVVJSRU5UX1ZFUlNJT04sXHJcbiAgICAgICAgICAgIG5vdGVzLFxyXG4gICAgICAgICAgICBjb25jZXB0cyxcclxuICAgICAgICAgICAgdXNlckZlZWRiYWNrXHJcbiAgICAgICAgfTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIE1pZ3JhdGUgZGF0YSBmcm9tIGFuIG9sZGVyIHZlcnNpb24gdG8gdGhlIGN1cnJlbnQgdmVyc2lvblxyXG4gICAgICovXHJcbiAgICBwcml2YXRlIG1pZ3JhdGVEYXRhKG9sZERhdGE6IGFueSk6IENvbmNlcHREYXRhIHtcclxuICAgICAgICAvLyBUaGlzIGlzIGEgcGxhY2Vob2xkZXIgZm9yIGZ1dHVyZSBtaWdyYXRpb25zXHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgdmVyc2lvbjogdGhpcy5DVVJSRU5UX1ZFUlNJT04sXHJcbiAgICAgICAgICAgIG5vdGVzOiBvbGREYXRhLm5vdGVzIHx8IHt9LFxyXG4gICAgICAgICAgICBjb25jZXB0czogb2xkRGF0YS5jb25jZXB0cyB8fCB7fSxcclxuICAgICAgICAgICAgdXNlckZlZWRiYWNrOiBvbGREYXRhLnVzZXJGZWVkYmFjayB8fCB7fVxyXG4gICAgICAgIH07XHJcbiAgICB9XHJcbn0iLCAiaW1wb3J0IHsgVEZpbGUsIFZhdWx0LCBOb3RpY2UgfSBmcm9tICdvYnNpZGlhbic7XHJcbmltcG9ydCB7IENvbmNlcHRFeHRyYWN0b3IsIENvbmNlcHRHcmFwaCwgTm90ZVByb2Nlc3NvclNlcnZpY2UgfSBmcm9tICcuLi91dGlscy90eXBlcyc7XHJcblxyXG4vKipcclxuICogU2VydmljZSB0byBoYW5kbGUgbm90ZSBwcm9jZXNzaW5nIGZvciBjb25jZXB0IGV4dHJhY3Rpb24gYW5kIHJlbGF0aW9uc2hpcCB0cmFja2luZ1xyXG4gKi9cclxuZXhwb3J0IGNsYXNzIE5vdGVQcm9jZXNzb3IgaW1wbGVtZW50cyBOb3RlUHJvY2Vzc29yU2VydmljZSB7XHJcbiAgICAvLyBLZWVwIHRyYWNrIG9mIHByb2Nlc3NlZCBmaWxlcyB0byBhdm9pZCByZWR1bmRhbnQgcHJvY2Vzc2luZ1xyXG4gICAgcHJpdmF0ZSBwcm9jZXNzZWRGaWxlczogTWFwPHN0cmluZywgbnVtYmVyPiA9IG5ldyBNYXAoKTsgLy8gcGF0aCAtPiBsYXN0TW9kaWZpZWRcclxuICAgIFxyXG4gICAgY29uc3RydWN0b3IoXHJcbiAgICAgICAgcHJpdmF0ZSB2YXVsdDogVmF1bHQsXHJcbiAgICAgICAgcHJpdmF0ZSBjb25jZXB0RXh0cmFjdG9yOiBDb25jZXB0RXh0cmFjdG9yLFxyXG4gICAgICAgIHByaXZhdGUgY29uY2VwdEdyYXBoOiBDb25jZXB0R3JhcGgsXHJcbiAgICAgICAgcHJpdmF0ZSBzYXZlQ2FsbGJhY2s6ICgpID0+IFByb21pc2U8dm9pZD5cclxuICAgICkge31cclxuICAgIFxyXG4gICAgLyoqXHJcbiAgICAgKiBQcm9jZXNzIGEgc2luZ2xlIG5vdGUgZmlsZVxyXG4gICAgICogQHBhcmFtIGZpbGUgTm90ZSBmaWxlIHRvIHByb2Nlc3NcclxuICAgICAqL1xyXG4gICAgcHVibGljIGFzeW5jIHByb2Nlc3NOb3RlKGZpbGU6IFRGaWxlKTogUHJvbWlzZTx2b2lkPiB7XHJcbiAgICAgICAgLy8gU2tpcCBpZiBmaWxlIHdhcyByZWNlbnRseSBwcm9jZXNzZWQgKG9wdGltaXphdGlvbilcclxuICAgICAgICBpZiAoIXRoaXMuc2hvdWxkUHJvY2Vzc05vdGUoZmlsZSkpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAvLyBSZWFkIHRoZSBmaWxlIGNvbnRlbnRcclxuICAgICAgICAgICAgY29uc3QgY29udGVudCA9IGF3YWl0IHRoaXMudmF1bHQucmVhZChmaWxlKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIEV4dHJhY3QgY29uY2VwdHNcclxuICAgICAgICAgICAgY29uc3QgY29uY2VwdHMgPSB0aGlzLmNvbmNlcHRFeHRyYWN0b3IuZXh0cmFjdENvbmNlcHRzKGNvbnRlbnQpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgLy8gQWRkIHRvIGNvbmNlcHQgZ3JhcGhcclxuICAgICAgICAgICAgdGhpcy5jb25jZXB0R3JhcGguYWRkTm90ZShmaWxlLnBhdGgsIGNvbmNlcHRzKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIE1hcmsgYXMgcHJvY2Vzc2VkXHJcbiAgICAgICAgICAgIHRoaXMucHJvY2Vzc2VkRmlsZXMuc2V0KGZpbGUucGF0aCwgZmlsZS5zdGF0Lm10aW1lKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIFNhdmUgY2hhbmdlc1xyXG4gICAgICAgICAgICBhd2FpdCB0aGlzLnNhdmVDYWxsYmFjaygpO1xyXG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoYEVycm9yIHByb2Nlc3NpbmcgZmlsZSAke2ZpbGUucGF0aH06YCwgZXJyb3IpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIFxyXG4gICAgLyoqXHJcbiAgICAgKiBDaGVjayBpZiBhIGZpbGUgbmVlZHMgcHJvY2Vzc2luZ1xyXG4gICAgICogQHBhcmFtIGZpbGUgRmlsZSB0byBjaGVja1xyXG4gICAgICogQHJldHVybnMgdHJ1ZSBpZiBmaWxlIG5lZWRzIHByb2Nlc3NpbmcsIGZhbHNlIG90aGVyd2lzZVxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgc2hvdWxkUHJvY2Vzc05vdGUoZmlsZTogVEZpbGUpOiBib29sZWFuIHtcclxuICAgICAgICAvLyBTa2lwIG5vbi1tYXJrZG93biBmaWxlc1xyXG4gICAgICAgIGlmIChmaWxlLmV4dGVuc2lvbiAhPT0gJ21kJykge1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgIGNvbnN0IGxhc3RNb2RpZmllZCA9IGZpbGUuc3RhdC5tdGltZTtcclxuICAgICAgICBjb25zdCBsYXN0UHJvY2Vzc2VkID0gdGhpcy5wcm9jZXNzZWRGaWxlcy5nZXQoZmlsZS5wYXRoKTtcclxuICAgICAgICBcclxuICAgICAgICAvLyBQcm9jZXNzIGlmIG5ldmVyIHByb2Nlc3NlZCBvciBtb2RpZmllZCBzaW5jZSBsYXN0IHByb2Nlc3NpbmdcclxuICAgICAgICByZXR1cm4gIWxhc3RQcm9jZXNzZWQgfHwgbGFzdFByb2Nlc3NlZCA8IGxhc3RNb2RpZmllZDtcclxuICAgIH1cclxuICAgIFxyXG4gICAgLyoqXHJcbiAgICAgKiBQcm9jZXNzIGFsbCBub3RlcyBpbiB0aGUgdmF1bHRcclxuICAgICAqL1xyXG4gICAgcHVibGljIGFzeW5jIHByb2Nlc3NBbGxOb3RlcygpOiBQcm9taXNlPHZvaWQ+IHtcclxuICAgICAgICBjb25zdCBmaWxlcyA9IHRoaXMudmF1bHQuZ2V0TWFya2Rvd25GaWxlcygpO1xyXG4gICAgICAgIGxldCBwcm9jZXNzZWRDb3VudCA9IDA7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gU2hvdyBub3RpY2VcclxuICAgICAgICBjb25zdCBub3RpY2UgPSBuZXcgTm90aWNlKGBQcm9jZXNzaW5nICR7ZmlsZXMubGVuZ3RofSBub3Rlcy4uLmAsIDApO1xyXG4gICAgICAgIFxyXG4gICAgICAgIGZvciAoY29uc3QgZmlsZSBvZiBmaWxlcykge1xyXG4gICAgICAgICAgICBhd2FpdCB0aGlzLnByb2Nlc3NOb3RlKGZpbGUpO1xyXG4gICAgICAgICAgICBwcm9jZXNzZWRDb3VudCsrO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgLy8gVXBkYXRlIG5vdGljZSBwZXJpb2RpY2FsbHlcclxuICAgICAgICAgICAgaWYgKHByb2Nlc3NlZENvdW50ICUgMTAgPT09IDApIHtcclxuICAgICAgICAgICAgICAgIG5vdGljZS5zZXRNZXNzYWdlKGBQcm9jZXNzZWQgJHtwcm9jZXNzZWRDb3VudH0vJHtmaWxlcy5sZW5ndGh9IG5vdGVzLi4uYCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gU2F2ZSBkYXRhIHdoZW4gY29tcGxldGVcclxuICAgICAgICBhd2FpdCB0aGlzLnNhdmVDYWxsYmFjaygpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIENsb3NlIG5vdGljZVxyXG4gICAgICAgIG5vdGljZS5oaWRlKCk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gU2hvdyBjb21wbGV0aW9uIG5vdGljZVxyXG4gICAgICAgIG5ldyBOb3RpY2UoYENvbXBsZXRlZCBwcm9jZXNzaW5nICR7cHJvY2Vzc2VkQ291bnR9IG5vdGVzLmApO1xyXG4gICAgfVxyXG59IiwgIi8vIHNyYy9zZXJ2aWNlcy9zdW1tYXJ5LWdlbmVyYXRvci50c1xyXG5pbXBvcnQgeyBBcHAsIFRGaWxlLCBOb3RpY2UgfSBmcm9tICdvYnNpZGlhbic7XHJcbmltcG9ydCB7IFN1bW1hcnlHZW5lcmF0b3JTZXJ2aWNlLCBSZWxhdGVkTm90ZSwgQ29uY2VwdEdyYXBoIH0gZnJvbSAnLi4vdXRpbHMvdHlwZXMnO1xyXG5cclxuLyoqXHJcbiAqIFNlcnZpY2UgdG8gZ2VuZXJhdGUgc3VtbWFyaWVzIGZyb20gcmVsYXRlZCBub3Rlc1xyXG4gKi9cclxuZXhwb3J0IGNsYXNzIFN1bW1hcnlHZW5lcmF0b3IgaW1wbGVtZW50cyBTdW1tYXJ5R2VuZXJhdG9yU2VydmljZSB7XHJcbiAgICBjb25zdHJ1Y3RvcihcclxuICAgICAgICBwcml2YXRlIGFwcDogQXBwLFxyXG4gICAgICAgIHByaXZhdGUgY29uY2VwdEdyYXBoOiBDb25jZXB0R3JhcGgsXHJcbiAgICAgICAgcHJpdmF0ZSBnZXRSZWxhdGVkTm90ZXM6IChmaWxlOiBURmlsZSkgPT4gUHJvbWlzZTxSZWxhdGVkTm90ZVtdPlxyXG4gICAgKSB7fVxyXG4gICAgXHJcbiAgICAvKipcclxuICAgICAqIEdlbmVyYXRlIGEgc3VtbWFyeSBmcm9tIHJlbGF0ZWQgbm90ZXNcclxuICAgICAqIEBwYXJhbSBmaWxlIEZpbGUgdG8gZ2VuZXJhdGUgc3VtbWFyeSBmb3JcclxuICAgICAqIEByZXR1cm5zIFRoZSBjb250ZW50IG9mIHRoZSBnZW5lcmF0ZWQgc3VtbWFyeVxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgYXN5bmMgZ2VuZXJhdGVTdW1tYXJ5KGZpbGU6IFRGaWxlKTogUHJvbWlzZTxzdHJpbmc+IHtcclxuICAgICAgICAvLyBHZXQgcmVsYXRlZCBub3Rlc1xyXG4gICAgICAgIGNvbnN0IHJlbGF0ZWROb3RlcyA9IGF3YWl0IHRoaXMuZ2V0UmVsYXRlZE5vdGVzKGZpbGUpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIGlmIChyZWxhdGVkTm90ZXMubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgICAgICAgIG5ldyBOb3RpY2UoJ05vIHJlbGF0ZWQgbm90ZXMgZm91bmQgdG8gZ2VuZXJhdGUgc3VtbWFyeScpO1xyXG4gICAgICAgICAgICByZXR1cm4gJyc7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIENyZWF0ZSBhIG5ldyBub3RlIHdpdGggc3VtbWFyeVxyXG4gICAgICAgIGNvbnN0IHN1bW1hcnlUaXRsZSA9IGBTdW1tYXJ5IG9mICR7ZmlsZS5iYXNlbmFtZX1gO1xyXG4gICAgICAgIGxldCBzdW1tYXJ5Q29udGVudCA9IGAjICR7c3VtbWFyeVRpdGxlfVxcblxcbmA7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gQWRkIG1ldGFkYXRhXHJcbiAgICAgICAgc3VtbWFyeUNvbnRlbnQgKz0gYD4gWyFpbmZvXSBTdW1tYXJ5IGdlbmVyYXRlZCBmcm9tICR7ZmlsZS5iYXNlbmFtZX0gYW5kICR7cmVsYXRlZE5vdGVzLmxlbmd0aH0gcmVsYXRlZCBub3Rlc1xcbmA7XHJcbiAgICAgICAgc3VtbWFyeUNvbnRlbnQgKz0gYD4gR2VuZXJhdGVkIG9uICR7bmV3IERhdGUoKS50b0xvY2FsZVN0cmluZygpfVxcblxcbmA7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gR2V0IG9yaWdpbmFsIG5vdGUgY29udGVudFxyXG4gICAgICAgIGNvbnN0IG9yaWdpbmFsQ29udGVudCA9IGF3YWl0IHRoaXMuYXBwLnZhdWx0LnJlYWQoZmlsZSk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gRXh0cmFjdCBrZXkgY29uY2VwdHNcclxuICAgICAgICBjb25zdCBjb25jZXB0cyA9IHRoaXMuY29uY2VwdEdyYXBoLmdldE5vdGVDb25jZXB0cyhmaWxlLnBhdGgpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIE9yZ2FuaXplIGluZm9ybWF0aW9uIGJ5IGNvbmNlcHRcclxuICAgICAgICBjb25zdCBjb25jZXB0SW5mbzogUmVjb3JkPHN0cmluZywge1xyXG4gICAgICAgICAgICBvcmlnaW5hbFNlbnRlbmNlczogc3RyaW5nW107XHJcbiAgICAgICAgICAgIHJlbGF0ZWRTZW50ZW5jZXM6IFJlY29yZDxzdHJpbmcsIHN0cmluZ1tdPjtcclxuICAgICAgICB9PiA9IHt9O1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIEZvciBlYWNoIGNvbmNlcHQsIGNvbGxlY3QgcmVsYXRlZCBpbmZvcm1hdGlvblxyXG4gICAgICAgIGZvciAoY29uc3QgY29uY2VwdCBvZiBjb25jZXB0cykge1xyXG4gICAgICAgICAgICBjb25jZXB0SW5mb1tjb25jZXB0XSA9IHtcclxuICAgICAgICAgICAgICAgIG9yaWdpbmFsU2VudGVuY2VzOiB0aGlzLmV4dHJhY3RTZW50ZW5jZXNXaXRoQ29uY2VwdChvcmlnaW5hbENvbnRlbnQsIGNvbmNlcHQpLFxyXG4gICAgICAgICAgICAgICAgcmVsYXRlZFNlbnRlbmNlczoge31cclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIEdldCBzZW50ZW5jZXMgZnJvbSByZWxhdGVkIG5vdGVzXHJcbiAgICAgICAgICAgIGZvciAoY29uc3QgcmVsYXRlZCBvZiByZWxhdGVkTm90ZXMpIHtcclxuICAgICAgICAgICAgICAgIGlmIChyZWxhdGVkLnNoYXJlZENvbmNlcHRzLmluY2x1ZGVzKGNvbmNlcHQpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgcmVsYXRlZENvbnRlbnQgPSBhd2FpdCB0aGlzLmFwcC52YXVsdC5yZWFkKHJlbGF0ZWQuZmlsZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uY2VwdEluZm9bY29uY2VwdF0ucmVsYXRlZFNlbnRlbmNlc1tyZWxhdGVkLmZpbGUuYmFzZW5hbWVdID0gXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZXh0cmFjdFNlbnRlbmNlc1dpdGhDb25jZXB0KHJlbGF0ZWRDb250ZW50LCBjb25jZXB0KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICAvLyBGaXJzdCBhZGQgYnJpZWYgb3ZlcnZpZXcgb2Ygb3JpZ2luYWwgbm90ZVxyXG4gICAgICAgIHN1bW1hcnlDb250ZW50ICs9IGAjIyBPcmlnaW5hbCBOb3RlOiAke2ZpbGUuYmFzZW5hbWV9XFxuXFxuYDtcclxuICAgICAgICBjb25zdCBmaXJzdFBhcmFncmFwaCA9IG9yaWdpbmFsQ29udGVudC5zcGxpdCgnXFxuXFxuJylbMF07XHJcbiAgICAgICAgc3VtbWFyeUNvbnRlbnQgKz0gYCR7Zmlyc3RQYXJhZ3JhcGh9XFxuXFxuYDtcclxuICAgICAgICBcclxuICAgICAgICAvLyBBZGQgc2VjdGlvbiBmb3IgZWFjaCBzaWduaWZpY2FudCBjb25jZXB0XHJcbiAgICAgICAgc3VtbWFyeUNvbnRlbnQgKz0gYCMjIEtleSBDb25jZXB0cyBhbmQgUmVsYXRpb25zaGlwc1xcblxcbmA7XHJcbiAgICAgICAgXHJcbiAgICAgICAgZm9yIChjb25zdCBjb25jZXB0IG9mIGNvbmNlcHRzKSB7XHJcbiAgICAgICAgICAgIC8vIFNraXAgY29uY2VwdHMgd2l0aCBubyByZWxhdGVkIGluZm9ybWF0aW9uXHJcbiAgICAgICAgICAgIGlmIChPYmplY3Qua2V5cyhjb25jZXB0SW5mb1tjb25jZXB0XS5yZWxhdGVkU2VudGVuY2VzKS5sZW5ndGggPT09IDApIGNvbnRpbnVlO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgc3VtbWFyeUNvbnRlbnQgKz0gYCMjIyBDb25jZXB0OiAke2NvbmNlcHR9XFxuXFxuYDtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIEFkZCBvcmlnaW5hbCBub3RlJ3MgdXNhZ2VcclxuICAgICAgICAgICAgaWYgKGNvbmNlcHRJbmZvW2NvbmNlcHRdLm9yaWdpbmFsU2VudGVuY2VzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgICAgIHN1bW1hcnlDb250ZW50ICs9IGBJbiAke2ZpbGUuYmFzZW5hbWV9OlxcbmA7XHJcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IHNlbnRlbmNlIG9mIGNvbmNlcHRJbmZvW2NvbmNlcHRdLm9yaWdpbmFsU2VudGVuY2VzLnNsaWNlKDAsIDMpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc3VtbWFyeUNvbnRlbnQgKz0gYC0gJHt0aGlzLmhpZ2hsaWdodENvbmNlcHQoc2VudGVuY2UudHJpbSgpLCBjb25jZXB0KX1cXG5gO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgc3VtbWFyeUNvbnRlbnQgKz0gYFxcbmA7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIEFkZCByZWxhdGVkIG5vdGVzJyB1c2FnZVxyXG4gICAgICAgICAgICBmb3IgKGNvbnN0IFtub3RlTmFtZSwgc2VudGVuY2VzXSBvZiBPYmplY3QuZW50cmllcyhjb25jZXB0SW5mb1tjb25jZXB0XS5yZWxhdGVkU2VudGVuY2VzKSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHNlbnRlbmNlcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc3VtbWFyeUNvbnRlbnQgKz0gYEluICR7bm90ZU5hbWV9OlxcbmA7XHJcbiAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCBzZW50ZW5jZSBvZiBzZW50ZW5jZXMuc2xpY2UoMCwgMykpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc3VtbWFyeUNvbnRlbnQgKz0gYC0gJHt0aGlzLmhpZ2hsaWdodENvbmNlcHQoc2VudGVuY2UudHJpbSgpLCBjb25jZXB0KX1cXG5gO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBzdW1tYXJ5Q29udGVudCArPSBgXFxuYDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICAvLyBBZGQgc2VjdGlvbiB3aXRoIGxpbmtzIHRvIHJlbGF0ZWQgbm90ZXNcclxuICAgICAgICBzdW1tYXJ5Q29udGVudCArPSBgIyMgUmVsYXRlZCBOb3Rlc1xcblxcbmA7XHJcbiAgICAgICAgZm9yIChjb25zdCByZWxhdGVkIG9mIHJlbGF0ZWROb3Rlcykge1xyXG4gICAgICAgICAgICBzdW1tYXJ5Q29udGVudCArPSBgLSBbWyR7cmVsYXRlZC5maWxlLnBhdGh9fCR7cmVsYXRlZC5maWxlLmJhc2VuYW1lfV1dIChSZWxldmFuY2U6ICR7TWF0aC5yb3VuZChyZWxhdGVkLnJlbGV2YW5jZSAqIDEwMCl9JSlcXG5gO1xyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICAvLyBDcmVhdGUgdGhlIHN1bW1hcnkgZmlsZSBhbmQgcmV0dXJuIHRoZSBjb250ZW50XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgY29uc3Qgc3VtbWFyeVBhdGggPSBgJHtmaWxlLnBhcmVudD8ucGF0aCB8fCAnJ30vJHtzdW1tYXJ5VGl0bGV9Lm1kYDtcclxuICAgICAgICAgICAgbGV0IHN1bW1hcnlGaWxlID0gdGhpcy5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKHN1bW1hcnlQYXRoKSBhcyBURmlsZTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGlmIChzdW1tYXJ5RmlsZSkge1xyXG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5hcHAudmF1bHQubW9kaWZ5KHN1bW1hcnlGaWxlLCBzdW1tYXJ5Q29udGVudCk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBzdW1tYXJ5RmlsZSA9IGF3YWl0IHRoaXMuYXBwLnZhdWx0LmNyZWF0ZShzdW1tYXJ5UGF0aCwgc3VtbWFyeUNvbnRlbnQpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0TGVhZigpLm9wZW5GaWxlKHN1bW1hcnlGaWxlKTtcclxuICAgICAgICAgICAgcmV0dXJuIHN1bW1hcnlDb250ZW50O1xyXG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNyZWF0aW5nIHN1bW1hcnk6JywgZXJyb3IpO1xyXG4gICAgICAgICAgICBuZXcgTm90aWNlKCdFcnJvciBjcmVhdGluZyBzdW1tYXJ5IG5vdGUnKTtcclxuICAgICAgICAgICAgcmV0dXJuICcnO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIFxyXG4gICAgLyoqXHJcbiAgICAgKiBFeHRyYWN0IHNlbnRlbmNlcyBjb250YWluaW5nIGEgY29uY2VwdFxyXG4gICAgICogQHBhcmFtIGNvbnRlbnQgVGV4dCBjb250ZW50IHRvIHNlYXJjaFxyXG4gICAgICogQHBhcmFtIGNvbmNlcHQgQ29uY2VwdCB0byBmaW5kIGluIHNlbnRlbmNlc1xyXG4gICAgICogQHJldHVybnMgQXJyYXkgb2Ygc2VudGVuY2VzIGNvbnRhaW5pbmcgdGhlIGNvbmNlcHRcclxuICAgICAqL1xyXG4gICAgcHJpdmF0ZSBleHRyYWN0U2VudGVuY2VzV2l0aENvbmNlcHQoY29udGVudDogc3RyaW5nLCBjb25jZXB0OiBzdHJpbmcpOiBzdHJpbmdbXSB7XHJcbiAgICAgICAgLy8gU3BsaXQgY29udGVudCBpbnRvIHNlbnRlbmNlcyAoc2ltcGxpZmllZCBhcHByb2FjaClcclxuICAgICAgICBjb25zdCBzZW50ZW5jZXMgPSBjb250ZW50LnNwbGl0KC9bLiE/XSsvKS5maWx0ZXIocyA9PiBzLnRyaW0oKS5sZW5ndGggPiAwKTtcclxuICAgICAgICBcclxuICAgICAgICAvLyBGaW5kIHNlbnRlbmNlcyBjb250YWluaW5nIHRoZSBjb25jZXB0IChjYXNlIGluc2Vuc2l0aXZlKVxyXG4gICAgICAgIGNvbnN0IHJlZ2V4ID0gbmV3IFJlZ0V4cChgXFxcXGIke2NvbmNlcHR9XFxcXGJgLCAnaScpO1xyXG4gICAgICAgIHJldHVybiBzZW50ZW5jZXMuZmlsdGVyKHNlbnRlbmNlID0+IHJlZ2V4LnRlc3Qoc2VudGVuY2UpKTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgLyoqXHJcbiAgICAgKiBIaWdobGlnaHQgY29uY2VwdCBpbiB0ZXh0IHVzaW5nIG1hcmtkb3duIGZvcm1hdHRpbmdcclxuICAgICAqIEBwYXJhbSB0ZXh0IFRleHQgY29udGFpbmluZyB0aGUgY29uY2VwdFxyXG4gICAgICogQHBhcmFtIGNvbmNlcHQgQ29uY2VwdCB0byBoaWdobGlnaHRcclxuICAgICAqIEByZXR1cm5zIFRleHQgd2l0aCBoaWdobGlnaHRlZCBjb25jZXB0XHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgaGlnaGxpZ2h0Q29uY2VwdCh0ZXh0OiBzdHJpbmcsIGNvbmNlcHQ6IHN0cmluZyk6IHN0cmluZyB7XHJcbiAgICAgICAgY29uc3QgcmVnZXggPSBuZXcgUmVnRXhwKGBcXFxcYigke2NvbmNlcHR9KVxcXFxiYCwgJ2dpJyk7XHJcbiAgICAgICAgcmV0dXJuIHRleHQucmVwbGFjZShyZWdleCwgJyoqJDEqKicpOyAvLyBCb2xkIGluIG1hcmtkb3duXHJcbiAgICB9XHJcbn0iLCAiaW1wb3J0IHsgSXRlbVZpZXcsIFRGaWxlLCBXb3Jrc3BhY2VMZWFmIH0gZnJvbSAnb2JzaWRpYW4nO1xyXG5pbXBvcnQgeyBSZWxhdGVkTm90ZSwgUmVsYXRlZE5vdGVzVmlld0NvbnRyb2xsZXIsIFBsdWdpbkFQSSB9IGZyb20gJy4uL3V0aWxzL3R5cGVzJztcclxuXHJcbi8vIFZpZXcgdHlwZSBmb3IgcmVsYXRlZCBub3Rlc1xyXG5leHBvcnQgY29uc3QgUkVMQVRFRF9OT1RFU19WSUVXX1RZUEUgPSAna25vd2xlZGdlLXN5bnRoZXNpcy1yZWxhdGVkLW5vdGVzJztcclxuXHJcbi8qKlxyXG4gKiBSZWxhdGVkIE5vdGVzIFZpZXcgaW1wbGVtZW50YXRpb25cclxuICovXHJcbmV4cG9ydCBjbGFzcyBSZWxhdGVkTm90ZXNWaWV3IGV4dGVuZHMgSXRlbVZpZXcgaW1wbGVtZW50cyBSZWxhdGVkTm90ZXNWaWV3Q29udHJvbGxlciB7XHJcbiAgICBwcml2YXRlIHBsdWdpbkFwaTogUGx1Z2luQVBJO1xyXG4gICAgcHJpdmF0ZSByZWxhdGVkQ29udGVudEVsOiBIVE1MRWxlbWVudDsgLy8gQ2hhbmdlZCBmcm9tIGNvbnRlbnRFbCB0byBhdm9pZCBjb25mbGljdHNcclxuICAgIHByaXZhdGUgY3VycmVudEZpbGU6IFRGaWxlIHwgbnVsbCA9IG51bGw7XHJcbiAgICBcclxuICAgIGNvbnN0cnVjdG9yKGxlYWY6IFdvcmtzcGFjZUxlYWYsIHBsdWdpbkFwaTogUGx1Z2luQVBJKSB7XHJcbiAgICAgICAgc3VwZXIobGVhZik7XHJcbiAgICAgICAgdGhpcy5wbHVnaW5BcGkgPSBwbHVnaW5BcGk7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIGdldFZpZXdUeXBlKCk6IHN0cmluZyB7XHJcbiAgICAgICAgcmV0dXJuIFJFTEFURURfTk9URVNfVklFV19UWVBFO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICBnZXREaXNwbGF5VGV4dCgpOiBzdHJpbmcge1xyXG4gICAgICAgIHJldHVybiBcIlJlbGF0ZWQgTm90ZXNcIjtcclxuICAgIH1cclxuICAgIFxyXG4gICAgYXN5bmMgb25PcGVuKCkge1xyXG4gICAgICAgIGNvbnN0IHsgY29udGFpbmVyRWwgfSA9IHRoaXM7XHJcbiAgICAgICAgY29udGFpbmVyRWwuZW1wdHkoKTtcclxuICAgICAgICBcclxuICAgICAgICAvLyBDcmVhdGUgY29udGVudCBjb250YWluZXJcclxuICAgICAgICB0aGlzLnJlbGF0ZWRDb250ZW50RWwgPSBjb250YWluZXJFbC5jcmVhdGVEaXYoeyBjbHM6ICdrbm93bGVkZ2Utc3ludGhlc2lzLXJlbGF0ZWQtbm90ZXMnIH0pO1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIENyZWF0ZSBoZWFkZXJcclxuICAgICAgICB0aGlzLnJlbGF0ZWRDb250ZW50RWwuY3JlYXRlRWwoJ2gzJywgeyB0ZXh0OiAnUmVsYXRlZCBOb3RlcycgfSk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gU2hvdyBwbGFjZWhvbGRlciB0ZXh0XHJcbiAgICAgICAgdGhpcy5yZWxhdGVkQ29udGVudEVsLmNyZWF0ZUVsKCdwJywgeyBcclxuICAgICAgICAgICAgdGV4dDogJ09wZW4gYSBub3RlIHRvIHNlZSByZWxhdGVkIGNvbnRlbnQuJyxcclxuICAgICAgICAgICAgY2xzOiAna25vd2xlZGdlLXN5bnRoZXNpcy1wbGFjZWhvbGRlcidcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgLyoqXHJcbiAgICAgKiBVcGRhdGUgdGhlIHZpZXcgd2l0aCByZWxhdGVkIG5vdGVzIGZvciBhIGZpbGVcclxuICAgICAqIEBwYXJhbSBmaWxlIEN1cnJlbnQgYWN0aXZlIGZpbGVcclxuICAgICAqIEBwYXJhbSByZWxhdGVkTm90ZXMgQXJyYXkgb2YgcmVsYXRlZCBub3Rlc1xyXG4gICAgICovXHJcbiAgICBwdWJsaWMgdXBkYXRlUmVsYXRlZE5vdGVzKGZpbGU6IFRGaWxlLCByZWxhdGVkTm90ZXM6IFJlbGF0ZWROb3RlW10pOiB2b2lkIHtcclxuICAgICAgICB0aGlzLmN1cnJlbnRGaWxlID0gZmlsZTtcclxuICAgICAgICBcclxuICAgICAgICAvLyBVcGRhdGUgaGVhZGVyIHdpdGggZmlsZW5hbWVcclxuICAgICAgICB0aGlzLnJlbGF0ZWRDb250ZW50RWwuZW1wdHkoKTtcclxuICAgICAgICB0aGlzLnJlbGF0ZWRDb250ZW50RWwuY3JlYXRlRWwoJ2gzJywgeyB0ZXh0OiAnUmVsYXRlZCB0bzogJyArIGZpbGUuYmFzZW5hbWUgfSk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gRGlzcGxheSBjb25jZXB0c1xyXG4gICAgICAgIGNvbnN0IGNvbmNlcHRzID0gdGhpcy5wbHVnaW5BcGkuZXh0cmFjdENvbmNlcHRzKGZpbGUucGF0aCk7XHJcbiAgICAgICAgaWYgKGNvbmNlcHRzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgY29uc3QgY29uY2VwdHNFbCA9IHRoaXMucmVsYXRlZENvbnRlbnRFbC5jcmVhdGVEaXYoeyBjbHM6ICdrbm93bGVkZ2Utc3ludGhlc2lzLWNvbmNlcHRzJyB9KTtcclxuICAgICAgICAgICAgY29uY2VwdHNFbC5jcmVhdGVFbCgnaDQnLCB7IHRleHQ6ICdLZXkgQ29uY2VwdHMnIH0pO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgY29uc3QgY29uY2VwdHNMaXN0ID0gY29uY2VwdHNFbC5jcmVhdGVEaXYoeyBjbHM6ICdrbm93bGVkZ2Utc3ludGhlc2lzLWNvbmNlcHRzLWxpc3QnIH0pO1xyXG4gICAgICAgICAgICBmb3IgKGNvbnN0IGNvbmNlcHQgb2YgY29uY2VwdHMpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHRhZ0VsID0gY29uY2VwdHNMaXN0LmNyZWF0ZVNwYW4oeyBcclxuICAgICAgICAgICAgICAgICAgICBjbHM6ICdrbm93bGVkZ2Utc3ludGhlc2lzLWNvbmNlcHQtdGFnJyxcclxuICAgICAgICAgICAgICAgICAgICB0ZXh0OiBjb25jZXB0XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICAvLyBEaXNwbGF5IHJlbGF0ZWQgbm90ZXNcclxuICAgICAgICBpZiAocmVsYXRlZE5vdGVzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgY29uc3QgcmVsYXRlZEVsID0gdGhpcy5yZWxhdGVkQ29udGVudEVsLmNyZWF0ZURpdih7IGNsczogJ2tub3dsZWRnZS1zeW50aGVzaXMtcmVsYXRlZCcgfSk7XHJcbiAgICAgICAgICAgIHJlbGF0ZWRFbC5jcmVhdGVFbCgnaDQnLCB7IHRleHQ6ICdSZWxhdGVkIE5vdGVzJyB9KTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGNvbnN0IHJlbGF0ZWRMaXN0ID0gcmVsYXRlZEVsLmNyZWF0ZURpdih7IGNsczogJ2tub3dsZWRnZS1zeW50aGVzaXMtcmVsYXRlZC1saXN0JyB9KTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGZvciAoY29uc3QgcmVsYXRlZCBvZiByZWxhdGVkTm90ZXMpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG5vdGVFbCA9IHJlbGF0ZWRMaXN0LmNyZWF0ZURpdih7IGNsczogJ2tub3dsZWRnZS1zeW50aGVzaXMtcmVsYXRlZC1ub3RlJyB9KTtcclxuICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgLy8gQ3JlYXRlIGxpbmsgdG8gdGhlIG5vdGVcclxuICAgICAgICAgICAgICAgIGNvbnN0IGxpbmtFbCA9IG5vdGVFbC5jcmVhdGVFbCgnYScsIHsgXHJcbiAgICAgICAgICAgICAgICAgICAgY2xzOiAna25vd2xlZGdlLXN5bnRoZXNpcy1ub3RlLWxpbmsnLFxyXG4gICAgICAgICAgICAgICAgICAgIHRleHQ6IHJlbGF0ZWQuZmlsZS5iYXNlbmFtZVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgIC8vIEFkZCBjbGljayBoYW5kbGVyIHRvIG9wZW4gdGhlIG5vdGVcclxuICAgICAgICAgICAgICAgIGxpbmtFbC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGFzeW5jIChlKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGxlYWYgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0TGVhZigpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChsZWFmKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IGxlYWYub3BlbkZpbGUocmVsYXRlZC5maWxlKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgLy8gQWRkIHJlbGV2YW5jZSBpbmRpY2F0b3JcclxuICAgICAgICAgICAgICAgIGNvbnN0IHJlbGV2YW5jZUVsID0gbm90ZUVsLmNyZWF0ZURpdih7IFxyXG4gICAgICAgICAgICAgICAgICAgIGNsczogJ2tub3dsZWRnZS1zeW50aGVzaXMtcmVsZXZhbmNlLWJhcicgXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgY29uc3QgaW5kaWNhdG9yRWwgPSByZWxldmFuY2VFbC5jcmVhdGVEaXYoeyBcclxuICAgICAgICAgICAgICAgICAgICBjbHM6ICdrbm93bGVkZ2Utc3ludGhlc2lzLXJlbGV2YW5jZS1pbmRpY2F0b3InIFxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgIC8vIFNldCB3aWR0aCBiYXNlZCBvbiByZWxldmFuY2Ugc2NvcmUgKDAtMTAwJSlcclxuICAgICAgICAgICAgICAgIGluZGljYXRvckVsLnN0eWxlLndpZHRoID0gYCR7TWF0aC5yb3VuZChyZWxhdGVkLnJlbGV2YW5jZSAqIDEwMCl9JWA7XHJcbiAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgIC8vIEFkZCBzaGFyZWQgY29uY2VwdHNcclxuY29uc3Qgc2hhcmVkRWwgPSBub3RlRWwuY3JlYXRlRGl2KHtcclxuXHRjbHM6ICdrbm93bGVkZ2Utc3ludGhlc2lzLXNoYXJlZC1jb25jZXB0cydcclxufSk7XHJcblxyXG5zaGFyZWRFbC5jcmVhdGVTcGFuKHtcclxuXHRjbHM6ICdrbm93bGVkZ2Utc3ludGhlc2lzLXNoYXJlZC1sYWJlbCcsXHJcblx0dGV4dDogJ1NoYXJlZCBjb25jZXB0czogJ1xyXG59KTtcclxuXHJcbmNvbnN0IHNoYXJlZExpc3QgPSBzaGFyZWRFbC5jcmVhdGVEaXYoeyBjbHM6ICdrbm93bGVkZ2Utc3ludGhlc2lzLXNoYXJlZC1saXN0JyB9KTtcclxuXHJcbmZvciAoY29uc3QgY29uY2VwdCBvZiByZWxhdGVkLnNoYXJlZENvbmNlcHRzKSB7XHJcblx0Y29uc3QgdGFnID0gc2hhcmVkTGlzdC5jcmVhdGVTcGFuKHtcclxuXHRcdGNsczogJ2tub3dsZWRnZS1zeW50aGVzaXMtY29uY2VwdC10YWcga25vd2xlZGdlLXN5bnRoZXNpcy1zaGFyZWQnLFxyXG5cdFx0dGV4dDogY29uY2VwdFxyXG5cdH0pO1xyXG5cclxuXHQvLyBBZGQgcmVtb3ZlIGJ1dHRvblxyXG5cdGNvbnN0IHJlbW92ZUJ0biA9IHRhZy5jcmVhdGVFbCgnYnV0dG9uJywgeyB0ZXh0OiAnXHUwMEQ3JyB9KTtcclxuXHRyZW1vdmVCdG4uc3R5bGUubWFyZ2luTGVmdCA9ICc2cHgnO1xyXG5cdHJlbW92ZUJ0bi5vbmNsaWNrID0gKCkgPT4ge1xyXG5cdFx0cmVsYXRlZC5zaGFyZWRDb25jZXB0cyA9IHJlbGF0ZWQuc2hhcmVkQ29uY2VwdHMuZmlsdGVyKGMgPT4gYyAhPT0gY29uY2VwdCk7XHJcblx0XHR0YWcucmVtb3ZlKCk7XHJcblx0XHR0aGlzLnBsdWdpbkFwaS51cGRhdGVOb3RlQ29uY2VwdHMocmVsYXRlZC5maWxlLnBhdGgsIHJlbGF0ZWQuc2hhcmVkQ29uY2VwdHMpO1xyXG5cdH07XHJcbn1cclxuXHJcbi8vIElucHV0IHRvIGFkZCBuZXcgY29uY2VwdFxyXG5jb25zdCBpbnB1dFdyYXBwZXIgPSBzaGFyZWRFbC5jcmVhdGVEaXYoeyBjbHM6ICdrbm93bGVkZ2Utc3ludGhlc2lzLWFkZC1jb25jZXB0JyB9KTtcclxuY29uc3QgaW5wdXQgPSBpbnB1dFdyYXBwZXIuY3JlYXRlRWwoJ2lucHV0Jyk7XHJcbmlucHV0LnBsYWNlaG9sZGVyID0gJ0FkZCBuZXcgY29uY2VwdC4uLic7XHJcbmlucHV0LnN0eWxlLm1hcmdpblJpZ2h0ID0gJzZweCc7XHJcblxyXG5jb25zdCBhZGRCdG4gPSBpbnB1dFdyYXBwZXIuY3JlYXRlRWwoJ2J1dHRvbicsIHsgdGV4dDogJ0FkZCcgfSk7XHJcbmFkZEJ0bi5vbmNsaWNrID0gKCkgPT4ge1xyXG5cdGNvbnN0IG5ld0NvbmNlcHQgPSBpbnB1dC52YWx1ZS50cmltKCk7XHJcblx0aWYgKG5ld0NvbmNlcHQgJiYgIXJlbGF0ZWQuc2hhcmVkQ29uY2VwdHMuaW5jbHVkZXMobmV3Q29uY2VwdCkpIHtcclxuXHRcdHJlbGF0ZWQuc2hhcmVkQ29uY2VwdHMucHVzaChuZXdDb25jZXB0KTtcclxuXHRcdHRoaXMucGx1Z2luQXBpLnVwZGF0ZU5vdGVDb25jZXB0cyhyZWxhdGVkLmZpbGUucGF0aCwgcmVsYXRlZC5zaGFyZWRDb25jZXB0cyk7XHJcblxyXG5cdFx0Y29uc3QgbmV3VGFnID0gc2hhcmVkTGlzdC5jcmVhdGVTcGFuKHtcclxuXHRcdFx0Y2xzOiAna25vd2xlZGdlLXN5bnRoZXNpcy1jb25jZXB0LXRhZyBrbm93bGVkZ2Utc3ludGhlc2lzLXNoYXJlZCcsXHJcblx0XHRcdHRleHQ6IG5ld0NvbmNlcHRcclxuXHRcdH0pO1xyXG5cclxuXHRcdGNvbnN0IHJlbW92ZUJ0biA9IG5ld1RhZy5jcmVhdGVFbCgnYnV0dG9uJywgeyB0ZXh0OiAnXHUwMEQ3JyB9KTtcclxuXHRcdHJlbW92ZUJ0bi5zdHlsZS5tYXJnaW5MZWZ0ID0gJzZweCc7XHJcblx0XHRyZW1vdmVCdG4ub25jbGljayA9ICgpID0+IHtcclxuXHRcdFx0bmV3VGFnLnJlbW92ZSgpO1xyXG5cdFx0XHRyZWxhdGVkLnNoYXJlZENvbmNlcHRzID0gcmVsYXRlZC5zaGFyZWRDb25jZXB0cy5maWx0ZXIoYyA9PiBjICE9PSBuZXdDb25jZXB0KTtcclxuXHRcdFx0dGhpcy5wbHVnaW5BcGkudXBkYXRlTm90ZUNvbmNlcHRzKHJlbGF0ZWQuZmlsZS5wYXRoLCByZWxhdGVkLnNoYXJlZENvbmNlcHRzKTtcclxuXHRcdH07XHJcblxyXG5cdFx0aW5wdXQudmFsdWUgPSAnJztcclxuXHR9XHJcbn07XHJcblxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5yZWxhdGVkQ29udGVudEVsLmNyZWF0ZUVsKCdwJywgeyBcclxuICAgICAgICAgICAgICAgIHRleHQ6ICdObyByZWxhdGVkIG5vdGVzIGZvdW5kLiBUcnkgYWRkaW5nIG1vcmUgY29udGVudCBvciBjb25jZXB0cy4nLFxyXG4gICAgICAgICAgICAgICAgY2xzOiAna25vd2xlZGdlLXN5bnRoZXNpcy1uby1yZXN1bHRzJ1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gQWRkIGJ1dHRvbiB0byBnZW5lcmF0ZSBzdW1tYXJ5XHJcbiAgICAgICAgY29uc3QgYWN0aW9uc0VsID0gdGhpcy5yZWxhdGVkQ29udGVudEVsLmNyZWF0ZURpdih7IGNsczogJ2tub3dsZWRnZS1zeW50aGVzaXMtYWN0aW9ucycgfSk7XHJcbiAgICAgICAgY29uc3Qgc3VtbWFyeUJ0biA9IGFjdGlvbnNFbC5jcmVhdGVFbCgnYnV0dG9uJywgeyBcclxuICAgICAgICAgICAgY2xzOiAna25vd2xlZGdlLXN5bnRoZXNpcy1zdW1tYXJ5LWJ0bicsXHJcbiAgICAgICAgICAgIHRleHQ6ICdHZW5lcmF0ZSBTdW1tYXJ5J1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIFxyXG4gICAgICAgIHN1bW1hcnlCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmN1cnJlbnRGaWxlKSB7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbkFwaS5nZW5lcmF0ZVN1bW1hcnkodGhpcy5jdXJyZW50RmlsZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgLyoqXHJcbiAgICAgKiBDbGVhciB0aGUgdmlld1xyXG4gICAgICovXHJcbiAgICBwdWJsaWMgY2xlYXIoKTogdm9pZCB7XHJcbiAgICAgICAgdGhpcy5yZWxhdGVkQ29udGVudEVsLmVtcHR5KCk7XHJcbiAgICAgICAgdGhpcy5jdXJyZW50RmlsZSA9IG51bGw7XHJcbiAgICAgICAgXHJcbiAgICAgICAgdGhpcy5yZWxhdGVkQ29udGVudEVsLmNyZWF0ZUVsKCdoMycsIHsgdGV4dDogJ1JlbGF0ZWQgTm90ZXMnIH0pO1xyXG4gICAgICAgIHRoaXMucmVsYXRlZENvbnRlbnRFbC5jcmVhdGVFbCgncCcsIHsgXHJcbiAgICAgICAgICAgIHRleHQ6ICdPcGVuIGEgbm90ZSB0byBzZWUgcmVsYXRlZCBjb250ZW50LicsXHJcbiAgICAgICAgICAgIGNsczogJ2tub3dsZWRnZS1zeW50aGVzaXMtcGxhY2Vob2xkZXInXHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbn0iLCAiLy8gc3JjL3VpL3NldHRpbmdzLXRhYi50c1xyXG5pbXBvcnQgeyBBcHAsIE5vdGljZSwgUGx1Z2luLCBQbHVnaW5TZXR0aW5nVGFiLCBTZXR0aW5nIH0gZnJvbSAnb2JzaWRpYW4nO1xyXG5pbXBvcnQgeyBLbm93bGVkZ2VTeW50aGVzaXNTZXR0aW5ncyB9IGZyb20gJy4uL3V0aWxzL3R5cGVzJztcclxuaW1wb3J0IEtub3dsZWRnZVN5bnRoZXNpc1BsdWdpbiBmcm9tICcuLi8uLi9tYWluJzsgXHJcblxyXG4vKipcclxuICogU2V0dGluZ3MgdGFiIGltcGxlbWVudGF0aW9uXHJcbiAqL1xyXG5leHBvcnQgY2xhc3MgS25vd2xlZGdlU3ludGhlc2lzU2V0dGluZ1RhYiBleHRlbmRzIFBsdWdpblNldHRpbmdUYWIge1xyXG4gICAgcHJpdmF0ZSBwbHVnaW46IEtub3dsZWRnZVN5bnRoZXNpc1BsdWdpbjsgLy8gVXNlIHRoZSBzcGVjaWZpYyBwbHVnaW4gY2xhc3MgdHlwZVxyXG5cclxuICAgIGNvbnN0cnVjdG9yKGFwcDogQXBwLCBwbHVnaW46IEtub3dsZWRnZVN5bnRoZXNpc1BsdWdpbikge1xyXG4gICAgICAgIHN1cGVyKGFwcCwgcGx1Z2luKTtcclxuICAgICAgICB0aGlzLnBsdWdpbiA9IHBsdWdpbjtcclxuICAgIH1cclxuXHJcbiAgICBkaXNwbGF5KCk6IHZvaWQge1xyXG4gICAgICAgIGNvbnN0IHsgY29udGFpbmVyRWwgfSA9IHRoaXM7XHJcbiAgICAgICAgY29udGFpbmVyRWwuZW1wdHkoKTtcclxuXHJcbiAgICAgICAgY29udGFpbmVyRWwuY3JlYXRlRWwoJ2gyJywgeyB0ZXh0OiAnS25vd2xlZGdlIFN5bnRoZXNpcyBTZXR0aW5ncycgfSk7XHJcblxyXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxyXG4gICAgICAgICAgICAuc2V0TmFtZSgnQ29uY2VwdCBFeHRyYWN0aW9uIFNlbnNpdGl2aXR5JylcclxuICAgICAgICAgICAgLnNldERlc2MoJ0hpZ2hlciB2YWx1ZXMgZXh0cmFjdCBtb3JlIGNvbmNlcHRzICgxLTEwKScpXHJcbiAgICAgICAgICAgIC5hZGRTbGlkZXIoc2xpZGVyID0+IHNsaWRlclxyXG4gICAgICAgICAgICAgICAgLnNldExpbWl0cygxLCAxMCwgMSlcclxuICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5leHRyYWN0aW9uU2Vuc2l0aXZpdHkpXHJcbiAgICAgICAgICAgICAgICAuc2V0RHluYW1pY1Rvb2x0aXAoKVxyXG4gICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmV4dHJhY3Rpb25TZW5zaXRpdml0eSA9IHZhbHVlO1xyXG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG4gICAgICAgICAgICAgICAgfSkpO1xyXG5cclxuICAgICAgICAvLyBPdGhlciBzZXR0aW5ncy4uLlxyXG5cclxuICAgICAgICAvLyBBZGQgYSBidXR0b24gdG8gcmVwcm9jZXNzIGFsbCBub3Rlc1xyXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxyXG4gICAgICAgICAgICAuc2V0TmFtZSgnUmVwcm9jZXNzIEFsbCBOb3RlcycpXHJcbiAgICAgICAgICAgIC5zZXREZXNjKCdVcGRhdGUgdGhlIGNvbmNlcHQgZ3JhcGggd2l0aCBhbGwgbm90ZXMgaW4gdGhlIHZhdWx0JylcclxuICAgICAgICAgICAgLmFkZEJ1dHRvbihidXR0b24gPT4gYnV0dG9uXHJcbiAgICAgICAgICAgICAgICAuc2V0QnV0dG9uVGV4dCgnUmVwcm9jZXNzJylcclxuICAgICAgICAgICAgICAgIC5vbkNsaWNrKGFzeW5jICgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5wcm9jZXNzQWxsTm90ZXMoKTtcclxuICAgICAgICAgICAgICAgIH0pKTtcclxuICAgICAgICAgICAgICAgIFxyXG4gICAgICAgIC8vIEFkZCBhIGJ1dHRvbiB0byBjbGVhciBhbGwgZGF0YVxyXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxyXG4gICAgICAgICAgICAuc2V0TmFtZSgnQ2xlYXIgQWxsIERhdGEnKVxyXG4gICAgICAgICAgICAuc2V0RGVzYygnUmVzZXQgYWxsIGNvbmNlcHQgYW5kIHJlbGF0aW9uc2hpcCBkYXRhJylcclxuICAgICAgICAgICAgLmFkZEJ1dHRvbihidXR0b24gPT4gYnV0dG9uXHJcbiAgICAgICAgICAgICAgICAuc2V0QnV0dG9uVGV4dCgnQ2xlYXIgRGF0YScpXHJcbiAgICAgICAgICAgICAgICAuc2V0V2FybmluZygpXHJcbiAgICAgICAgICAgICAgICAub25DbGljayhhc3luYyAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgY29uZmlybWVkID0gY29uZmlybSgnQXJlIHlvdSBzdXJlIHlvdSB3YW50IHRvIGNsZWFyIGFsbCBLbm93bGVkZ2UgU3ludGhlc2lzIGRhdGE/IFRoaXMgY2Fubm90IGJlIHVuZG9uZS4nKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoY29uZmlybWVkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLmRhdGFNYW5hZ2VyLmNsZWFyRGF0YSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBuZXcgTm90aWNlKCdLbm93bGVkZ2UgU3ludGhlc2lzIGRhdGEgY2xlYXJlZCcpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pKTtcclxuICAgIH1cclxufSJdLAogICJtYXBwaW5ncyI6ICI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSxJQUFBQSxtQkFPTzs7O0FDSEEsSUFBTSxzQkFBTixNQUFtRDtBQUFBLEVBQW5EO0FBRUg7QUFBQSxTQUFRLFlBQXlCLG9CQUFJLElBQUk7QUFBQSxNQUNyQztBQUFBLE1BQUs7QUFBQSxNQUFNO0FBQUEsTUFBTztBQUFBLE1BQU87QUFBQSxNQUFNO0FBQUEsTUFBTztBQUFBLE1BQU07QUFBQSxNQUFPO0FBQUEsTUFBTztBQUFBLE1BQzFEO0FBQUEsTUFBTTtBQUFBLE1BQVE7QUFBQSxNQUFTO0FBQUEsTUFBUTtBQUFBLE1BQU87QUFBQSxNQUFPO0FBQUEsTUFBTTtBQUFBLE1BQVE7QUFBQSxNQUMzRDtBQUFBLE1BQU07QUFBQSxNQUFNO0FBQUEsTUFBUTtBQUFBLE1BQU07QUFBQSxNQUFRO0FBQUEsTUFBTztBQUFBLE1BQVE7QUFBQSxNQUFRO0FBQUEsTUFDekQ7QUFBQSxNQUFNO0FBQUEsTUFBUTtBQUFBLE1BQU07QUFBQSxNQUFPO0FBQUEsTUFBTTtBQUFBLE1BQU87QUFBQSxNQUFRO0FBQUEsTUFBUztBQUFBLE1BQ3pEO0FBQUEsTUFBVztBQUFBLE1BQVE7QUFBQSxNQUFRO0FBQUEsTUFBUTtBQUFBLE1BQVM7QUFBQSxNQUFRO0FBQUEsTUFBUztBQUFBLE1BQzdEO0FBQUEsTUFBTztBQUFBLE1BQU87QUFBQSxNQUFPO0FBQUEsTUFBUTtBQUFBLE1BQVE7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LGVBQWUsS0FBSyxhQUFhO0FBQUEsUUFDbkMsS0FBSztBQUFBLFFBQ0wsS0FBSyxTQUFTO0FBQUEsTUFDbEI7QUFFQSxXQUFLLG1CQUFtQixNQUFNLFlBQVk7QUFBQSxJQUM5QztBQUFBLEVBQ0o7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBTUEsTUFBYSxrQkFBaUM7QUFDMUMsVUFBTSxLQUFLLGNBQWMsZ0JBQWdCO0FBQUEsRUFDN0M7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBTUEsTUFBYSxZQUEyQjtBQUNwQyxVQUFNLEtBQUssWUFBWSxVQUFVO0FBQUEsRUFDckM7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFPQSxNQUFhLGdCQUFnQixNQUFxQztBQUM5RCxXQUFPLEtBQUssYUFBYTtBQUFBLE1BQ3JCLEtBQUs7QUFBQSxNQUNMLEtBQUssU0FBUztBQUFBLElBQ2xCO0FBQUEsRUFDSjtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQU9PLGdCQUFnQixTQUEyQjtBQUM5QyxXQUFPLEtBQUssaUJBQWlCLGdCQUFnQixPQUFPO0FBQUEsRUFDeEQ7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFPQSxNQUFhLGlCQUFpQixVQUFrQixTQUFnQztBQUU1RSxVQUFNLFdBQVcsS0FBSyxhQUFhLGdCQUFnQixRQUFRO0FBRzNELFFBQUksQ0FBQyxTQUFTLFNBQVMsT0FBTyxHQUFHO0FBQzdCLGVBQVMsS0FBSyxPQUFPO0FBR3JCLFdBQUssYUFBYSxRQUFRLFVBQVUsUUFBUTtBQUc1QyxZQUFNLEtBQUssWUFBWSxnQkFBZ0I7QUFHdkMsVUFBSSx3QkFBTyxrQkFBa0Isa0JBQWtCO0FBQUEsSUFDbkQ7QUFBQSxFQUNKO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQU1PLGdCQUFnQixNQUE4QjtBQUNqRCxXQUFPLEtBQUssaUJBQWlCLGdCQUFnQixJQUFJO0FBQUEsRUFDckQ7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBTU8sY0FBMEM7QUFDN0MsV0FBTyxLQUFLO0FBQUEsRUFDaEI7QUFBQSxFQUNBLG1CQUFtQixNQUFjLFVBQTBCO0FBQzNELElBQUMsS0FBSyxhQUFrQyxtQkFBbUIsTUFBTSxRQUFRO0FBQUEsRUFFN0U7QUFFQTsiLAogICJuYW1lcyI6IFsiaW1wb3J0X29ic2lkaWFuIiwgImltcG9ydF9vYnNpZGlhbiIsICJpbXBvcnRfb2JzaWRpYW4iLCAiaW1wb3J0X29ic2lkaWFuIiwgImltcG9ydF9vYnNpZGlhbiJdCn0K
